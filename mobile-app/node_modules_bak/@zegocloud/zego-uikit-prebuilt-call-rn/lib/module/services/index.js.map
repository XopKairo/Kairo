{"version":3,"names":["AppState","ZegoUIKit","ZegoUIKitLogger","MinimizingHelper","PrebuiltHelper","BellManage","CallEventNotifyApp","RNCallKit","HangupHelper","InnerTextHelper","CallInviteStateManage","NotificationHelper","OfflineCallEventListener","ZegoPrebuiltPlugins","zloginfo","PrebuiltCallReport","getPackageVersion","ZegoCallEndReason","ZegoUIKitPrebuiltCallInvitation","TimingHelper","ZegoUIKitPrebuiltCallService","constructor","_defineProperty","ringtoneConfig","incomingCallFileName","outgoingCallFileName","innerText","androidNotificationConfig","channelID","channelName","notifyWhenAppRunningInBackgroundOrQuit","isIOSSandboxEnvironment","undefined","waitingPageConfig","getInstance","_instance","getModuleName","useSystemCallingUI","plugins","logFlush","init","appID","appSign","userID","userName","config","logSetUserID","isInit","notifyInit","Object","assign","Promise","resolve","appInfo","localUser","certificateIndex","instance","subscription","addEventListener","nextAppState","reconnectIfDisconnected","getPluginName","getSignalingPlugin","enableNotifyWhenAppRunningInBackgroundOrQuit","appName","Platform","OS","create","eventBegin","Date","now","reject","setTimeout","then","reportEvent","initRingtoneConfig","initIncomingSound","initOutgoingSound","catch","uninit","releaseIncomingSound","releaseOutgoingSound","remove","getInitUser","getInitAppInfo","getInitConfig","keys","onInitCallbackMap","forEach","callbackID","onInit","callback","hangUp","showConfirmation","debounce","getDebounce","requireConfig","onCallEnd","onHangUpConfirmation","hangUpConfirmInfo","routeParams","getRouteParams","roomID","setDebounce","_hangupProcess","localHangUp","temp","showLeaveAlert","bind","minimizeWindow","sendCallInvitation","invitees","isVideoCall","navigation","options","requestSystemAlertWindow","alert","message","allow","deny","endReason","isMinimize","getIsMinimize","duration","getDuration","notifyAutoJump","notifyDestroyPrebuilt"],"sources":["index.js"],"sourcesContent":["import { AppState } from 'react-native';\nimport ZegoUIKit, {ZegoUIKitLogger} from '@zegocloud/zego-uikit-rn';\nimport MinimizingHelper from \"../call/services/minimizing_helper\";\nimport PrebuiltHelper from '../call/services/prebuilt_helper';\nimport BellManage from '../call_invitation/services/bell';\nimport CallEventNotifyApp from '../call_invitation/services/callevent_notify_app';\nimport RNCallKit from '../call_invitation/services/callkit'\nimport HangupHelper from \"../call_invitation/services/hangup_helper\";\nimport InnerTextHelper from '../call_invitation/services/inner_text_helper';\nimport CallInviteStateManage from '../call_invitation/services/invite_state_manager';\nimport NotificationHelper from '../call_invitation/services/notification_helper';\nimport OfflineCallEventListener from '../call_invitation/services/offline_call_event_listener';\nimport ZegoPrebuiltPlugins from \"../call_invitation/services/plugins\";\nimport { zloginfo } from '../utils/logger';\nimport PrebuiltCallReport from '../utils/report';\nimport {getPackageVersion} from '../utils/package_version';\nimport { ZegoCallEndReason } from \"./defines\";\nimport ZegoUIKitPrebuiltCallInvitation from \"./invitation\";\nimport TimingHelper from \"./timing_helper\";\n\nexport default class ZegoUIKitPrebuiltCallService {\n    _instance;\n    appInfo = {};\n    localUser = {};\n    config = {\n        ringtoneConfig: {\n            incomingCallFileName: 'zego_incoming.mp3',\n            outgoingCallFileName: 'zego_outgoing.mp3',\n        },\n        innerText: {},\n        androidNotificationConfig: {\n            channelID: \"CallInvitation\",\n            channelName: \"CallInvitation\",\n        },\n        notifyWhenAppRunningInBackgroundOrQuit: true, // false not supported\n        isIOSSandboxEnvironment: undefined,\n        waitingPageConfig: {\n          // avatarBuilder\n          // nameBuilder\n          // stateBuilder\n          // hangupBuilder\n          // switchCameraBuilder,\n          // backgroundColor,\n          // foregroundBuilder,\n        },\n        // onIncomingCallDeclineButtonPressed,\n        // onIncomingCallAcceptButtonPressed,\n        // onIncomingCallReceived,\n        // onIncomingCallCanceled,\n        // onIncomingCallTimeout,\n        // onOutgoingCallCancelButtonPressed,\n        // onOutgoingCallAccepted,\n        // onOutgoingCallRejectedCauseBusy,\n        // onOutgoingCallDeclined,\n        // onOutgoingCallTimeout,\n    };\n    isInit = false;\n    subscription = null;\n    onInitCallbackMap = {};\n    onRouteChangeCallbackMap = {};\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new ZegoUIKitPrebuiltCallService());\n    }\n    getModuleName() {\n        return 'PrebuiltCall';\n    }\n    useSystemCallingUI(plugins) {\n        zloginfo(`[ZegoUIKitPrebuiltCallService][useSystemCallingUI] plugins: ${plugins}`)\n        ZegoUIKitLogger.logFlush()\n\n        OfflineCallEventListener.getInstance().useSystemCallingUI(plugins);\n    }\n    init(appID, appSign, userID, userName, plugins, config = {}) {\n        ZegoUIKitLogger.logSetUserID(userID)\n\n        if (this.isInit) {\n            this.notifyInit();\n            Object.assign(this.config, config);\n            return Promise.resolve();\n        }\n\n        zloginfo(`[ZegoUIKitPrebuiltCallService][init] appID: ${appID}, userID: ${userID}, userName: ${userName}, plugins: ${plugins}`)\n\n        this.appInfo = { appID, appSign };\n        this.localUser = { userID, userName };\n        Object.assign(this.config, config);\n\n        // Call invitation\n        const {\n            ringtoneConfig,\n            innerText,\n            notifyWhenAppRunningInBackgroundOrQuit,\n            certificateIndex,\n            isIOSSandboxEnvironment,\n        } = this.config;\n        // Init inner text helper\n        InnerTextHelper.instance().init(innerText);\n        // Monitor application status\n        this.subscription = AppState.addEventListener(\n            'change',\n            (nextAppState) => {\n                if (nextAppState === 'active') {\n                  ZegoPrebuiltPlugins.reconnectIfDisconnected();\n                }\n            }\n        );\n\n        if (ZegoUIKit.getPluginName('ZPNs')) {\n          // Enable offline notification\n          ZegoUIKit.getSignalingPlugin().enableNotifyWhenAppRunningInBackgroundOrQuit(certificateIndex, isIOSSandboxEnvironment, this.config.appName);\n        } else {\n          zloginfo('[ZegoUIKitPrebuiltCallService] ZPNs not installed')\n        }\n\n        if (Platform.OS === 'ios' && !ZegoUIKit.getPluginName('CallKit')) {\n          zloginfo('[ZegoUIKitPrebuiltCallService] iOS CallKit not installed')\n        }\n\n        NotificationHelper.getInstance().init()\n\n        PrebuiltCallReport.create(appID, appSign, {\n          'call_version': getPackageVersion(),\n          'user_id': userID\n        });\n        \n        const eventBegin = Date.now();\n        return new Promise((resolve, reject) => {\n          setTimeout(() => {\n            ZegoPrebuiltPlugins.init(appID, appSign, userID, userName, plugins).then(() => {\n              PrebuiltCallReport.reportEvent('call/init', {\n                'error': 0,\n                'msg': '',\n                'start_time': eventBegin\n              });\n              resolve();\n\n              OfflineCallEventListener.getInstance().init(this.config);\n              CallEventNotifyApp.getInstance().init(this.config)\n  \n              CallInviteStateManage.init();\n              BellManage.initRingtoneConfig(ringtoneConfig);\n              BellManage.initIncomingSound();\n              BellManage.initOutgoingSound();\n              this.isInit = true;\n              this.notifyInit();\n            }).catch(() => {\n              PrebuiltCallReport.reportEvent('call/init', {\n                'error': -1,\n                'msg': 'unknown',\n                'start_time': eventBegin\n              });\n              reject();\n            });\n          }, 500);\n        });\n    }\n    uninit() {\n        PrebuiltCallReport.reportEvent('call/unInit', null);\n        if (this.isInit) {\n            ZegoPrebuiltPlugins.uninit();\n            BellManage.releaseIncomingSound();\n            BellManage.releaseOutgoingSound();\n            CallInviteStateManage.uninit();\n            this.subscription.remove();\n            OfflineCallEventListener.getInstance().uninit();\n            this.isInit = false;\n        }\n    }\n    getInitUser() {\n        return this.localUser;\n    }\n    getInitAppInfo() {\n        return this.appInfo;\n    }\n    getInitConfig() {\n        return this.config;\n    }\n    notifyInit() {\n        Object.keys(this.onInitCallbackMap).forEach((callbackID) => {\n            if (this.onInitCallbackMap[callbackID]) {\n                this.onInitCallbackMap[callbackID]();\n            }\n        });\n    }\n    onInit(callbackID, callback) {\n        if (typeof callback !== 'function') {\n            delete this.onInitCallbackMap[callbackID];\n        } else {\n            this.onInitCallbackMap[callbackID] = callback;\n        }\n    }\n    hangUp(showConfirmation = false) {\n        zloginfo(`[ZegoUIKitPrebuiltCallService][hangUp] showConfirmation: ${showConfirmation}`)\n\n        const debounce = HangupHelper.getInstance().getDebounce();\n        const config = this.config.requireConfig ? this.config.requireConfig({}) : {};\n        const { onCallEnd, onHangUpConfirmation, hangUpConfirmInfo } = config;\n\n        if (debounce) {\n          zloginfo(`[ZegoUIKitPrebuiltCallService][hangUp] debounce: ${debounce}, return`)\n          return;\n        }\n        \n        let routeParams = PrebuiltHelper.getInstance().getRouteParams();\n        if (!routeParams.roomID) {\n          zloginfo(`[ZegoUIKitPrebuiltCallService][hangUp] can't get roomID from routeParams, return`)\n          return\n        }\n\n        if (!showConfirmation) {\n            HangupHelper.getInstance().setDebounce(true);\n            this._hangupProcess(onCallEnd, routeParams.roomID, ZegoCallEndReason.localHangUp);\n            HangupHelper.getInstance().setDebounce(false);\n        } else {\n            HangupHelper.getInstance().setDebounce(true);\n            const temp = onHangUpConfirmation || HangupHelper.getInstance().showLeaveAlert.bind(this, hangUpConfirmInfo);\n            temp().then(() => {\n                this._hangupProcess(onCallEnd, routeParams.roomID, ZegoCallEndReason.localHangUp);\n                HangupHelper.getInstance().setDebounce(false);\n            });\n        }\n    }\n    minimizeWindow () {\n        MinimizingHelper.getInstance().minimizeWindow();\n    }\n\n    sendCallInvitation(invitees, isVideoCall, navigation, options) {\n      return ZegoUIKitPrebuiltCallInvitation.getInstance().sendCallInvitation(\n        invitees, \n        isVideoCall, \n        navigation, \n        options\n      );\n    }\n\n    requestSystemAlertWindow(alert) {\n      // System Alert\n      RNCallKit.requestSystemAlertWindow(alert.message, alert.allow, alert.deny);\n    }\n\n    _hangupProcess(onCallEnd, roomID, endReason) {\n      const isMinimize = MinimizingHelper.getInstance().getIsMinimize();\n      zloginfo('[ZegoUIKitPrebuiltCallService][_hangupProcess] roomID: ', roomID, 'endReason: ', endReason, 'isMinimize: ', isMinimize)\n      const duration = TimingHelper.getInstance().getDuration();\n\n      if (typeof onCallEnd !== 'function') {\n        HangupHelper.getInstance().notifyAutoJump();\n      } else {\n        zloginfo('[ZegoUIKitPrebuiltCallService][hangUp] notify requireConfig.onCallEnd will')\n        onCallEnd(roomID, endReason, duration);\n        zloginfo('[ZegoUIKitPrebuiltCallService][hangUp] notify requireConfig.onCallEnd succeed')\n\n        if (isMinimize) {\n          PrebuiltHelper.getInstance().notifyDestroyPrebuilt();\n        }\n      }\n    }\n}"],"mappings":"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","ignoreList":[]}