{"version":3,"names":["CallInviteStateManage","BellManage","zloginfo","CallInviteHelper","constructor","_defineProperty","getInstance","_instance","setOfflineData","data","_offlineData","getOfflineData","acceptCall","callID","JSON","stringify","updateInviteDataAfterAccepted","stopIncomingSound","cancleVirate","notifyAccept","refuseCall","updateInviteDataAfterRejected","notifyRefuse","Object","keys","onAcceptCallbackMap","forEach","callbackID","onCallAccepted","callback","onRefuseCallbackMap","onCallRefused"],"sources":["call_invite_helper.js"],"sourcesContent":["import CallInviteStateManage from './invite_state_manager';\nimport BellManage from './bell';\nimport { zloginfo } from '../../utils/logger';\n\nexport default class CallInviteHelper {\n    _currentCallUUID;\n    _instance;\n    _offlineData;\n    onAcceptCallbackMap = {};\n    onRefuseCallbackMap = {};\n\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new CallInviteHelper());\n    }\n\n    setOfflineData(data) {\n        zloginfo('[CallInviteHelper][setOfflineData]', data)\n        this._offlineData = data\n    }\n    getOfflineData() {\n        return this._offlineData\n    }\n    acceptCall(callID, data) {\n        zloginfo(`[CallInviteHelper][acceptCall] callID: ${callID}, data: ${JSON.stringify(data)}`)\n        CallInviteStateManage.updateInviteDataAfterAccepted(callID);\n        BellManage.stopIncomingSound();\n        BellManage.cancleVirate();\n        this.notifyAccept(data);\n    }\n\n    refuseCall(callID) {\n        CallInviteStateManage.updateInviteDataAfterRejected(callID);\n        BellManage.stopIncomingSound();\n        BellManage.cancleVirate();\n        this.notifyRefuse();\n    }\n\n    notifyAccept(data) {\n        Object.keys(this.onAcceptCallbackMap).forEach((callbackID) => {\n            if (this.onAcceptCallbackMap[callbackID]) {\n                this.onAcceptCallbackMap[callbackID](data);\n            }\n        })\n    }\n    onCallAccepted(callbackID, callback) {\n        if (typeof callback !== 'function') {\n            delete this.onAcceptCallbackMap[callbackID];\n        } else {\n            this.onAcceptCallbackMap[callbackID] = callback;\n        }\n    }\n\n    notifyRefuse() {\n        Object.keys(this.onRefuseCallbackMap).forEach((callbackID) => {\n            if (this.onRefuseCallbackMap[callbackID]) {\n                this.onRefuseCallbackMap[callbackID]();\n            }\n        })\n    }\n    onCallRefused(callbackID, callback) {\n        if (typeof callback !== 'function') {\n            delete this.onRefuseCallbackMap[callbackID];\n        } else {\n            this.onRefuseCallbackMap[callbackID] = callback;\n        }\n    }\n}"],"mappings":";;;AAAA,OAAOA,qBAAqB,MAAM,wBAAwB;AAC1D,OAAOC,UAAU,MAAM,QAAQ;AAC/B,SAASC,QAAQ,QAAQ,oBAAoB;AAE7C,eAAe,MAAMC,gBAAgB,CAAC;EAOlCC,WAAWA,CAAA,EAAG;IAAAC,eAAA;IAAAA,eAAA;IAAAA,eAAA;IAAAA,eAAA,8BAHQ,CAAC,CAAC;IAAAA,eAAA,8BACF,CAAC,CAAC;EAER;EAChB,OAAOC,WAAWA,CAAA,EAAG;IACjB,OAAO,IAAI,CAACC,SAAS,KAAK,IAAI,CAACA,SAAS,GAAG,IAAIJ,gBAAgB,CAAC,CAAC,CAAC;EACtE;EAEAK,cAAcA,CAACC,IAAI,EAAE;IACjBP,QAAQ,CAAC,oCAAoC,EAAEO,IAAI,CAAC;IACpD,IAAI,CAACC,YAAY,GAAGD,IAAI;EAC5B;EACAE,cAAcA,CAAA,EAAG;IACb,OAAO,IAAI,CAACD,YAAY;EAC5B;EACAE,UAAUA,CAACC,MAAM,EAAEJ,IAAI,EAAE;IACrBP,QAAQ,CAAC,0CAA0CW,MAAM,WAAWC,IAAI,CAACC,SAAS,CAACN,IAAI,CAAC,EAAE,CAAC;IAC3FT,qBAAqB,CAACgB,6BAA6B,CAACH,MAAM,CAAC;IAC3DZ,UAAU,CAACgB,iBAAiB,CAAC,CAAC;IAC9BhB,UAAU,CAACiB,YAAY,CAAC,CAAC;IACzB,IAAI,CAACC,YAAY,CAACV,IAAI,CAAC;EAC3B;EAEAW,UAAUA,CAACP,MAAM,EAAE;IACfb,qBAAqB,CAACqB,6BAA6B,CAACR,MAAM,CAAC;IAC3DZ,UAAU,CAACgB,iBAAiB,CAAC,CAAC;IAC9BhB,UAAU,CAACiB,YAAY,CAAC,CAAC;IACzB,IAAI,CAACI,YAAY,CAAC,CAAC;EACvB;EAEAH,YAAYA,CAACV,IAAI,EAAE;IACfc,MAAM,CAACC,IAAI,CAAC,IAAI,CAACC,mBAAmB,CAAC,CAACC,OAAO,CAAEC,UAAU,IAAK;MAC1D,IAAI,IAAI,CAACF,mBAAmB,CAACE,UAAU,CAAC,EAAE;QACtC,IAAI,CAACF,mBAAmB,CAACE,UAAU,CAAC,CAAClB,IAAI,CAAC;MAC9C;IACJ,CAAC,CAAC;EACN;EACAmB,cAAcA,CAACD,UAAU,EAAEE,QAAQ,EAAE;IACjC,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;MAChC,OAAO,IAAI,CAACJ,mBAAmB,CAACE,UAAU,CAAC;IAC/C,CAAC,MAAM;MACH,IAAI,CAACF,mBAAmB,CAACE,UAAU,CAAC,GAAGE,QAAQ;IACnD;EACJ;EAEAP,YAAYA,CAAA,EAAG;IACXC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACM,mBAAmB,CAAC,CAACJ,OAAO,CAAEC,UAAU,IAAK;MAC1D,IAAI,IAAI,CAACG,mBAAmB,CAACH,UAAU,CAAC,EAAE;QACtC,IAAI,CAACG,mBAAmB,CAACH,UAAU,CAAC,CAAC,CAAC;MAC1C;IACJ,CAAC,CAAC;EACN;EACAI,aAAaA,CAACJ,UAAU,EAAEE,QAAQ,EAAE;IAChC,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;MAChC,OAAO,IAAI,CAACC,mBAAmB,CAACH,UAAU,CAAC;IAC/C,CAAC,MAAM;MACH,IAAI,CAACG,mBAAmB,CAACH,UAAU,CAAC,GAAGE,QAAQ;IACnD;EACJ;AACJ","ignoreList":[]}