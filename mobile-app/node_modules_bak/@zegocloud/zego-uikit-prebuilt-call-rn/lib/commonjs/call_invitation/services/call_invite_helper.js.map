{"version":3,"names":["_invite_state_manager","_interopRequireDefault","require","_bell","_logger","e","__esModule","default","_defineProperty","r","t","_toPropertyKey","Object","defineProperty","value","enumerable","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","CallInviteHelper","constructor","getInstance","_instance","setOfflineData","data","zloginfo","_offlineData","getOfflineData","acceptCall","callID","JSON","stringify","CallInviteStateManage","updateInviteDataAfterAccepted","BellManage","stopIncomingSound","cancleVirate","notifyAccept","refuseCall","updateInviteDataAfterRejected","notifyRefuse","keys","onAcceptCallbackMap","forEach","callbackID","onCallAccepted","callback","onRefuseCallbackMap","onCallRefused","exports"],"sources":["call_invite_helper.js"],"sourcesContent":["import CallInviteStateManage from './invite_state_manager';\nimport BellManage from './bell';\nimport { zloginfo } from '../../utils/logger';\n\nexport default class CallInviteHelper {\n    _currentCallUUID;\n    _instance;\n    _offlineData;\n    onAcceptCallbackMap = {};\n    onRefuseCallbackMap = {};\n\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new CallInviteHelper());\n    }\n\n    setOfflineData(data) {\n        zloginfo('[CallInviteHelper][setOfflineData]', data)\n        this._offlineData = data\n    }\n    getOfflineData() {\n        return this._offlineData\n    }\n    acceptCall(callID, data) {\n        zloginfo(`[CallInviteHelper][acceptCall] callID: ${callID}, data: ${JSON.stringify(data)}`)\n        CallInviteStateManage.updateInviteDataAfterAccepted(callID);\n        BellManage.stopIncomingSound();\n        BellManage.cancleVirate();\n        this.notifyAccept(data);\n    }\n\n    refuseCall(callID) {\n        CallInviteStateManage.updateInviteDataAfterRejected(callID);\n        BellManage.stopIncomingSound();\n        BellManage.cancleVirate();\n        this.notifyRefuse();\n    }\n\n    notifyAccept(data) {\n        Object.keys(this.onAcceptCallbackMap).forEach((callbackID) => {\n            if (this.onAcceptCallbackMap[callbackID]) {\n                this.onAcceptCallbackMap[callbackID](data);\n            }\n        })\n    }\n    onCallAccepted(callbackID, callback) {\n        if (typeof callback !== 'function') {\n            delete this.onAcceptCallbackMap[callbackID];\n        } else {\n            this.onAcceptCallbackMap[callbackID] = callback;\n        }\n    }\n\n    notifyRefuse() {\n        Object.keys(this.onRefuseCallbackMap).forEach((callbackID) => {\n            if (this.onRefuseCallbackMap[callbackID]) {\n                this.onRefuseCallbackMap[callbackID]();\n            }\n        })\n    }\n    onCallRefused(callbackID, callback) {\n        if (typeof callback !== 'function') {\n            delete this.onRefuseCallbackMap[callbackID];\n        } else {\n            this.onRefuseCallbackMap[callbackID] = callback;\n        }\n    }\n}"],"mappings":"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","ignoreList":[]}