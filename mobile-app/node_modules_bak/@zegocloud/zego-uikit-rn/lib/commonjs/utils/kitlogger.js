"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _reactNative = require("react-native");
var _timer = require("./timer");
const {
  LogRNModule
} = _reactNative.NativeModules;
let _userID = '';
let _listenerAlready = false;
const ZegoUIKitLogger = {
  logSetUserID: userID => {
    _userID = userID;
    if (!_listenerAlready) {
      _reactNative.AppState.addEventListener('change', async nextState => {
        if (nextState === 'active' || nextState === 'background') {
          LogRNModule.flush();
        }
      });
      _listenerAlready = true;
    }
  },
  logInfo: (module, ...msg) => {
    let dateFormat = (0, _timer.getLocalDateFormat)();
    if (_reactNative.Platform.OS === 'ios') {
      LogRNModule.logInfo(`${dateFormat} I/${module}: ` + _formatLog(...msg));
    } else {
      LogRNModule.logInfo(`I/${module}: ` + _formatLog(...msg));
    }
    if (__DEV__) {
      console.info(`${dateFormat} [${module}][${_userID}]`, ...msg);
    }
  },
  logWarning: (module, ...msg) => {
    let dateFormat = (0, _timer.getLocalDateFormat)();
    if (_reactNative.Platform.OS === 'ios') {
      LogRNModule.logWarning(`${dateFormat} W/${module}: ` + _formatLog(...msg));
    } else {
      LogRNModule.logWarning(`W/${module}: ` + _formatLog(...msg));
    }
    if (__DEV__) {
      console.warn(`${dateFormat} [${module}][${_userID}]`, ...msg);
    }
  },
  logError: (module, ...msg) => {
    let dateFormat = (0, _timer.getLocalDateFormat)();
    if (_reactNative.Platform.OS === 'ios') {
      LogRNModule.logError(`${dateFormat} E/${module}: ` + _formatLog(...msg));
    } else {
      LogRNModule.logError(`E/${module}: ` + _formatLog(...msg));
    }
    if (__DEV__) {
      console.error(`${dateFormat} [${module}][${_userID}]`, ...msg);
    }
  },
  logFlush: () => {
    LogRNModule.flush();
  }
};
var _default = exports.default = ZegoUIKitLogger;
function _formatLog(...msgList) {
  let isPureString = true;
  for (let i = 0; i < msgList.length; i++) {
    if (!_canLogToFile(msgList[i])) {
      isPureString = false;
      break;
    }
  }
  if (isPureString == true) {
    return msgList.join(" ");
  } else {
    let jsonList = [];
    for (let i = 0; i < msgList.length; i++) {
      if (_canLogToFile(msgList[i])) {
        jsonList.push(msgList[i]);
      } else {
        jsonList.push(JSON.stringify(msgList[i]));
      }
    }
    return `(LogTruncated?) ${jsonList.join(" ")}`;
  }
}
const canLogTypeList = ['string', 'number', 'boolean'];
function _canLogToFile(msg) {
  return canLogTypeList.includes(typeof msg);
}
//# sourceMappingURL=kitlogger.js.map