{"version":3,"names":["_ZegoUIKitInternal","_interopRequireDefault","require","_defines","_ZegoUIKitCorePlugin","_logger","_defines2","_signal_plugin","e","__esModule","default","ZegoUIKitSignalingPlugin","_localUser","_queryCount","_onRoomPropertiesFullUpdatedCallbackMap","_usersInRoomAttributes","Map","_roomAttributes","_appSign","_queryUsersInRoomAttributesIteration","nextFlag","count","getInstance","invoke","_queryUsersInRoomAttributesFully","fullAttributes","Promise","resolve","reject","then","resNextFlag","infos","push","catch","error","_updateCoreUserAndNotifyChanges","shouldNotifyChange","forEach","info","coreUser","ZegoUIKitInternal","getUser","userID","JSON","stringify","inRoomAttributes","attributes","Object","assign","notifyUserInfoUpdate","zloginfo","notifyUserCountOrPropertyChanged","ZegoChangedCountOrProperty","attributesUpdate","_notifyRoomPropertiesFullUpdated","notifyData","keys","callbackID","ZegoUIKitSignalingPluginImpl","getZegoUIKitSignalingPlugin","InnerZegoUIKitSignalingPlugin","getVersion","zlogerror","init","appID","appSign","ZegoUIKitCorePlugin","getPlugin","ZegoUIKitPluginType","signaling","uninit","login","userName","token","getToken","registerPluginEventHandler","getLocalUserInfo","logout","undefined","enableNotifyWhenAppRunningInBackgroundOrQuit","certificateIndex","isIOSDevelopmentEnvironment","appName","setAdvancedConfig","key","value","sendInvitation","invitees","timeout","type","data","notificationConfig","inviterName","cancelInvitation","refuseInvitation","inviterID","acceptInvitation","queryCallList","sendInRoomTextMessage","roomID","message","sendInRoomCommandMessage","renewToken","onConnectionStateChanged","callback","onInvitationReceived","from","onInvitationTimeout","onInvitationResponseTimeout","onInvitationAccepted","onInvitationRefused","onInvitationCanceled","onLoginSuccess","joinRoom","ZegoInvitationImplResult","leaveRoom","leaveAllRoom","setUsersInRoomAttributes","userIDs","errorUserList","length","get","set","queryUsersInRoomAttributes","clear","element","usersInRoomAttributes","onUsersInRoomAttributesUpdated","editor","oldAttributes","Array","parse","updateKeys","includes","temp","updateRoomProperty","isDeleteAfterOwnerLeft","isForce","isUpdateOwner","errorKeys","deleteRoomProperties","beginRoomPropertiesBatchOperation","endRoomPropertiesBatchOperation","queryRoomProperties","roomAttributes","onRoomPropertyUpdated","oldRoomAttributes","action","oldValue","onRoomPropertiesFullUpdated","onInRoomTextMessageReceived","onInRoomCommandMessageReceived","_default","exports"],"sources":["index.ts"],"sourcesContent":["import ZegoUIKitInternal from '../../../components/internal/ZegoUIKitInternal';\nimport { ZegoChangedCountOrProperty, ZegoUIKitPluginType } from '../../../components/internal/defines';\nimport ZegoUIKitCorePlugin from '../../../components/internal/ZegoUIKitCorePlugin';\nimport { zlogerror, zloginfo } from '../../../utils/logger';\nimport { ZegoInvitationImplResult } from './defines';\nimport InnerZegoUIKitSignalingPlugin from \"../../../signal_plugin\";\n\nvar ZegoUIKitSignalingPlugin: any;\nconst _localUser: any = {};\nconst _queryCount = 20;\nconst _onRoomPropertiesFullUpdatedCallbackMap: any = {};\nconst _usersInRoomAttributes = new Map(); // <userID, attributes> attributes={ string, string }\nlet _roomAttributes: any = {};\nvar _appSign: string = '';\n\n// ------- live audio room ------\nconst _queryUsersInRoomAttributesIteration = (\n  nextFlag = '',\n  count = _queryCount\n) => {\n  return ZegoUIKitSignalingPlugin.getInstance().invoke(\n    'queryUsersInRoomAttributes',\n    {\n      nextFlag,\n      count,\n    }\n  );\n};\nconst _queryUsersInRoomAttributesFully = (nextFlag: string, count: number) => {\n  const fullAttributes: any[] = [];\n  return new Promise((resolve, reject) => {\n    _queryUsersInRoomAttributesIteration(nextFlag, count)\n      .then(({ nextFlag: resNextFlag, infos }: any) => {\n        fullAttributes.push(...infos);\n        if (resNextFlag) {\n          _queryUsersInRoomAttributesIteration(resNextFlag);\n        } else {\n          resolve(fullAttributes);\n        }\n      })\n      .catch((error: any) => {\n        reject(error);\n      });\n  });\n};\nconst _updateCoreUserAndNotifyChanges = (infos: any[]) => {\n  let shouldNotifyChange = false;\n  infos.forEach((info: any) => {\n    const coreUser = ZegoUIKitInternal.getUser(info.userID);\n    if (coreUser) {\n      if (\n        JSON.stringify(coreUser.inRoomAttributes) !==\n        JSON.stringify(info.attributes)\n      ) {\n        shouldNotifyChange = true;\n        // merge\n        Object.assign(coreUser.inRoomAttributes, info.attributes);\n        ZegoUIKitInternal.notifyUserInfoUpdate(info.userID);\n      }\n    }\n  });\n  if (shouldNotifyChange) {\n    zloginfo(\n      '[Plugins][invitation]Notify changed property of users successfully.'\n    );\n    ZegoUIKitInternal.notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.attributesUpdate\n    );\n  }\n};\nconst _notifyRoomPropertiesFullUpdated = (...notifyData: any[]) => {\n  Object.keys(_onRoomPropertiesFullUpdatedCallbackMap).forEach((callbackID) => {\n    if ((_onRoomPropertiesFullUpdatedCallbackMap as any)[callbackID]) {\n      ((_onRoomPropertiesFullUpdatedCallbackMap as any)[callbackID])(...notifyData);\n    }\n  });\n};\n\nconst ZegoUIKitSignalingPluginImpl = {\n  getZegoUIKitSignalingPlugin: () => {\n    return InnerZegoUIKitSignalingPlugin;\n  },\n  getVersion: () => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getVersion();\n  },\n  init: (appID: number, appSign: string) => {\n    if (ZegoUIKitCorePlugin.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKitSignalingPlugin = InnerZegoUIKitSignalingPlugin;\n    }\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    _appSign = appSign;\n    ZegoUIKitSignalingPlugin.getInstance().invoke('init', { appID, appSign });\n  },\n  uninit: () => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().invoke('uninit');\n  },\n  login: async (userID: string, userName: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    _localUser.userID = userID;\n    _localUser.userName = userName;\n    var token = '';\n    if (_appSign === '') {\n      token = await ZegoUIKitInternal.getToken();\n      ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n        'onRequireNewToken',\n        'callbackID',\n        () => {\n          return ZegoUIKitInternal.getToken();\n        }\n      );\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('login', {\n      userID,\n      userName,\n      token,\n    });\n  },\n  getLocalUserInfo: () => {\n    return _localUser;\n  },\n  logout: () => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    _localUser.userID = undefined\n    _localUser.userName = undefined\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('logout');\n  },\n  enableNotifyWhenAppRunningInBackgroundOrQuit: (certificateIndex?: number, isIOSDevelopmentEnvironment?: boolean, appName?: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      ZegoUIKitSignalingPlugin = InnerZegoUIKitSignalingPlugin;\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('enableNotifyWhenAppRunningInBackgroundOrQuit', {\n      certificateIndex,\n      isIOSDevelopmentEnvironment,\n      appName,\n    });\n  },\n  setAdvancedConfig: (key: string, value: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      ZegoUIKitSignalingPlugin = InnerZegoUIKitSignalingPlugin;\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('setAdvancedConfig', {\n      key,\n      value,\n    });\n  },\n  sendInvitation: (invitees: any[], timeout: number, type: number, data?: string, notificationConfig?: any) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n\n    zloginfo(`[ZegoUIKitSignalingPluginImpl][sendInvitation] invitees: ${invitees}, timeout: ${timeout}, type: ${type}, data: ${data}, notificationConfig: ${JSON.stringify(notificationConfig)}`)\n\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('sendInvitation', {\n      inviterName: _localUser.userName,\n      invitees,\n      timeout,\n      type,\n      data,\n      notificationConfig\n    });\n  },\n  cancelInvitation: (invitees: any[], data?: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('cancelInvitation', {\n      invitees,\n      data,\n    });\n  },\n  refuseInvitation: (inviterID: string, data?: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('refuseInvitation', {\n      inviterID,\n      data,\n    });\n  },\n  acceptInvitation: (inviterID: string, data?: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().invoke('acceptInvitation', {\n      inviterID,\n      data,\n    });\n  },\n  queryCallList: (count: number, nextFlag?: number) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return Promise.reject();\n    }\n    return ZegoUIKitSignalingPlugin.getInstance().queryCallList(count, nextFlag);\n  },\n  sendInRoomTextMessage(roomID: string, message: string) {\n    return ZegoUIKitSignalingPlugin.getInstance().sendInRoomTextMessage(roomID, message);\n  },\n  sendInRoomCommandMessage(roomID: string, message: string) {\n    return ZegoUIKitSignalingPlugin.getInstance().sendInRoomCommandMessage(roomID, message);\n  },\n\n  renewToken(token: string) {\n    return ZegoUIKitSignalingPlugin.getInstance().renewToken(token);\n  },\n\n  onConnectionStateChanged: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'connectionStateChanged',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationReceived: (callbackID: string, callback?: Function, from?: string) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n\n    zloginfo(`[ZegoUIKitSignalingPluginImpl] onInvitationReceived, callbackID: ${callbackID}, from: ${from}`);\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationReceived',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationTimeout: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationTimeout',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationResponseTimeout: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationResponseTimeout',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationAccepted: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationAccepted',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationRefused: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationRefused',\n      callbackID,\n      callback\n    );\n  },\n  onInvitationCanceled: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'invitationCanceled',\n      callbackID,\n      callback\n    );\n  },\n  \n  onLoginSuccess: (callbackID: string, callback?: () => void) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'onLoginSuccess',\n      callbackID,\n      callback\n    );\n  },\n\n  // ------- live audio room - user------\n  joinRoom(roomID: string) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation] Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('joinRoom', {\n          roomID,\n        })\n        .then(async () => {\n          try {\n            zloginfo('[Plugins][invitation] Join room successfully, room:', roomID);\n            // query the attributes of the users in room\n            // const fullAttributes = await _queryUsersInRoomAttributesFully();\n            // _usersInRoomAttributes.clear();\n            // fullAttributes.forEach((element) => {\n            //   _usersInRoomAttributes.set(element.userID, element.attributes);\n            // });\n            // zloginfo(\n            //   `[Plugins][invitation]Auto query the attributes of the users in room successfully.`,\n            //   _usersInRoomAttributes\n            // );\n            // query the room attributes\n            // await this.queryRoomProperties();\n            // zloginfo(\n            //   `[Plugins][invitation]Auto query the room attributes successfully.`,\n            //   _roomAttributes\n            // );\n            resolve(new ZegoInvitationImplResult('', ''));\n          } catch (error) {\n            zlogerror(\n              `[Plugins][invitation]Failed to auto query the attributes of the users in room of room attributes.`,\n              error\n            );\n          }\n        })\n        .catch((error: any) => {\n          zloginfo('[Plugins][invitation] Failed to join room.', roomID);\n          reject(error);\n        });\n    });\n  },\n\n  leaveRoom: () => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation] Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('leaveRoom')\n        .then(async () => {\n          try {\n            zloginfo('[Plugins][invitation] Leave room successfully.');\n            resolve(new ZegoInvitationImplResult('', ''));\n          } catch (error) {\n            zlogerror(`[Plugins][invitation] Failed to resolve leave room.`, error);\n          }\n        })\n        .catch((error: any) => {\n          zloginfo('[Plugins][invitation] Failed to leave room.');\n          reject(error);\n        });\n    });\n  },\n\n  leaveAllRoom: () => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation] Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('leaveAllRoom')\n        .then(async () => {\n          try {\n            zloginfo('[Plugins][invitation] Leave all room successfully.');\n            resolve(new ZegoInvitationImplResult('', ''));\n          } catch (error) {\n            zlogerror(`[Plugins][invitation] Failed to resolve leave all room.`, error);\n          }\n        })\n        .catch((error: any) => {\n          zloginfo('[Plugins][invitation] Failed to leave all room.');\n          reject(error);\n        });\n    });\n  },\n\n  // getUsersInRoomAttributes: () => {\n  //   if (!ZegoUIKitSignalingPlugin) {\n  //     zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n  //     return;\n  //   }\n  //   return _usersInRoomAttributes;\n  // },\n  setUsersInRoomAttributes: (key: string, value: any, userIDs: string[]) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    // The call to the local end also triggers the corresponding callback on the local end\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('setUsersInRoomAttributes', {\n          key,\n          value,\n          userIDs,\n        })\n        .then(({ errorUserList }: any) => {\n          // for the time being, consider setting only one property for one user at a time\n          if (errorUserList.length) {\n            zlogerror(\n              '[Plugins][invitation]Failed to set attributes of users in room.',\n              errorUserList\n            );\n            reject(new ZegoInvitationImplResult('1', ''));\n          } else {\n            const attributes = _usersInRoomAttributes.get(userIDs[0]);\n            if (attributes) {\n              if (!value) {\n                delete attributes[key];\n              } else {\n                attributes[key] = value;\n              }\n            } else if (value) {\n              _usersInRoomAttributes.set(userIDs[0], { [key]: value });\n            }\n            zloginfo(\n              '[Plugins][invitation]Set attributes of users in room successfully.'\n            );\n            resolve(new ZegoInvitationImplResult('', ''));\n          }\n        })\n        .catch((error: any) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to set attributes of users in room.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  queryUsersInRoomAttributes: (nextFlag: string, count = _queryCount) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      _queryUsersInRoomAttributesFully(nextFlag, count)\n        .then((fullAttributes: any[]) => {\n          _usersInRoomAttributes.clear();\n          fullAttributes.forEach((element: any) => {\n            _usersInRoomAttributes.set(element.userID, element.attributes);\n          });\n          zloginfo(\n            '[Plugins][invitation]Query attributes of users in room successfully.',\n            _usersInRoomAttributes\n          );\n          resolve({\n            ...new ZegoInvitationImplResult('', ''),\n            usersInRoomAttributes: _usersInRoomAttributes,\n          });\n          // update the user information of the core layer\n          _updateCoreUserAndNotifyChanges(fullAttributes);\n        })\n        .catch((error) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to query attributes of users in room.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  onUsersInRoomAttributesUpdated: (callbackID: string, callback?: Function) => {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    if (typeof callback !== 'function') {\n      ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n        'usersInRoomAttributesUpdated',\n        callbackID,\n        callback\n      );\n    } else {\n      ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n        'usersInRoomAttributesUpdated',\n        callbackID,\n        ({ infos, editor }: any) => {\n          // incremental information\n          const oldAttributes = new Map();\n          Array.from(_usersInRoomAttributes.keys()).forEach((key) => {\n            oldAttributes.set(\n              key,\n              JSON.parse(JSON.stringify(_usersInRoomAttributes.get(key)))\n            );\n          });\n          const updateKeys: string[] = [];\n          (infos as any[]).forEach((info) => {\n            Object.keys(info.attributes).forEach((key) => {\n              if (!updateKeys.includes(key)) {\n                updateKeys.push(key);\n              }\n            });\n            // merge\n            let temp = _usersInRoomAttributes.get(info.userID);\n            !temp && (temp = {});\n            _usersInRoomAttributes.set(info.userID, temp);\n            Object.assign(temp, info.attributes);\n          });\n          zloginfo(\n            '[Plugins][invitation]Notify updated attributes of users in room successfully.',\n            updateKeys,\n            oldAttributes,\n            _usersInRoomAttributes,\n            editor\n          );\n          callback(updateKeys, oldAttributes, _usersInRoomAttributes, editor);\n\n          // update the user information of the core layer\n          _updateCoreUserAndNotifyChanges(infos);\n        }\n      );\n    }\n  },\n  // ------- live audio room - room------\n  // getRoomProperties() {\n  //   if (!ZegoUIKitSignalingPlugin) {\n  //     zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n  //     return;\n  //   }\n  //   return _roomAttributes;\n  // },\n  updateRoomProperty(\n    key: string,\n    value: any,\n    isDeleteAfterOwnerLeft: boolean,\n    isForce: boolean,\n    isUpdateOwner: boolean\n  ) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('updateRoomProperty', {\n          key,\n          value,\n          isDeleteAfterOwnerLeft,\n          isForce,\n          isUpdateOwner,\n        })\n        .then(({ errorKeys }: any) => {\n          if (!errorKeys.includes(key)) {\n            _roomAttributes[key] = value;\n          }\n          zloginfo(\n            '[Plugins][invitation]Update room attributes successfully.',\n            errorKeys\n          );\n          resolve({ ...new ZegoInvitationImplResult('', ''), errorKeys });\n        })\n        .catch((error: any) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to update room attributes.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  deleteRoomProperties(keys: string[], isForce: boolean) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('deleteRoomProperties', {\n          keys,\n          isForce,\n        })\n        .then(({ errorKeys }: any) => {\n          keys.forEach((key) => {\n            if (!errorKeys.includes(key)) {\n              delete _roomAttributes[key];\n            }\n          });\n          zloginfo(\n            '[Plugins][invitation]Delete room attributes successfully.',\n            errorKeys\n          );\n          resolve({ ...new ZegoInvitationImplResult('', ''), errorKeys });\n        })\n        .catch((error: any) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to delete room attributes.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  beginRoomPropertiesBatchOperation(\n    isDeleteAfterOwnerLeft: boolean,\n    isForce: boolean,\n    isUpdateOwner: boolean\n  ) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().invoke(\n      'beginRoomPropertiesBatchOperation',\n      {\n        isDeleteAfterOwnerLeft,\n        isForce,\n        isUpdateOwner,\n      }\n    );\n    zloginfo(\n      '[Plugins][invitation]Begin room properties batch operation successfully.'\n    );\n  },\n  endRoomPropertiesBatchOperation() {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('endRoomPropertiesBatchOperation')\n        .then(async () => {\n          try {\n            zloginfo(\n              '[Plugins][invitation]End room properties batch operation successfully.'\n            );\n            // query the room attributes\n            // await this.queryRoomProperties();\n            // zloginfo(\n            //   `[Plugins][invitation]Auto query the room attributes successfully.`,\n            //   _roomAttributes\n            // );\n            resolve(new ZegoInvitationImplResult('', ''));\n          } catch (error) {\n            zlogerror(\n              `[Plugins][invitation]Failed to auto query room attributes.`,\n              error\n            );\n          }\n        })\n        .catch((error: any) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to end room attributes batch operation.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  queryRoomProperties() {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    return new Promise((resolve, reject) => {\n      ZegoUIKitSignalingPlugin.getInstance()\n        .invoke('queryRoomProperties')\n        .then(({ roomID, roomAttributes }: any) => {\n          zloginfo(\n            '[Plugins][invitation]Query room attributes successfully.',\n            roomAttributes\n          );\n          _roomAttributes = roomAttributes;\n          resolve({ ...new ZegoInvitationImplResult('', ''), _roomAttributes });\n        })\n        .catch((error: any) => {\n          zlogerror(\n            '[Plugins][invitation]Failed to query room attributes.',\n            error\n          );\n          reject(error);\n        });\n    });\n  },\n  onRoomPropertyUpdated(callbackID: string, callback?: Function) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    if (typeof callback !== 'function') {\n      ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n        'roomPropertyUpdated',\n        callbackID,\n        callback\n      );\n    } else {\n      ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n        'roomPropertyUpdated',\n        callbackID,\n        (info: any) => {\n          const oldRoomAttributes = JSON.parse(JSON.stringify(_roomAttributes));\n          const { action, roomAttributes } = info;\n          const updateKeys = Object.keys(roomAttributes);\n          Object.keys(roomAttributes).forEach((key) => {\n            const oldValue = _roomAttributes[key];\n            // action: Set = 0, Delete = 1\n            if (action === 0) {\n              const value = roomAttributes[key];\n              _roomAttributes[key] = value;\n              callback(key, oldValue, value);\n            } else {\n              delete _roomAttributes[key];\n              callback(key, oldValue, '');\n            }\n          });\n          _notifyRoomPropertiesFullUpdated([\n            updateKeys,\n            oldRoomAttributes,\n            _roomAttributes,\n          ]);\n        }\n      );\n    }\n  },\n  onRoomPropertiesFullUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertiesFullUpdatedCallbackMap) {\n        zloginfo(\n          '[Plugins][invitation][onRoomPropertiesFullUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertiesFullUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  onInRoomTextMessageReceived(callbackID: string, callback?: Function) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'inRoomTextMessageReceived',\n      callbackID,\n      callback\n    );\n  },\n  onInRoomCommandMessageReceived(callbackID: string, callback?: Function) {\n    if (!ZegoUIKitSignalingPlugin) {\n      zlogerror(`[Plugins][invitation]Signaling plugin install error.`);\n      return;\n    }\n    ZegoUIKitSignalingPlugin.getInstance().registerPluginEventHandler(\n      'onInRoomCommandMessageReceived',\n      callbackID,\n      callback\n    );\n  },\n};\n\nexport default ZegoUIKitSignalingPluginImpl;\n"],"mappings":"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","ignoreList":[]}