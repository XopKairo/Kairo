{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_services","_interopRequireDefault","_ZegoInvitationType","_logger","_ZegoUIKitInternal","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","requesting","ZegoSendInvitationButton","props","icon","text","invitees","type","ZegoInvitationType","videoCall","data","onRequestData","timeout","onPressed","onFailure","onWillPressed","onRequestStatusChanged","backgroundColor","fontSize","color","width","height","borderRadius","borderWidth","borderColor","borderStyle","verticalLayout","resourceID","notificationTitle","notificationMessage","getImageSourceByPath","getRenderView","renderView","undefined","createElement","Image","resizeMode","source","Text","style","getCustomTextStyle","marigin","Fragment","marginRight","StyleSheet","create","getCustomContainerStyle","customContainer","flexDirection","onButtonPress","zloginfo","callOnFailure","code","message","length","canSendInvitation","updatedData","notificationConfig","title","JSON","stringify","ZegoUIKitInvitationService","sendInvitation","then","callID","errorInvitees","inviteesBackup","parse","forEach","errorInviteeID","index","findIndex","inviteeID","splice","invitationID","errorCode","errorMessage","setTimeout","catch","ZegoUIKitInternal","notifyErrorUpdate","zlogerror","useEffect","TouchableOpacity","styles","container","onPress","alignItems","justifyContent"],"sources":["ZegoSendInvitationButton.tsx"],"sourcesContent":["import React, { Fragment, useEffect } from 'react';\nimport { Text, Image, TouchableOpacity, StyleSheet } from 'react-native';\nimport ZegoUIKitInvitationService from '../services';\nimport ZegoInvitationType from './ZegoInvitationType';\nimport { zloginfo, zlogerror } from '../../../utils/logger';\nimport ZegoUIKitInternal from '../../../components/internal/ZegoUIKitInternal';\n\nlet requesting = false;\n\nexport default function ZegoSendInvitationButton(props: any) {\n  const {\n    icon,\n    text,\n    invitees = [],\n    type = ZegoInvitationType.videoCall,\n    data = '',\n    onRequestData,\n    timeout = 60,\n    onPressed,\n    onFailure,\n    onWillPressed,\n    onRequestStatusChanged,\n    backgroundColor = '#F3F4F7',\n    fontSize = 16,\n    color = '#2A2A2A',\n    width = 42,\n    height = 42,\n    borderRadius = 1000,\n    borderWidth,\n    borderColor,\n    borderStyle,\n    verticalLayout, // Default row layout, no layout parameters default to precedence icon\n    resourceID,\n    notificationTitle,\n    notificationMessage\n  } = props;\n\n  const getImageSourceByPath = () => {\n    if (type === ZegoInvitationType.videoCall) {\n      return require('../resources/blue_button_video_call.png');\n    } else {\n      return require('../resources/blue_button_audio_call.png');\n    }\n  };\n  const getRenderView = () => {\n    let renderView;\n    if (verticalLayout === undefined) {\n      // Choose between icon and text\n      if (icon) {\n        renderView = <Image resizeMode=\"contain\" source={icon} />;\n      } else {\n        if (!text) {\n          renderView = (\n            <Image resizeMode=\"contain\" source={getImageSourceByPath()} />\n          );\n        } else {\n          renderView = <Text style={getCustomTextStyle(fontSize, color).text}>{text}</Text>;\n        }\n      }\n    } else {\n      // Both icon and text exist\n      var marigin = text ? 6 : 0;\n      renderView = <Fragment>\n        <Image resizeMode=\"contain\" source={icon || getImageSourceByPath()} style={{marginRight: marigin}}/>\n        <Text style={getCustomTextStyle(fontSize, color).text}>{text}</Text>\n      </Fragment>\n    }\n    return renderView;\n  };\n  const getCustomTextStyle = (fontSize: number, color: string) => StyleSheet.create({\n    text: {\n      fontSize,\n      color,\n    },\n  });\n  const getCustomContainerStyle = () => StyleSheet.create({\n    customContainer: {\n      flexDirection: verticalLayout ? 'column' : 'row',\n      width: width,\n      height: height,\n      backgroundColor: backgroundColor,\n      borderRadius: borderRadius,\n      borderWidth: borderWidth,\n      borderColor: borderColor,\n      borderStyle: borderStyle,\n    },\n  });\n\n  const onButtonPress = () => {\n    if (requesting) {\n      zloginfo('[Components]Send invitation requesting..... return.');\n      callOnFailure({ code: -1, message: 'Press too frequently.' })\n      return;\n    }\n    if (invitees.length == 0) {\n      callOnFailure({ code: -1, message: 'Invitees is empty.' })\n      return\n    }\n    requesting = true;\n    (typeof onRequestStatusChanged === 'function') ? onRequestStatusChanged(requesting) : null\n    \n    let canSendInvitation = true;\n    if (onWillPressed) {\n      if (typeof onWillPressed === 'function') {\n        zloginfo('#########onWillPressed function', onWillPressed);\n        canSendInvitation = onWillPressed();\n      } else {\n        // don't support promise\n        canSendInvitation = false\n      }\n    }\n    zloginfo('#########onWillPressed result:', canSendInvitation);\n\n    if (!canSendInvitation) {\n      requesting = false;\n      (typeof onRequestStatusChanged === 'function') ? onRequestStatusChanged(requesting) : null\n      return; \n    }\n\n    let updatedData = null\n    if (typeof onRequestData === 'function') {\n      updatedData = onRequestData()\n    } else if (data != undefined) {\n      updatedData = data\n    } else {\n      requesting = false;\n      (typeof onRequestStatusChanged === 'function') ? onRequestStatusChanged(requesting) : null\n      return; \n    }\n\n    let notificationConfig = { resourceID, title: notificationTitle, message: notificationMessage }\n    zloginfo(\n      `[Components]Send invitation start, invitees: ${JSON.stringify(invitees)}, timeout: ${timeout}, type: ${type}, data: ${updatedData}, notificationConfig: ${JSON.stringify(notificationConfig)}`\n    );\n    ZegoUIKitInvitationService.sendInvitation(invitees, timeout, type, updatedData, notificationConfig)\n      .then(({ code, message, callID, errorInvitees }: any) => {\n        zloginfo(\n          `[Components]Send invitation success, code: ${code}, message: ${message}, errorInvitees: ${errorInvitees}`\n        );\n        if (invitees.length > errorInvitees.length) {\n          if (typeof onPressed === 'function') {\n            const inviteesBackup = JSON.parse(JSON.stringify(invitees));\n            errorInvitees.forEach((errorInviteeID: string) => {\n              const index = inviteesBackup.findIndex(\n                (inviteeID: string) => errorInviteeID === inviteeID\n              );\n              index !== -1 && inviteesBackup.splice(index, 1);\n            });\n            onPressed({\n              invitationID: callID,\n              errorCode: code,\n              errorMessage: message,\n              errorInvitees,\n              invitees: inviteesBackup,\n            });\n          }\n        }\n        setTimeout(() => {\n          requesting = false;\n          (typeof onRequestStatusChanged === 'function') ? onRequestStatusChanged(requesting) : null\n        }, 1000);\n      })\n      .catch(({ code, message }: any) => {\n        ZegoUIKitInternal.notifyErrorUpdate('SendInvitation', code, message);\n        callOnFailure({code, message})\n        setTimeout(() => {\n          requesting = false;\n          (typeof onRequestStatusChanged === 'function') ? onRequestStatusChanged(requesting) : null\n        }, 1000);\n        zlogerror(\n          `[Components]Send invitation error, code: ${code}, message: ${message}`\n        );\n      });\n  };\n\n  const callOnFailure = ({code, message}: any) => {\n    if (typeof onFailure === 'function') {\n      onFailure({ code: code, message: message });\n      zloginfo('[ZegoSendInvitationButton][onButtonPress] onFailure execute end')\n    }\n  }\n\n  useEffect(() => {\n    zloginfo(`[ZegoSendInvitationButton] useEffect, notificationTitle: ${notificationTitle}`)\n    return () => {\n      zloginfo(`[ZegoSendInvitationButton] useEffect return`)\n    };\n  }, []);\n\n  return (\n    <TouchableOpacity\n      style={[\n        styles.container,\n        getCustomContainerStyle().customContainer\n      ]}\n      onPress={onButtonPress}\n    >\n      {getRenderView()}\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n"],"mappings":"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","ignoreList":[]}