{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_reactDelegateComponent","_interopRequireDefault","_AudioFrame","_VideoFrame","_ZegoUIKitInternal","_logger","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","MaskViewDefault","props","userInfo","userName","createElement","View","style","styles","defaultMaskContainer","defaultMaskNameLabelContainer","Text","defaultMaskNameLabel","ZegoVideoView","userID","roomID","audioViewBackgroudColor","audioViewBackgroudImage","showSoundWave","useVideoViewAspectFill","foregroundBuilder","avatarSize","avatarAlignment","avatarBuilder","avatarBackgroundColor","soundWaveColor","isPictureInPicture","setUserInfo","useState","isCameraOn","setIsCameraOn","propsData","setPropsData","userInfo_","ZegoUIKitInternal","getUser","inRoomAttributes","avatar","setAvatarUrl","useEffect","user","isCameraDeviceOn","callbackID","String","Math","floor","random","onSDKConnected","onUserInfoUpdate","info","onRoomStateChanged","isRoomConnected","onUserCountOrPropertyChanged","userList","zloginfo","forEach","temp","container","videoContainer","fillMode","mask","to","StyleSheet","create","flex","width","height","position","zIndex","backgroundColor","opacity","alignSelf","paddingLeft","paddingRight","paddingBottom","paddingTop","borderRadius","bottom","right","color","fontSize"],"sources":["index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, StyleSheet, Text } from 'react-native';\nimport Delegate from 'react-delegate-component';\nimport AudioFrame from './AudioFrame';\nimport VideoFrame from './VideoFrame';\nimport ZegoUIKitInternal from '../../internal/ZegoUIKitInternal';\nimport { zloginfo } from '../../../utils/logger';\n\nfunction MaskViewDefault(props: any) {\n  const { userInfo } = props;\n  const { userName = '' } = userInfo;\n  return (\n    <View style={styles.defaultMaskContainer}>\n      <View style={styles.defaultMaskNameLabelContainer}>\n        <Text style={styles.defaultMaskNameLabel}>{userName}</Text>\n      </View>\n    </View>\n  );\n}\n\nexport default function ZegoVideoView(props: any) {\n  const {\n    userID,\n    roomID,\n    audioViewBackgroudColor,\n    audioViewBackgroudImage,\n    showSoundWave = true,\n    useVideoViewAspectFill = false,\n    foregroundBuilder,\n    avatarSize,\n    avatarAlignment = 0,\n    avatarBuilder,\n    avatarBackgroundColor,\n    soundWaveColor,\n    isPictureInPicture,\n  } = props;\n\n  const [userInfo, setUserInfo] = useState({});\n  const [isCameraOn, setIsCameraOn] = useState(true);\n  const [propsData, setPropsData] = useState({ userInfo: {} });\n  const userInfo_ = ZegoUIKitInternal.getUser(userID);\n  const inRoomAttributes = userInfo_ ? userInfo_.inRoomAttributes : {};\n  const [avatar, setAvatarUrl] = useState(inRoomAttributes ? (inRoomAttributes.avatar || '') : '');\n\n  useEffect(() => {\n    const user = ZegoUIKitInternal.getUser(userID);\n    if (user) {\n      setUserInfo(user);\n      setPropsData({ userInfo: user });\n      setIsCameraOn(user.isCameraDeviceOn);\n    }\n  }, []);\n\n  useEffect(() => {\n    const callbackID = 'ZegoVideoView' + String(userID) + String(Math.floor(Math.random() * 10000));\n\n    ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n      const user = ZegoUIKitInternal.getUser(userID);\n      if (user) {\n        setUserInfo(user);\n        setPropsData({ userInfo: user });\n        setIsCameraOn(user.isCameraDeviceOn);\n      }\n    });\n    ZegoUIKitInternal.onUserInfoUpdate(callbackID, (info: any) => {\n      if (info.userID == userID) {\n        setIsCameraOn(info.isCameraDeviceOn);\n        setUserInfo(info);\n        setPropsData({ userInfo: info });\n      }\n    });\n    ZegoUIKitInternal.onRoomStateChanged(\n      callbackID,\n      () => {\n        if (ZegoUIKitInternal.isRoomConnected()) {\n          const user = ZegoUIKitInternal.getUser(userID);\n          if (user) {\n            setIsCameraOn(user.isCameraDeviceOn);\n          }\n        }\n      }\n    );\n    ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList: any[]) => {\n      zloginfo('[ZegoVideoView]onUserCountOrPropertyChanged', userID, userList);\n      userList.forEach((user) => {\n        const temp = user.inRoomAttributes ? user.inRoomAttributes.avatar : '';\n        if (user.userID === userID && temp) {\n          setAvatarUrl(temp);\n        }\n      });\n    });\n    return () => {\n      ZegoUIKitInternal.onSDKConnected(callbackID);\n      ZegoUIKitInternal.onUserInfoUpdate(callbackID);\n      ZegoUIKitInternal.onRoomStateChanged(callbackID);\n      ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n    };\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      <VideoFrame\n        style={styles.videoContainer}\n        userID={userID}\n        roomID={roomID}\n        isPictureInPicture={isPictureInPicture}\n        fillMode={useVideoViewAspectFill ? 1 : 0} // 1:AspectFill, 0:AspectFit\n      >\n        {!isCameraOn ? (\n          <AudioFrame\n            userInfo={userInfo}\n            showSoundWave={showSoundWave}\n            audioViewBackgroudColor={audioViewBackgroudColor}\n            audioViewBackgroudImage={audioViewBackgroudImage}\n            avatar={avatar}\n            avatarSize={avatarSize}\n            avatarAlignment={avatarAlignment}\n            avatarBuilder={avatarBuilder}\n            avatarBackgroundColor={avatarBackgroundColor}\n            soundWaveColor={soundWaveColor}\n          />\n        ) : null}\n      </VideoFrame>\n\n      <Delegate\n        style={styles.mask}\n        to={foregroundBuilder}\n        default={MaskViewDefault}\n        props={propsData}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n  },\n  videoContainer: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n  },\n  mask: {\n    flex: 1,\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    zIndex: 2,\n  },\n  defaultMaskContainer: {\n    flex: 1,\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 2,\n  },\n  defaultMaskNameLabelContainer: {\n    flex: 1,\n    backgroundColor: '#2A2A2A',\n    opacity: 0.5,\n    position: 'absolute',\n    alignSelf: 'center',\n    paddingLeft: 5,\n    paddingRight: 5,\n    paddingBottom: 3,\n    paddingTop: 3,\n    borderRadius: 6,\n    bottom: 5,\n    right: 5,\n  },\n  defaultMaskNameLabel: {\n    flex: 1,\n    color: '#FFFFFF',\n    fontSize: 12,\n  },\n});\n"],"mappings":"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","ignoreList":[]}