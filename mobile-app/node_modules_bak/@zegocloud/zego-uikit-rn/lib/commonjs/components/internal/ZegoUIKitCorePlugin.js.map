{"version":3,"names":["_reactNative","require","_logger","_defines","_plugins","Map","ZegoUIKitCorePlugin","installPlugins","plugins","zloginfo","Array","zlogerror","forEach","plugin","index","ZIMConnectionState","get","set","ZPNsPushSourceType","Platform","OS","callKitPlugin","error","zlogwarning","getInstance","type","getPluginType","Object","values","ZegoUIKitPluginType","includes","getZIMPlugin","getZPNsPlugin","getCallKitPlugin","getPlugin","signaling","getPluginName","name","_default","exports","default"],"sources":["ZegoUIKitCorePlugin.ts"],"sourcesContent":["import { Platform } from 'react-native';\nimport { zloginfo, zlogerror, zlogwarning } from '../../utils/logger';\nimport { ZegoUIKitPluginType } from './defines';\n\nconst _plugins = new Map(); // type -> plugin\nconst ZegoUIKitCorePlugin = {\n  installPlugins: (plugins: any[]) => {\n    zloginfo(`[ZegoUIKitCorePlugin] installPlugins, plugins: ${plugins}`)\n\n    if (!plugins || !(plugins instanceof Array)) {\n      zlogerror('[ZegoUIKitCorePlugin][installPlugins]The parameter passed in was incorrect');\n      return;\n    }\n    plugins.forEach((plugin, index) => {\n      if (plugin.ZIMConnectionState) {\n        if (_plugins.get('ZIM')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZIM'\n          );\n        } else {\n          _plugins.set('ZIM', plugin);\n          zloginfo(`[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZIM, index: ${index}`);\n        }\n      } else if (plugin.ZPNsPushSourceType) {\n        if (_plugins.get('ZPNs')) {\n          zloginfo(\n            '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugin: ZPNs'\n          );\n        } else {\n          _plugins.set('ZPNs', plugin);\n          zloginfo(`[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ZPNs, index: ${index}`);\n\n          if (!(_plugins.get('CallKit')) && Platform.OS === 'ios') {\n            try {\n              let callKitPlugin = require('zego-callkit-react-native');\n              _plugins.set('CallKit', callKitPlugin);\n              zloginfo(`[ZegoUIKitCorePlugin][installPlugins] Plugin install success, plugin: CallKit, index: ${index}`);\n            } catch(error) {\n              zlogwarning(`[ZegoUIKitCorePlugin][installPlugins] Cannot resolve module zego-callkit-react-native`);\n            }\n          }\n        }\n      } else if (typeof plugin.getInstance === 'function') {\n        // Compatible with the original usage\n        const type = plugin.getInstance().getPluginType\n          ? plugin.getInstance().getPluginType()\n          : null;\n        if (Object.values(ZegoUIKitPluginType).includes(type)) {\n          if (_plugins.get(type)) {\n            zloginfo(\n              '[ZegoUIKitCorePlugin][installPlugins]Plugin already exists, this install does not take effect, plugins: ', type\n            );\n          } else {\n            _plugins.set(type, plugin);\n            zloginfo('[ZegoUIKitCorePlugin][installPlugins]Plugin install success, plugin: ', type);\n          }\n        }\n      }\n    });\n  },\n  getZIMPlugin: () => {\n    return _plugins.get('ZIM');\n  },\n  getZPNsPlugin: () => {\n    return _plugins.get('ZPNs');\n  },\n  getCallKitPlugin: () => {\n    return _plugins.get('CallKit');\n  },\n  getPlugin: (type: number) => {\n    if (type === ZegoUIKitPluginType.signaling) {\n      zloginfo('[ZegoUIKitCorePlugin][getPlugin] type:', type);\n      return _plugins.get(type) || ZegoUIKitCorePlugin.getZIMPlugin();\n    }\n    return _plugins.get(type);\n  },\n  getPluginName: (name: string) => {\n    return _plugins.get(name);\n  }\n};\nexport default ZegoUIKitCorePlugin;\nexport { ZegoUIKitPluginType };\n"],"mappings":"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","ignoreList":[]}