{"version":3,"names":["_zegoExpressEngineReactnative","_interopRequireWildcard","require","_defines","_invitation","_interopRequireDefault","_enum_name","_logger","_package_version","_report","_version","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_appInfo","appID","appSign","_isRoomConnected","_currentRoomState","_currentRoomID","_audioOutputType","_usingFrontFacingCamera","_onMicDeviceOnCallbackMap","_onCameraDeviceOnCallbackMap","_onRoomStateChangedCallbackMap","_onRequireNewTokenCallbackMap","_onUserJoinCallbackMap","_onUserLeaveCallbackMap","_onUserInfoUpdateCallbackMap","_onSoundLevelUpdateCallbackMap","_onSDKConnectedCallbackMap","_onAudioOutputDeviceTypeChangeCallbackMap","_onOnlySelfInRoomCallbackMap","_onUserCountOrPropertyChangedCallbackMap","_onAudioVideoAvailableCallbackMap","_onAudioVideoUnavailableCallbackMap","_onInRoomMessageReceivedCallbackMap","_onInRoomMessageSentCallbackMap","_onRoomPropertyUpdatedCallbackMap","_onRoomPropertiesFullUpdatedCallbackMap","_onInRoomCommandReceivedCallbackMap","_onMeRemovedFromRoomCallbackMap","_onJoinRoomCallbackMap","_onTurnOnYourCameraRequestCallbackMap","_onTurnOnYourMicrophoneRequestCallbackMap","_onScreenSharingAvailableCallbackMap","_onScreenSharingUnavailableCallbackMap","_onMemberListForceSortCallbackMap","_onAudioVideoListForceSortCallbackMap","_onVideoViewForceRenderCallbackMap","_localCoreUser","_createCoreUser","_streamCoreUserMap","_coreUserMap","_qualityUpdateLogCounter","_inRoomMessageList","_audioVideoResourceMode","ZegoAudioVideoResourceMode","Default","_roomProperties","_isLargeRoom","_roomMemberCount","_markAsLargeRoom","_onErrorCallbackMap","_onTokenProvideCallback","undefined","_videoConfig","ZegoUIKitVideoConfig","preset360P","_appOrientation","ZegoOrientation","PortraitUp","_engineState","ZegoEngineState","Stop","_screenshareStreamIDFlag","_resetData","zloginfo","isLandscape","_resetDataForLeavingRoom","userID","userName","profileUrl","extendInfo","_createPublicUser","coreUser","isMicrophoneOn","isMicDeviceOn","isCameraOn","isCameraDeviceOn","soundLevel","inRoomAttributes","avatar","viewID","viewFillMode","streamID","screenshareViewID","screenshareViewFillMode","screenshareStreamID","publisherQuality","joinTime","_isLocalUser","_setLocalUserInfo","userInfo","_onRoomUserUpdate","roomID","updateType","userList","userInfoList","ZegoUpdateType","Add","length","forEach","user","_getStreamIDByUserID","_getScreenshareStreamIDByUserID","Date","now","_notifyUserInfoUpdate","push","_tryStartPlayStream","_notifyUserCountOrPropertyChanged","ZegoChangedCountOrProperty","userAdd","keys","callbackID","_tryStopPlayStream","_tryStopPlayScreenshareStream","userDelete","_onRoomStreamUpdate","streamList","users","screenshareUsers","stream","isScreenSharing","endsWith","parseStreamExtraInfo","_notifyAudioVideoAvailable","_notifyScreenSharingAvailable","cameraStateUpdate","_notifyAudioVideoUnavailable","_notifyScreenSharingUnavailable","_onRemoteCameraStateUpdate","isOn","_onAudioRouteChange","type","_onRemoteMicStateUpdate","microphoneStateUpdate","_onRoomStateChanged","reason","errorCode","extendedData","ZegoRoomStateChangedReason","Logined","Reconnected","_tryStartPublishStream","KickOut","_notifyMeRemovedFromRoom","_onInRoomMessageReceived","messageList","messages","msg","message","messageID","sendTime","sender","fromUser","_onRequireNewToken","token","ZegoExpressEngine","instance","renewToken","then","catch","error","zlogerror","ZegoUIKitInternal","getToken","_onRoomExtraInfoUpdate","roomExtraInfoList","updateKeys","oldRoomProperties","JSON","parse","stringify","key","updateTime","updateUser","value","roomProperties","propertyKey","_notifyRoomPropertyUpdate","ZegoRoomPropertyUpdateType","remote","_notifyRoomPropertiesFullUpdate","_onIMCustomCommandReceived","command","commandObj","removeUserIDList","zego_remove_user","turnCameraOnUserID","zego_turn_camera_on","turnCameraOffUserID","zego_turn_camera_off","turnMicrophoneOnUserID","zego_turn_microphone_on","turnMicrophoneOffUserID","zego_turn_microphone_off","find","removeUserID","_leaveRoom","_turnCameraDeviceOn","_turnMicDeviceOn","_sendInRoomCommand","toUserList","Promise","reject","resolve","sendCustomCommand","logoutRoom","ZegoUIKitReport","reportEvent","stopSoundLevelMonitor","on","muteMicrophone","extraInfo","setStreamExtraInfo","ZegoPublishChannel","Main","_tryStopPublishStream","isLargeRoom","enableCamera","_registerEngineCallback","getZegoUpdateTypeName","quality","split","state","getZegoRemoteDeviceStateName","ZegoRemoteDeviceState","Open","_getUserIDByStreamID","isMicOn","soundLevels","_notifySoundLevelUpdate","audioRoute","remainTimeInSecond","width","height","forceRenderVideoView","channel","getZegoEngineStateName","_unregisterEngineCallback","off","values","sort","user1","user2","map","_getPublishStreamID","startPublishingStream","startPreview","reactTag","viewMode","fillMode","backgroundColor","force","stopPublishingStream","stopPreview","startPlayingStream","resourceMode","stopPlayingStream","oldValue","_notifyJoinRoom","_applyVideoConfig","config","toSDK","setVideoConfig","_isEngineCreated","getPackageVersion","logComponentsVersion","isRoomConnected","setAudioVideoResourceMode","audioVideoResourceMode","updateRenderingProperty","lastViewID","isScreenshare","zlogwarning","canUpdateViewID","onUserInfoUpdate","callback","onSoundLevelUpdate","onSDKConnected","connectSDK","setEngineConfig","advancedConfig","notify_remote_device_unknown_status","notify_remote_device_init_status","engineProfile","scenario","create","createEngineWithProfile","engine","disconnectSDK","destroyEngine","finally","useFrontFacingCamera","isFrontFacing","useFrontCamera","isUsingFrontFacingCamera","enableSpeaker","enable","muteSpeaker","audioOutputDeviceType","turnMicDeviceOn","turnCameraDeviceOn","onMicDeviceOn","onCameraDeviceOn","setAudioOutputToSpeaker","isSpeaker","setAudioRouteToSpeaker","onAudioOutputDeviceTypeChange","setAudioConfig","setAppOrientation","orientation","appOrientation","onAudioVideoAvailable","onAudioVideoUnavailable","muteUserAudio","mute","mutePlayStreamAudio","muteUserVideo","mutePlayStreamVideo","startPlayingAllAudioVideo","muteAllPlayStreamAudio","muteAllPlayStreamVideo","stopPlayingAllAudioVideo","onTurnOnYourCameraRequest","onTurnOnYourMicrophoneRequest","joinRoom","markAsLargeRoom","trim","Error","isUserStatusNotify","eventBegin","loginRoom","startSoundLevelMonitor","inRoom","leaveRoom","onRoomStateChanged","onRequireNewToken","setRoomProperty","setRoomExtraInfo","code","updateRoomProperties","newRoomProperties","updateKey","update","getRoomProperties","onRoomPropertyUpdated","onRoomPropertiesFullUpdated","sendInRoomCommand","toUserIDs","onInRoomCommandReceived","onMeRemovedFromRoom","onJoinRoom","connectUser","disconnectUser","getLocalUserInfo","getUser","getAllScreenshareUsers","getAllUsers","b","publicUsers","getAudioVideoUsers","onUserJoin","onUserLeave","onOnlySelfInRoom","onUserCountOrPropertyChanged","removeUserFromRoom","userIDs","getInRoomMessages","sendInRoomMessage","sendBroadcastMessage","result","inRoomMessage","onInRoomMessageReceived","onInRoomMessageSent","notifyUserCountOrPropertyChanged","notifyUserInfoUpdate","forceSortMemberList","onMemberListForceSort","forceSortAudioVideoList","onAudioVideoListForceSort","onVideoViewForceRender","onError","notifyErrorUpdate","method","onTokenProvide","ZegoUIKitSignalingPluginImpl","onScreenSharingAvailable","onScreenSharingUnavailable","_default","exports"],"sources":["ZegoUIKitInternal.ts"],"sourcesContent":["import ZegoExpressEngine, {\n  ZegoAudioRoute,\n  ZegoEngineProfile,\n  ZegoEngineState,\n  ZegoOrientation,\n  ZegoPublishChannel,\n  ZegoRemoteDeviceState,\n  ZegoRoomConfig,\n  ZegoRoomStateChangedReason,\n  ZegoStream,\n  ZegoUpdateType,\n  ZegoUser,\n} from 'zego-express-engine-reactnative';\n\nimport { ZegoAudioVideoResourceMode, ZegoChangedCountOrProperty, ZegoRoomPropertyUpdateType, ZegoUIKitVideoConfig } from './defines'\nimport ZegoUIKitSignalingPluginImpl from '../../plugins/invitation';\nimport { getZegoEngineStateName, getZegoRemoteDeviceStateName, getZegoUpdateTypeName } from '../../utils/enum_name';\nimport { zlogerror, zloginfo, zlogwarning } from '../../utils/logger';\nimport { getPackageVersion } from '../../utils/package_version';\nimport ZegoUIKitReport from '../../utils/report';\nimport { logComponentsVersion } from '../../utils/version';\n\nvar _appInfo = {\n  appID: 0,\n  appSign: '',\n};\nvar _isRoomConnected = false;\nvar _currentRoomState = 7; // Logout\nvar _currentRoomID = '';\nvar _audioOutputType = 0;\nvar _usingFrontFacingCamera = true;\n\nvar _onMicDeviceOnCallbackMap: any = {};\nvar _onCameraDeviceOnCallbackMap: any = {};\nvar _onRoomStateChangedCallbackMap: any = {};\nvar _onRequireNewTokenCallbackMap: any = {};\nvar _onUserJoinCallbackMap: any = {};\nvar _onUserLeaveCallbackMap: any = {};\nvar _onUserInfoUpdateCallbackMap: any = {};\nvar _onSoundLevelUpdateCallbackMap: any = {};\nvar _onSDKConnectedCallbackMap: any = {};\nvar _onAudioOutputDeviceTypeChangeCallbackMap: any = {};\nvar _onOnlySelfInRoomCallbackMap: any = {};\nvar _onUserCountOrPropertyChangedCallbackMap: any = {};\nvar _onAudioVideoAvailableCallbackMap: any = {};\nvar _onAudioVideoUnavailableCallbackMap: any = {};\nvar _onInRoomMessageReceivedCallbackMap: any = {};\nvar _onInRoomMessageSentCallbackMap: any = {};\nvar _onRoomPropertyUpdatedCallbackMap: any = {};\nvar _onRoomPropertiesFullUpdatedCallbackMap: any = {};\nvar _onInRoomCommandReceivedCallbackMap: any = {};\nvar _onMeRemovedFromRoomCallbackMap: any = {};\nvar _onJoinRoomCallbackMap: any = {};\nvar _onTurnOnYourCameraRequestCallbackMap: any = {};\nvar _onTurnOnYourMicrophoneRequestCallbackMap: any = {};\nvar _onScreenSharingAvailableCallbackMap: any = {};\nvar _onScreenSharingUnavailableCallbackMap: any = {};\n\n// Force update component callback\nvar _onMemberListForceSortCallbackMap: any = {};\nvar _onAudioVideoListForceSortCallbackMap: any = {};\nvar _onVideoViewForceRenderCallbackMap: any = {};\n\nvar _localCoreUser: any = _createCoreUser('', '', '', {});\nvar _streamCoreUserMap: any = {}; // <streamID, CoreUser>\nvar _coreUserMap: any = {}; // <userID, CoreUser>\nvar _qualityUpdateLogCounter = 0;\n\nvar _inRoomMessageList: any[] = [];\nvar _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\nvar _roomProperties: any = {};\nvar _isLargeRoom = false;\nvar _roomMemberCount = 0;\nvar _markAsLargeRoom = false;\n\nvar _onErrorCallbackMap: any = {};\nvar _onTokenProvideCallback: Function = undefined;\n\nvar _videoConfig = ZegoUIKitVideoConfig.preset360P();\nvar _appOrientation = ZegoOrientation.PortraitUp;\nvar _engineState = ZegoEngineState.Stop;\n\nconst _screenshareStreamIDFlag = '_screensharing';\n\nfunction _resetData() {\n  zloginfo('Reset all data.');\n  _appInfo = { appID: 0, appSign: '' };\n  _localCoreUser = _createCoreUser('', '', '', {});\n  _localCoreUser.isLandscape = (_appOrientation !== 0);\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  _audioOutputType = 0;\n  _inRoomMessageList = [];\n  _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _resetDataForLeavingRoom() {\n  zloginfo('Reset data for leaving room.');\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  const { userID, userName, profileUrl, extendInfo } = _localCoreUser;\n  _localCoreUser = _createCoreUser(userID, userName, profileUrl, extendInfo);\n  _localCoreUser.isLandscape = (_appOrientation !== 0);\n  _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n  _inRoomMessageList = [];\n  _roomProperties = {};\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _createPublicUser(coreUser: any) {\n  return {\n    userID: coreUser.userID,\n    userName: coreUser.userName,\n    extendInfo: coreUser.extendInfo,\n    isMicrophoneOn: coreUser.isMicDeviceOn,\n    isCameraOn: coreUser.isCameraDeviceOn,\n    soundLevel: coreUser.soundLevel,\n    inRoomAttributes: coreUser.inRoomAttributes,\n    avatar: coreUser.avatar,\n  };\n}\nfunction _createCoreUser(userID: string, userName: string, profileUrl?: string, extendInfo?: any) {\n  return {\n    userID: userID,\n    userName: userName,\n    profileUrl: profileUrl,\n    extendInfo: extendInfo,\n    viewID: -1,\n    viewFillMode: 1,\n    streamID: '',\n    screenshareViewID: -1,\n    screenshareViewFillMode: 1,\n    screenshareStreamID: '',\n    isMicDeviceOn: false,\n    isCameraDeviceOn: false,\n    publisherQuality: 0,\n    soundLevel: 0,\n    joinTime: 0,\n    inRoomAttributes: {},\n    avatar: '',\n    isLandscape: false,\n  };\n}\nfunction _isLocalUser(userID: string) {\n  return (\n    userID === undefined || userID === '' || _localCoreUser.userID === userID\n  );\n}\nfunction _setLocalUserInfo(userInfo: any) {\n  _localCoreUser = _createCoreUser(\n    userInfo.userID,\n    userInfo.userName,\n    userInfo.profileUrl,\n    userInfo.extendInfo\n  );\n  _coreUserMap[userInfo.userID] = _localCoreUser;\n}\n\nfunction _onRoomUserUpdate(roomID: string, updateType: number, userList: any[]) {\n  // No need for roomID, does not support multi-room right now.\n  const userInfoList: any[] = [];\n  if (updateType == ZegoUpdateType.Add) {\n    _roomMemberCount += userList.length;\n    if (_roomMemberCount >= 500) {\n      _isLargeRoom = true;\n    }\n    userList.forEach((user) => {\n      if (!(user.userID in _coreUserMap)) {\n        const coreUser = _createCoreUser(user.userID, user.userName);\n        _coreUserMap[user.userID] = coreUser;\n      }\n      const streamID = _getStreamIDByUserID(user.userID);\n      if (streamID in _streamCoreUserMap) {\n        _coreUserMap[user.userID].streamID = streamID;\n      }\n\n      const screenshareStreamID = _getScreenshareStreamIDByUserID(user.userID);\n      if (screenshareStreamID in _streamCoreUserMap) {\n        _coreUserMap[user.userID].screenshareStreamID = screenshareStreamID;\n      }\n\n      _coreUserMap[user.userID].joinTime = Date.now();\n      _notifyUserInfoUpdate(_coreUserMap[user.userID]);\n\n      userInfoList.push(_createPublicUser(_coreUserMap[user.userID]));\n\n      // Start after user insert into list\n      _tryStartPlayStream(user.userID);\n    });\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n    zloginfo('Users Join: ', userInfoList);\n    Object.keys(_onUserJoinCallbackMap).forEach((callbackID) => {\n      if (_onUserJoinCallbackMap[callbackID]) {\n        _onUserJoinCallbackMap[callbackID](userInfoList);\n      }\n    });\n  } else {\n    // updateType == ZegoUpdateType.Delete\n    _roomMemberCount -= userList.length;\n    userList.forEach((user) => {\n      if (user.userID in _coreUserMap) {\n        const coreUser = _coreUserMap[user.userID];\n        const userInfo = {\n          userID: coreUser.userID,\n          userName: coreUser.userName,\n          profileUrl: coreUser.profileUrl,\n          extendInfo: coreUser.extendInfo,\n        };\n        userInfoList.push(userInfo);\n\n        // Stop play stream before remove user list\n        _tryStopPlayStream(coreUser.userID, true);\n        _tryStopPlayScreenshareStream(coreUser.userID);\n        delete _coreUserMap[user.userID];\n      }\n    });\n    zloginfo('Users Leave: ', userInfoList);\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userDelete);\n    Object.keys(_onUserLeaveCallbackMap).forEach((callbackID) => {\n      if (_onUserLeaveCallbackMap[callbackID]) {\n        _onUserLeaveCallbackMap[callbackID](userInfoList);\n      }\n    });\n    if (Object.keys(_coreUserMap).length <= 1) {\n      Object.keys(_onOnlySelfInRoomCallbackMap).forEach((callbackID) => {\n        if (_onOnlySelfInRoomCallbackMap[callbackID]) {\n          _onOnlySelfInRoomCallbackMap[callbackID]();\n        }\n      });\n    }\n  }\n}\nfunction _onRoomStreamUpdate(roomID: string, updateType: number, streamList: any[]) {\n  zloginfo('_onRoomStreamUpdate: ', roomID, updateType, streamList);\n  var users: any[] = [];\n  var screenshareUsers: any[] = [];\n  if (updateType == 0) {\n    // Add\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const userName = stream.user.userName;\n      const streamID: string = stream.streamID;\n      const isScreenSharing = streamID.endsWith(_screenshareStreamIDFlag);\n      if (userID in _coreUserMap) {\n        if (isScreenSharing) {\n          _coreUserMap[userID].screenshareStreamID = streamID;\n        } else {\n          _coreUserMap[userID].streamID = streamID;\n        }\n        _streamCoreUserMap[streamID] = _coreUserMap[userID];\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n        _tryStartPlayStream(userID);\n      } else {\n        const coreUser = _createCoreUser(\n          userID,\n          userName,\n          '',\n          {}\n        );\n        if (isScreenSharing) {\n          coreUser.screenshareStreamID = streamID;\n        } else {\n          coreUser.streamID = streamID;\n        }\n        _streamCoreUserMap[streamID] = coreUser;\n        _coreUserMap[userID] = coreUser;\n      }\n\n      // Add users.\n      users.push(_coreUserMap[userID]);\n      if (isScreenSharing) {\n        screenshareUsers.push(_coreUserMap[userID]);\n      }\n\n      parseStreamExtraInfo(stream)\n    });\n\n    // notify\n    _notifyAudioVideoAvailable(users);\n    _notifyScreenSharingAvailable(screenshareUsers);\n  } else {\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const streamID = stream.streamID;\n      const isScreenSharing = streamID.endsWith(_screenshareStreamIDFlag);\n      if (userID in _coreUserMap) {\n        if (isScreenSharing) {\n          _tryStopPlayScreenshareStream(userID);\n          _coreUserMap[userID].screenshareStreamID = '';\n        } else {\n          _tryStopPlayStream(userID, true);\n          _coreUserMap[userID].isCameraDeviceOn = false;\n          _coreUserMap[userID].isMicDeviceOn = false;\n          _coreUserMap[userID].streamID = '';\n          _notifyUserInfoUpdate(_coreUserMap[userID]);\n        }\n\n        // Add users.\n        users.push(_coreUserMap[userID]);\n        if (isScreenSharing) {\n          screenshareUsers.push(_coreUserMap[userID]);\n        }\n\n        delete _streamCoreUserMap[streamID];\n      }\n    });\n\n    // notify.\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n    _notifyAudioVideoUnavailable(users);\n    _notifyScreenSharingUnavailable(screenshareUsers);\n  }\n}\nfunction _onRemoteCameraStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isCameraDeviceOn = isOn;\n    zloginfo(`RemoteCameraStateUpdate, ${userID} camera: ${isOn}`)\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n\n    Object.keys(_onCameraDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onCameraDeviceOnCallbackMap[callbackID]) {\n        _onCameraDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onAudioRouteChange(type: ZegoAudioRoute) {\n  Object.keys(_onAudioOutputDeviceTypeChangeCallbackMap).forEach(\n    (callbackID) => {\n      if (_onAudioOutputDeviceTypeChangeCallbackMap[callbackID]) {\n        _onAudioOutputDeviceTypeChangeCallbackMap[callbackID](type);\n      }\n    }\n  );\n  _audioOutputType = type;\n}\nfunction _onRemoteMicStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isMicDeviceOn = isOn;\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.microphoneStateUpdate\n    );\n\n    Object.keys(_onMicDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onMicDeviceOnCallbackMap[callbackID]) {\n        _onMicDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onRoomStateChanged(roomID: string, reason: ZegoRoomStateChangedReason, errorCode: number, extendedData: string) {\n  zloginfo(`Room state changed: roomID: ${roomID}, reason: ${reason}, error: ${errorCode}, extendedData: ${extendedData}`);\n\n  // Not support multi-room right now\n  if (reason == ZegoRoomStateChangedReason.Logined || reason == ZegoRoomStateChangedReason.Reconnected) {\n    // Logined || Reconnected\n    _isRoomConnected = true;\n    _tryStartPublishStream();\n  } else {\n    _isRoomConnected = false;\n    if (reason === ZegoRoomStateChangedReason.KickOut) {\n      // KickOut\n      _notifyMeRemovedFromRoom();\n    }\n  }\n  _currentRoomState = reason;\n\n  Object.keys(_onRoomStateChangedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onRoomStateChangedCallbackMap) {\n      if (_onRoomStateChangedCallbackMap[callbackID]) {\n        _onRoomStateChangedCallbackMap[callbackID](\n          reason,\n          errorCode,\n          extendedData\n        );\n      }\n    }\n  });\n}\nfunction _onInRoomMessageReceived(roomID: string, messageList: any[]) {\n  zloginfo('Received in room message: ', roomID, messageList.length);\n  var messages: any[] = [];\n  messageList.forEach((msg) => {\n    const message = {\n      type: 'user',\n      message: msg.message,\n      messageID: msg.messageID,\n      sendTime: msg.sendTime,\n      sender: _createPublicUser(_coreUserMap[msg.fromUser.userID]),\n    };\n    messages.push(message);\n    _inRoomMessageList.push(message);\n  });\n\n  Object.keys(_onInRoomMessageReceivedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n      if (_onInRoomMessageReceivedCallbackMap[callbackID]) {\n        _onInRoomMessageReceivedCallbackMap[callbackID](messages);\n      }\n    }\n  });\n}\nasync function _onRequireNewToken() {\n  Object.keys(_onRequireNewTokenCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onRequireNewTokenCallbackMap) {\n      if (_onRequireNewTokenCallbackMap[callbackID]) {\n        const token = _onRequireNewTokenCallbackMap[callbackID]();\n        if (token) {\n          ZegoExpressEngine.instance()\n            .renewToken(_currentRoomID, token)\n            .then(() => {\n              zloginfo('Renew token success');\n            })\n            .catch((error) => {\n              zlogerror('Renew token failed: ', error);\n            });\n        } else {\n          zlogerror('Renew token failed: the returned token is abnormal');\n        }\n      }\n    }\n  });\n  const token = await ZegoUIKitInternal.getToken();\n  if (token) {\n    ZegoExpressEngine.instance()\n      .renewToken(_currentRoomID, token)\n      .then(() => {\n        zloginfo('Renew token success');\n      })\n      .catch((error) => {\n        zlogerror('Renew token failed: ', error);\n      });\n  }\n}\nfunction _onRoomExtraInfoUpdate(roomID: string, roomExtraInfoList: any[]) {\n  zloginfo(`[ZegoUIKitInternal] _onRoomExtraInfoUpdate, roomID:${roomID}, roomExtraInfo:${roomExtraInfoList}`);\n  const updateKeys: string[]= [];\n  const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n  roomExtraInfoList.forEach(({ key, updateTime, updateUser, value }) => {\n    if (key === 'extra_info') {\n      const roomProperties = JSON.parse(value);\n      Object.keys(roomProperties).forEach((propertyKey) => {\n        if (oldRoomProperties[propertyKey] !== roomProperties[propertyKey]) {\n          updateKeys.push(propertyKey);\n          _roomProperties[propertyKey] = roomProperties[propertyKey];\n          _notifyRoomPropertyUpdate(propertyKey, oldRoomProperties[propertyKey], roomProperties[propertyKey], ZegoRoomPropertyUpdateType.remote);\n        }\n      })\n    }\n  });\n  if (updateKeys.length > 0) {\n    _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(JSON.stringify(_roomProperties)), ZegoRoomPropertyUpdateType.remote);\n  }\n}\nfunction _onIMCustomCommandReceived(roomID: string, fromUser: ZegoUser, command: string) {\n  zloginfo(`[ZegoUIKitInternal] _onIMCustomCommandReceived, roomID: ${roomID}, fromUser: ${fromUser}, command: ${command}`);\n  \n  try {\n    const commandObj = JSON.parse(command);\n    if (commandObj && typeof commandObj === 'object') {\n      fromUser = _createPublicUser(_coreUserMap[fromUser.userID] || fromUser);\n      const removeUserIDList = commandObj.zego_remove_user;\n      const turnCameraOnUserID = commandObj.zego_turn_camera_on;\n      const turnCameraOffUserID = commandObj.zego_turn_camera_off;\n      const turnMicrophoneOnUserID = commandObj.zego_turn_microphone_on;\n      const turnMicrophoneOffUserID = commandObj.zego_turn_microphone_off;\n      if (removeUserIDList && removeUserIDList.find((removeUserID: string) => removeUserID === _localCoreUser.userID)) {\n        _notifyMeRemovedFromRoom();\n        // Leave the room automatically\n        _leaveRoom();\n      } else if (turnCameraOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourCameraRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourCameraRequestCallbackMap[callbackID]) {\n            _onTurnOnYourCameraRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnMicrophoneOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourMicrophoneRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourMicrophoneRequestCallbackMap[callbackID]) {\n            _onTurnOnYourMicrophoneRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnCameraOffUserID === _localCoreUser.userID) {\n        _turnCameraDeviceOn(_localCoreUser.userID, false);\n        // Automatic shutdown\n      } else if (turnMicrophoneOffUserID === _localCoreUser.userID) {\n        // Automatic shutdown\n        _turnMicDeviceOn(_localCoreUser.userID, false);\n      }\n    }\n  } catch (error) {\n    zlogerror(error);\n  }\n  zloginfo('_onIMCustomCommandReceived: ', roomID, fromUser, command);\n  Object.keys(_onInRoomCommandReceivedCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n      if (_onInRoomCommandReceivedCallbackMap[callbackID]) {\n        _onInRoomCommandReceivedCallbackMap[callbackID](fromUser, command);\n      }\n    }\n  });\n}\nfunction _sendInRoomCommand(command: string, toUserList: any[]) {\n  if (!_isRoomConnected) {\n    zlogerror('You need to join the room before using this interface!');\n    return Promise.reject();\n  }\n  return new Promise<void>((resolve, reject) => {\n    ZegoExpressEngine.instance().sendCustomCommand(_currentRoomID, command, toUserList).then(({ errorCode }) => {\n      if (errorCode === 0) {\n        zloginfo('[sendInRoomCommand]Send successfully', toUserList);\n        resolve();\n      } else {\n        zloginfo('[sendInRoomCommand]Send failure', toUserList);\n        reject();\n      }\n    }).catch((error) => {\n      zloginfo('[sendInRoomCommand]Send error', error);\n      reject();\n    })\n  });\n}\nfunction _leaveRoom() {\n  return new Promise<void>((resolve, reject) => {\n    if (_currentRoomID == '') {\n      zloginfo('You are not join in any room, no need to leave room.');\n      resolve();\n    } else {\n      zloginfo('userID:', _localCoreUser.userID, ' leaveRoom:', _currentRoomID);\n      ZegoExpressEngine.instance()\n        .logoutRoom(_currentRoomID)\n        .then(() => {\n          zloginfo('Leave room succeed.');\n          ZegoUIKitReport.reportEvent('logoutRoom', {\n            'room_id': _currentRoomID,\n            'error': 0,\n            'msg': ''\n          })\n          _currentRoomID = ''\n\n          _turnCameraDeviceOn(_localCoreUser.userID, false);\n          _turnMicDeviceOn(_localCoreUser.userID, false);\n          ZegoExpressEngine.instance().stopSoundLevelMonitor();\n          _notifyUserCountOrPropertyChanged(\n            ZegoChangedCountOrProperty.userDelete\n          );\n          _resetDataForLeavingRoom();\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Leave room failed: ', error);\n          ZegoUIKitReport.reportEvent('logoutRoom', {\n            'room_id': _currentRoomID,\n            'error': -1,\n            'msg': JSON.stringify(error)\n          })\n\n          reject(error);\n        });\n    }\n  });\n}\nfunction _turnMicDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      zloginfo(`turnMicDeviceOn: userID: ${_localCoreUser.userID}, mic: ${on}`);\n      ZegoExpressEngine.instance().muteMicrophone(!on);\n\n      _onRemoteMicStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isMicDeviceOn = on;\n      _coreUserMap[_localCoreUser.userID].isMicDeviceOn = on;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.microphoneStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : _localCoreUser.isCameraDeviceOn,\n          isMicrophoneOn : on\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo), ZegoPublishChannel.Main);\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();  // Don't worry! It will check internally that both the camera and microphone are turned off before stopping the stream.\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_microphone_on: userID }) : JSON.stringify({ zego_turn_microphone_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnMicDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnMicDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _turnCameraDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      // Default to Main Channel\n      zloginfo('turnCameraDeviceOn: ', _localCoreUser.userID, on);\n      ZegoExpressEngine.instance().enableCamera(on, 0);\n\n      _onRemoteCameraStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isCameraDeviceOn = on;\n      // if (!on) {\n      //     _localCoreUser.viewID = -1;\n      // }\n      _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.cameraStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : on,\n          isMicrophoneOn : _localCoreUser.isMicDeviceOn\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo), ZegoPublishChannel.Main);\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();  // Don't worry! It will check internally that both the camera and microphone are turned off before stopping the stream.\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_camera_on: userID }) : JSON.stringify({ zego_turn_camera_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnCameraDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnCameraDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _registerEngineCallback() {\n  zloginfo('Register callback for ZegoExpressEngine...');\n  ZegoExpressEngine.instance().on('roomUserUpdate', (roomID, updateType: ZegoUpdateType, userList) => {\n      zloginfo('[roomUserUpdate callback]', roomID, getZegoUpdateTypeName(updateType), userList);\n      _onRoomUserUpdate(roomID, updateType, userList);\n  });\n  ZegoExpressEngine.instance().on('roomStreamUpdate', (roomID, updateType: ZegoUpdateType, streamList) => {\n      zloginfo('[roomStreamUpdate callback]', roomID, getZegoUpdateTypeName(updateType), streamList);\n      _onRoomStreamUpdate(roomID, updateType, streamList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'publisherQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        _qualityUpdateLogCounter = 0;\n        zloginfo('[publisherQualityUpdate callback]', streamID, quality);\n      }\n      _qualityUpdateLogCounter++;\n      if (streamID.split('_')[2] === 'main') {\n        _localCoreUser.publisherQuality = quality;\n        _coreUserMap[_localCoreUser.userID].publisherQuality = quality;\n        _notifyUserInfoUpdate(_coreUserMap[_localCoreUser.userID]);\n      }\n    }\n  );\n  // ZegoExpressEngine.instance().on(\n  //     'publisherStateUpdate',\n  //     (streamID, state, errorCode, extendedData) => {\n  //         zloginfo('publisherStateUpdate#################', streamID, state, errorCode)\n  //     },\n  // );\n  ZegoExpressEngine.instance().on(\n    'playerQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        // zloginfo('[playerQualityUpdate callback]', streamID, quality);\n      }\n      // TODO\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteCameraStateUpdate', (streamID, state: ZegoRemoteDeviceState) => {\n      zloginfo('[remoteCameraStateUpdate callback]', streamID, getZegoRemoteDeviceStateName(state));\n      if (streamID.endsWith(_screenshareStreamIDFlag)) {\n        return;\n      }\n\n      let isCameraOn = (state == ZegoRemoteDeviceState.Open)\n      _onRemoteCameraStateUpdate(_getUserIDByStreamID(streamID), isCameraOn);\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteMicStateUpdate', (streamID, state: ZegoRemoteDeviceState) => {\n    zloginfo('[remoteMicStateUpdate callback]', streamID, getZegoRemoteDeviceStateName(state));\n    if (streamID.endsWith(_screenshareStreamIDFlag)) {\n      return;\n    }\n\n    let isMicOn = (state == ZegoRemoteDeviceState.Open)\n    _onRemoteMicStateUpdate(_getUserIDByStreamID(streamID), isMicOn);\n  });\n  ZegoExpressEngine.instance().on(\n    'playerStateUpdate',\n    (streamID, state, errorCode, extendedData) => {\n      zloginfo(\n        '[playerStateUpdate callback]',\n        streamID,\n        state,\n        errorCode,\n        extendedData\n      );\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteSoundLevelUpdate', (soundLevels: any) => {\n    // {streamID, soundLavel} value from 0.0 to 100.0\n    // zloginfo('[remoteSoundLevelUpdate callback]', soundLevels);\n    Object.keys(soundLevels).forEach((streamID) => {\n      const userID = _getUserIDByStreamID(streamID);\n      if (userID in _coreUserMap) {\n        _coreUserMap[userID].soundLevel = soundLevels[streamID];\n        _notifySoundLevelUpdate(userID, soundLevels[streamID]);\n      }\n    });\n  });\n  ZegoExpressEngine.instance().on('capturedSoundLevelUpdate', (soundLevel) => {\n    if (\n      _localCoreUser.userID === '' ||\n      !(_localCoreUser.userID in _coreUserMap)\n    ) {\n      return;\n    }\n    _localCoreUser.soundLevel = soundLevel;\n    _coreUserMap[_localCoreUser.userID].soundLevel = soundLevel;\n    _notifySoundLevelUpdate(_localCoreUser.userID, soundLevel);\n    // zloginfo('capturedSoundLevelUpdate', soundLevel)\n  });\n  // https://doc-en-api.zego.im/ReactNative/enums/_zegoexpressdefines_.zegoroomstatechangedreason.html\n  ZegoExpressEngine.instance().on(\n    'roomStateChanged',\n    (roomID, reason, errorCode, extendedData) => {\n      zloginfo(\n        '[roomStateChanged callback]',\n        roomID,\n        reason,\n        errorCode,\n        extendedData\n      );\n      _onRoomStateChanged(roomID, reason, errorCode, extendedData);\n    }\n  );\n  ZegoExpressEngine.instance().on('audioRouteChange', (audioRoute) => {\n    zloginfo('[audioRouteChange callback]', audioRoute);\n    _onAudioRouteChange(audioRoute);\n  });\n  ZegoExpressEngine.instance().on(\n    'IMRecvBroadcastMessage',\n    (roomID, messageList) => {\n      _onInRoomMessageReceived(roomID, messageList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'roomTokenWillExpire',\n    (roomID, remainTimeInSecond) => {\n      zloginfo('express token will expire.');\n      _onRequireNewToken();\n    }\n  );\n  ZegoExpressEngine.instance().on('roomExtraInfoUpdate', (roomID, roomExtraInfoList) => {\n    _onRoomExtraInfoUpdate(roomID, roomExtraInfoList);\n  });\n  ZegoExpressEngine.instance().on('roomStreamExtraInfoUpdate', (roomID, streamList) => {\n    zloginfo('roomStreamExtraInfoUpdate', streamList)\n    streamList.forEach((stream) => {\n      parseStreamExtraInfo(stream)\n    })\n  });\n  ZegoExpressEngine.instance().on('IMRecvCustomCommand', (roomID, fromUser, command) => {\n    zloginfo('IMRecvCustomCommand', roomID, fromUser, command);\n    _onIMCustomCommandReceived(roomID, fromUser, command);\n  });\n  ZegoExpressEngine.instance().on('playerVideoSizeChanged', (streamID, width, height) => {\n    zloginfo('playerVideoSizeChanged', streamID, width, height);\n    const userID =  _streamCoreUserMap[streamID].userID;\n    _coreUserMap[userID].isLandscape = width > height;\n    ZegoUIKitInternal.forceRenderVideoView();\n  });\n  ZegoExpressEngine.instance().on('publisherVideoSizeChanged', (width, height, channel) => {\n    zloginfo('publisherVideoSizeChanged', width, height, channel);\n    _localCoreUser.isLandscape = width > height;\n    if (_currentRoomID) {\n      // _coreUserMap will be fill after entering the room.\n      _coreUserMap[_localCoreUser.userID].isLandscape = width > height;\n    }\n    ZegoUIKitInternal.forceRenderVideoView();\n  });\n  ZegoExpressEngine.instance().on('engineStateUpdate', (state: ZegoEngineState) => {\n    zloginfo('[engineStateUpdate callback]', getZegoEngineStateName(state));\n    _engineState = state;\n  });\n}\nfunction _unregisterEngineCallback() {\n  zloginfo('Unregister callback from ZegoExpressEngine...');\n  ZegoExpressEngine.instance().off('roomUserUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamUpdate', undefined);\n  ZegoExpressEngine.instance().off('publisherQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteCameraStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteMicStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('capturedSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStateChanged', undefined);\n  ZegoExpressEngine.instance().off('audioRouteChange', undefined);\n  ZegoExpressEngine.instance().off('IMRecvBroadcastMessage', undefined);\n  ZegoExpressEngine.instance().off('roomTokenWillExpire', undefined);\n  ZegoExpressEngine.instance().off('roomExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('IMRecvCustomCommand', undefined);\n  ZegoExpressEngine.instance().off('playerVideoSizeChanged', undefined);\n  ZegoExpressEngine.instance().off('publisherVideoSizeChanged', undefined);\n  ZegoExpressEngine.instance().off('engineStateUpdate', undefined);\n}\nfunction _notifyUserCountOrPropertyChanged(type: number) {\n  const msg = [\n    '',\n    'user add',\n    'user delete',\n    'mic update',\n    'camera update',\n    'attributes update',\n  ];\n  const userList = Object.values(_coreUserMap)\n    .sort((user1: any, user2: any) => {\n      return user2.joinTime - user1.joinTime;\n    })\n    .map((user) => _createPublicUser(user));\n  zloginfo(`_notifyUserCountOrPropertyChanged ${msg[type]}, retain users: `, userList);\n  Object.keys(_onUserCountOrPropertyChangedCallbackMap).forEach(\n    (callbackID) => {\n      if (_onUserCountOrPropertyChangedCallbackMap[callbackID]) {\n        _onUserCountOrPropertyChangedCallbackMap[callbackID](\n          JSON.parse(JSON.stringify(userList))\n        );\n      }\n    }\n  );\n}\n\n// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Stream Handling <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\nfunction _getUserIDByStreamID(streamID: string) {\n  // StreamID format: roomid_userid_main\n  for (const userID in _coreUserMap) {\n    if (_coreUserMap[userID].streamID == streamID) {\n      return userID;\n    }\n  }\n  return '';\n}\nfunction _getPublishStreamID() {\n  return _currentRoomID + '_' + _localCoreUser.userID + '_main';\n}\nfunction _getStreamIDByUserID(userID: string) {\n  return _currentRoomID + '_' + userID + '_main';\n}\n\nfunction _getScreenshareStreamIDByUserID(userID: string) {\n  return _currentRoomID + '_' + userID + _screenshareStreamIDFlag;\n}\n\n\nfunction parseStreamExtraInfo(stream: ZegoStream) {\n  try {\n    var extraInfo = JSON.parse(stream.extraInfo)\n    if ('isCameraOn' in extraInfo) {\n        _onRemoteCameraStateUpdate(stream.user.userID, extraInfo.isCameraOn)\n    }\n    if ('isMicrophoneOn' in extraInfo) {\n        _onRemoteMicStateUpdate(stream.user.userID, extraInfo.isMicrophoneOn)\n    }\n  } catch (error) {\n    zlogerror('parse streamExtraInfo ERROR: ', error)\n  }\n}\n\nfunction _tryStartPublishStream() {\n  if (_localCoreUser.isMicDeviceOn || _localCoreUser.isCameraDeviceOn) {\n    zloginfo(\n      '_tryStartPublishStream',\n      ', mic:',\n      _localCoreUser.isMicDeviceOn,\n      ', camera:',\n      _localCoreUser.isCameraDeviceOn,\n      _localCoreUser.streamID\n    );\n    if (_localCoreUser.streamID) {\n      ZegoExpressEngine.instance()\n      .startPublishingStream(_localCoreUser.streamID, ZegoPublishChannel.Main, undefined)\n      .then(() => {\n        zloginfo('Notify local user audioVideoAvailable start', _localCoreUser.streamID + '', JSON.parse(JSON.stringify(_streamCoreUserMap)));\n        // if (_localCoreUser.streamID in _streamCoreUserMap) {\n          _streamCoreUserMap[_localCoreUser.streamID] = _localCoreUser;\n\n          zloginfo('Notify local user audioVideoAvailable end', _localCoreUser);\n          _notifyAudioVideoAvailable([_localCoreUser]);\n        // }\n      });\n    }\n\n    if (_localCoreUser.viewID > 0 && _localCoreUser.isCameraDeviceOn) {\n      zloginfo('ZegoExpressEngine startPreview:', _localCoreUser);\n      ZegoExpressEngine.instance()\n        .startPreview({\n          reactTag: _localCoreUser.viewID,\n          viewMode: _localCoreUser.fillMode,\n          backgroundColor: 0,\n        }, ZegoPublishChannel.Main)\n        .catch((error) => {\n          zlogerror(error);\n        });\n    }\n  }\n}\nfunction _tryStopPublishStream(force = false) {\n  if (!_localCoreUser.isMicDeviceOn && !_localCoreUser.isCameraDeviceOn) {\n    zloginfo('stopPublishStream stopPreview');\n    try {\n      ZegoExpressEngine.instance().stopPublishingStream(ZegoPublishChannel.Main);\n      ZegoExpressEngine.instance().stopPreview(ZegoPublishChannel.Main);  \n    } catch (e) {\n      zloginfo('stopPublishStream stopPreview, but expressengine is null')\n    }\n\n    if (_localCoreUser.streamID in _streamCoreUserMap) {\n      delete _streamCoreUserMap[_localCoreUser.streamID];\n      _notifyAudioVideoUnavailable([_localCoreUser]);\n    }\n  }\n}\nfunction _tryStartPlayStream(userID: string) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    zloginfo(`[_tryStartPlayStream] userID: ${user.userID}, viewID: ${user.viewID}, fillMode: ${user.fillMode}, resourceMode: ${_audioVideoResourceMode}`)\n\n    // Playing Streaming.\n    if (user.streamID !== '') {\n      if (user.viewID > 0) {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, {\n          reactTag: user.viewID,\n          viewMode: user.fillMode,\n          backgroundColor: 0,\n        }, {\n          resourceMode: _audioVideoResourceMode,\n        })\n        .then(() => {\n        })\n        .catch((error) => {\n          zlogerror(`startPlayingStream fail, stream: ${user.streamID}`)\n        });\n      } else {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, undefined, {\n          resourceMode: _audioVideoResourceMode,\n        })\n        .then(() => {\n        })\n        .catch((error) => {\n          zlogerror(`startPlayingStream fail, stream: ${user.streamID}`)\n        });\n      }\n    }\n\n    // Playing Screenshare Streaming.\n    if (user.screenshareStreamID !== '' && user.screenshareViewID > 0) {\n      ZegoExpressEngine.instance().startPlayingStream(user.screenshareStreamID, {\n        reactTag: user.screenshareViewID,\n        viewMode: user.screenshareViewFillMode,\n        backgroundColor: 0,\n      }, {\n        resourceMode: _audioVideoResourceMode,\n      });\n    }\n  }\n}\nfunction _tryStopPlayStream(userID: string, force = false) {\n  zloginfo(`[_tryStopPlayStream] userID: ${userID}`)\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    if (force || (!user.isMicDeviceOn && !user.isCameraDeviceOn)) {\n      ZegoExpressEngine.instance().stopPlayingStream(user.streamID);\n    }\n  }\n}\nfunction _tryStopPlayScreenshareStream(userID: string) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    if (user.screenshareStreamID !== '') {\n      ZegoExpressEngine.instance().stopPlayingStream(user.screenshareStreamID);\n    }\n  }\n}\nfunction _notifyUserInfoUpdate(userInfo: any) {\n  Object.keys(_onUserInfoUpdateCallbackMap).forEach((callbackID) => {\n    if (_onUserInfoUpdateCallbackMap[callbackID]) {\n      _onUserInfoUpdateCallbackMap[callbackID](userInfo);\n    }\n  });\n}\nfunction _notifySoundLevelUpdate(userID: string, soundLevel: number) {\n  Object.keys(_onSoundLevelUpdateCallbackMap).forEach((callbackID) => {\n    if (_onSoundLevelUpdateCallbackMap[callbackID]) {\n      _onSoundLevelUpdateCallbackMap[callbackID](userID, soundLevel);\n    }\n  });\n}\nfunction _notifyRoomPropertyUpdate(key: string, oldValue: any, value: any, type: number) {\n  Object.keys(_onRoomPropertyUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertyUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertyUpdatedCallbackMap[callbackID](key, oldValue, value, type);\n    }\n  });\n}\nfunction _notifyRoomPropertiesFullUpdate(keys: string[], oldRoomProperties: any, roomProperties: any, type: number) {\n  Object.keys(_onRoomPropertiesFullUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertiesFullUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID](keys, oldRoomProperties, roomProperties, type);\n    }\n  });\n}\nfunction _notifyMeRemovedFromRoom() {\n  Object.keys(_onMeRemovedFromRoomCallbackMap).forEach((callbackID) => {\n    if (_onMeRemovedFromRoomCallbackMap[callbackID]) {\n      _onMeRemovedFromRoomCallbackMap[callbackID]();\n    }\n  });\n}\nfunction _notifyJoinRoom() {\n  Object.keys(_onJoinRoomCallbackMap).forEach((callbackID) => {\n    if (_onJoinRoomCallbackMap[callbackID]) {\n      _onJoinRoomCallbackMap[callbackID]();\n    }\n  });\n}\n\nfunction _notifyAudioVideoAvailable(users: any[]) {\n  Object.keys(_onAudioVideoAvailableCallbackMap).forEach((callbackID) => {\n    if (_onAudioVideoAvailableCallbackMap[callbackID]) {\n      _onAudioVideoAvailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyAudioVideoUnavailable(users: any[]) {\n  Object.keys(_onAudioVideoUnavailableCallbackMap).forEach((callbackID) => {\n    if (_onAudioVideoUnavailableCallbackMap[callbackID]) {\n      _onAudioVideoUnavailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyScreenSharingAvailable(users: any[]) {\n  Object.keys(_onScreenSharingAvailableCallbackMap).forEach((callbackID) => {\n    if (_onScreenSharingAvailableCallbackMap[callbackID]) {\n      _onScreenSharingAvailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyScreenSharingUnavailable(users: any[]) {\n  Object.keys(_onScreenSharingUnavailableCallbackMap).forEach((callbackID) => {\n    if (_onScreenSharingUnavailableCallbackMap[callbackID]) {\n      _onScreenSharingUnavailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _applyVideoConfig() {\n  const config = _videoConfig.toSDK(_appOrientation);\n  ZegoExpressEngine.instance().setVideoConfig(config, ZegoPublishChannel.Main);\n  zloginfo(`[setAppOrientation] express setVideoConfig:${JSON.stringify(config)}`);\n}\n\nconst _isEngineCreated = () => {\n  try {\n    return ZegoExpressEngine.instance() != undefined;\n  } catch (error) {\n    return false;\n  }\n}\n\nconst ZegoUIKitInternal =  {\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Internal <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  getPackageVersion() {\n    return getPackageVersion();\n  },\n  logComponentsVersion(extraInfo: Map<string, string>) {\n    logComponentsVersion(extraInfo);\n  },\n  isRoomConnected() {\n    return _isRoomConnected;\n  },\n  setAudioVideoResourceMode(audioVideoResourceMode: any) {\n    zloginfo('setAudioVideoResourceMode', audioVideoResourceMode);\n    _audioVideoResourceMode = audioVideoResourceMode || ZegoAudioVideoResourceMode.Default;\n  },\n  updateRenderingProperty(userID: string, viewID: number, lastViewID: number, fillMode: number, isScreenshare: boolean = false) {\n    zloginfo(`[updateRenderingProperty] userID: ${userID}, viewID: ${viewID}, lastViewID: ${lastViewID}, fillMode: ${fillMode}, isScreenshare: ${isScreenshare}`)\n    if (userID === undefined) {\n      zlogwarning(\n        'updateRenderingProperty: ignore undefined useid. Use empty string for local user.'\n      );\n      return;\n    }\n    if (userID === '') {\n      userID = _localCoreUser.userID;\n    }\n    if (userID in _coreUserMap) {\n      // Avoid issues when the stream is handed over between two views.\n      let canUpdateViewID = true\n      if (viewID <= 0) {\n        if (isScreenshare) {\n          canUpdateViewID = (lastViewID === _coreUserMap[userID].screenshareViewID)\n        } else {\n          canUpdateViewID = (lastViewID === _coreUserMap[userID].viewID)\n        }\n      }\n      if (canUpdateViewID) {\n        if (isScreenshare) {\n          _coreUserMap[userID].screenshareViewID = viewID;\n          _coreUserMap[userID].screenshareViewFillMode = fillMode;\n        } else {\n          _coreUserMap[userID].viewID = viewID;\n          _coreUserMap[userID].fillMode = fillMode;\n        }\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n      } else {\n        zloginfo('[updateRenderingProperty] can not update viewID')\n      }\n\n      if (_localCoreUser.userID == userID) {\n        _localCoreUser.viewID = viewID;\n        _localCoreUser.fillMode = fillMode;\n        if (viewID > 0) {\n          _tryStartPublishStream();\n        } else {\n          _tryStopPublishStream();\n        }\n      } else {\n        // Check if stream is ready to play for remote user\n        if (viewID > 0) {\n          _tryStartPlayStream(userID);\n        }\n      }\n    }\n  },\n  onUserInfoUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserInfoUpdateCallbackMap) {\n        zloginfo(\n          '[onUserInfoUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserInfoUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onUserInfoUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSoundLevelUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSoundLevelUpdateCallbackMap) {\n        zloginfo(\n          '[onSoundLevelUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSoundLevelUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onSoundLevelUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSDKConnected(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSDKConnectedCallbackMap) {\n        zloginfo(\n          '[onSDKConnected] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSDKConnectedCallbackMap[callbackID];\n      }\n    } else {\n      _onSDKConnectedCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> SDK <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectSDK(appID: number, appSign: string, userInfo: any) {\n    // Solve the problem of repeated initialization\n    if (_isEngineCreated()) {\n      zloginfo('Create ZegoExpressEngine succeed already!');\n\n      _unregisterEngineCallback();\n      _registerEngineCallback();\n      _applyVideoConfig()\n\n      _localCoreUser.userID = userInfo.userID;\n      _localCoreUser.userName = userInfo.userName;\n      _coreUserMap[userInfo.userID] = _localCoreUser;\n\n      Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n        // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n        if (_onSDKConnectedCallbackMap[callbackID]) {\n          _onSDKConnectedCallbackMap[callbackID]();\n        }\n      });\n\n      return Promise.resolve();\n    }\n    return new Promise<void>((resolve, reject) => {\n      // set advancedConfig to monitor remote user's device changed\n      ZegoExpressEngine.setEngineConfig({\n        advancedConfig: {\n          // @ts-ignore\n          notify_remote_device_unknown_status: 'true',\n          notify_remote_device_init_status: 'true',\n        },\n      });\n      const engineProfile: ZegoEngineProfile = {\n        appID: appID,\n        appSign: appSign,\n        scenario: 0,\n      };\n      ZegoUIKitReport.create(appID, appSign, {\n        'user_id': userInfo.userID\n      });\n\n      zloginfo(`[ZegoUIKitInternal][connectSDK] createEngine`)\n      ZegoExpressEngine.createEngineWithProfile(engineProfile)\n        .then((engine) => {\n          zloginfo('Create ZegoExpressEngine succeed!');\n          _appInfo.appID = appID;\n          _appInfo.appSign = appSign;\n          _unregisterEngineCallback();\n          _registerEngineCallback();\n          _applyVideoConfig()\n          _setLocalUserInfo(userInfo);\n\n          Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n            // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n            if (_onSDKConnectedCallbackMap[callbackID]) {\n              _onSDKConnectedCallbackMap[callbackID]();\n            }\n          });\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Create ZegoExpressEngine Failed: ', error);\n          reject(error);\n        });\n    });\n  },\n  disconnectSDK() {\n    return new Promise<void>((resolve, reject) => {\n      zloginfo(`[ZegoUIKitInternal][disconnectSDK] destroyEngine`)\n      if (ZegoExpressEngine.instance()) {\n        ZegoExpressEngine.destroyEngine()\n          .then(() => {\n            zloginfo('Destroy ZegoExpressEngine finished!');\n            resolve();\n          })\n          .catch((error) => {\n            zlogerror('Destroy ZegoExpressEngine failed!', error);\n            reject(error);\n          })\n          .finally(() => {\n            _resetData();\n          });\n      } else {\n        resolve();\n      }\n    });\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Audio Video <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  useFrontFacingCamera(isFrontFacing: boolean) {\n    zloginfo('UseFrontFacingCamera: ', isFrontFacing);\n    _usingFrontFacingCamera = isFrontFacing;\n    return ZegoExpressEngine.instance().useFrontCamera(isFrontFacing, 0);\n  },\n  isUsingFrontFacingCamera() {\n    return _usingFrontFacingCamera;\n  },\n  isMicDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isMicDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isMicDeviceOn;\n    } else {\n      zloginfo(\n        'Can not check mic device is on for user[',\n        userID,\n        '], because no record!'\n      );\n      return true;\n    }\n  },\n  isCameraDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isCameraDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isCameraDeviceOn;\n    } else {\n      zloginfo(\n        'No record for user: ',\n        userID,\n        '. Can not check camera device is on.'\n      );\n      return true;\n    }\n  },\n  enableSpeaker(enable: boolean) {\n    // TODO\n    return new Promise<void>((resolve, reject) => {\n      if (!_isRoomConnected) {\n        zlogerror('You are not connect to any room.');\n        reject();\n      } else {\n        ZegoExpressEngine.instance().muteSpeaker(!enable);\n        resolve();\n      }\n    });\n  },\n  audioOutputDeviceType() {\n    return _audioOutputType;\n  },\n  turnMicDeviceOn(userID: string, on: boolean) {\n    return _turnMicDeviceOn(userID, on);\n  },\n  turnCameraDeviceOn(userID: string, on: boolean) {\n    return _turnCameraDeviceOn(userID, on);\n  },\n  onMicDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMicDeviceOnCallbackMap) {\n        zloginfo(\n          '[onMicDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMicDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onMicDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  onCameraDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onCameraDeviceOnCallbackMap) {\n        zloginfo(\n          '[onCameraDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onCameraDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onCameraDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  setAudioOutputToSpeaker(isSpeaker: boolean) {\n    ZegoExpressEngine.instance().setAudioRouteToSpeaker(isSpeaker);\n  },\n  onAudioOutputDeviceTypeChange(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioOutputDeviceTypeChangeCallbackMap) {\n        zloginfo(\n          '[onAudioOutputDeviceTypeChange] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioOutputDeviceTypeChangeCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioOutputDeviceTypeChangeCallbackMap[callbackID] = callback;\n    }\n  },\n  \n  setAudioConfig(config: any) {\n    // TODO\n  },\n\n  //  setAppOrientation \n  setVideoConfig(config: ZegoUIKitVideoConfig) {\n    zloginfo(`[setVideoConfig] videoConfig:${JSON.stringify(config)}`);\n    _videoConfig = config;\n  },\n\n  setAppOrientation(orientation: ZegoOrientation) {\n    zloginfo(`[setAppOrientation] orientation:${orientation}`);\n    _appOrientation = orientation;\n    if (_localCoreUser) {\n      _localCoreUser.isLandscape = (_appOrientation !== 0);\n    }\n    if (_coreUserMap[_localCoreUser.userID]) {\n      _coreUserMap[_localCoreUser.userID].isLandscape = (_appOrientation !== 0);\n    }\n    if (_isEngineCreated()) {\n      if (_engineState === ZegoEngineState.Stop) {\n        _applyVideoConfig()\n      } else {\n        zloginfo(`[setAppOrientation] engineState is Start, can't apply video config`);\n      }\n      ZegoExpressEngine.instance().setAppOrientation(_appOrientation, ZegoPublishChannel.Main);\n      zloginfo(`[setAppOrientation] express setAppOrientation:${_appOrientation}, engineState:${getZegoEngineStateName(_engineState)}`);\n    }\n  },\n\n  appOrientation() {\n    return _appOrientation;\n  },\n  \n  onAudioVideoAvailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoAvailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoAvailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoAvailableCallbackMap[callbackID] = callback;\n    }\n  },\n  onAudioVideoUnavailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoUnavailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoUnavailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoUnavailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoUnavailableCallbackMap[callbackID] = callback;\n    }\n  },\n  muteUserAudio(userID: string, mute: boolean) {\n    const user = _coreUserMap[userID];\n    zloginfo('[muteUserAudio]', userID, user.streamID, mute);\n    if (user.streamID) {\n      ZegoExpressEngine.instance().mutePlayStreamAudio(user.streamID, mute);\n    }\n  },\n  muteUserVideo(userID: string, mute: boolean) {\n    const user = _coreUserMap[userID];\n    zloginfo('[muteUserVideo]', userID, user.streamID, mute);\n    if (user.streamID) {\n      ZegoExpressEngine.instance().mutePlayStreamVideo(user.streamID, mute);\n    }\n  },\n  startPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(false);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(false);\n  },\n  stopPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(true);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(true);\n  },\n  onTurnOnYourCameraRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourCameraRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourCameraRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourCameraRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourCameraRequestCallbackMap[callbackID] = callback;\n    }\n  },\n  onTurnOnYourMicrophoneRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourMicrophoneRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourMicrophoneRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourMicrophoneRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourMicrophoneRequestCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  async joinRoom(roomID: string, token: string, markAsLargeRoom = false) {\n    if (!roomID || roomID.trim().length == 0) {\n      throw new Error(\"roomID can't is empty when loginRoom!\");\n    }\n\n    // Solve the problem of repeated join\n    if (_isRoomConnected && _currentRoomID === roomID) {\n      zloginfo(`Join room: ${roomID} success already.`);\n      return Promise.resolve();\n    }\n    \n    if (_appInfo.appSign === '' && token === '') {\n      token = await ZegoUIKitInternal.getToken();\n    }\n    ZegoExpressEngine.instance().logoutRoom(undefined);\n    return new Promise<void>((resolve, reject) => {\n      const user = {\n        userID: _localCoreUser.userID,\n        userName: _localCoreUser.userName,\n      };\n      const config = { isUserStatusNotify: true } as ZegoRoomConfig;\n      token && (config.token = token);\n      _currentRoomID = roomID;\n\n      const eventBegin = Date.now();\n      zloginfo(`[ZegoUIKitInternal][joinRoom] loginRoom, roomID: ${roomID}`)\n      ZegoExpressEngine.instance()\n        .loginRoom(roomID, user, config)\n        .then(() => {\n          zloginfo(`Join room: ${roomID} success. ${JSON.stringify(user)}`);\n          ZegoUIKitReport.reportEvent('loginRoom', {\n            'room_id': roomID,\n            'error': 0,\n            'msg' : '',\n            'start_time': eventBegin\n          })\n\n          _roomMemberCount = 1\n          _markAsLargeRoom = markAsLargeRoom;\n          ZegoExpressEngine.instance().startSoundLevelMonitor(undefined);\n\n          _localCoreUser.streamID = _getPublishStreamID();\n          _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n          _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n          _tryStartPublishStream()\n          \n          _notifyJoinRoom()\n\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Join room falied: ', error);\n          ZegoUIKitReport.reportEvent('loginRoom', {\n            'room_id': roomID,\n            'error': -1,\n            'msg' : JSON.stringify(error),\n            'start_time': eventBegin\n          })\n\n          _currentRoomID = '';\n          reject(error);\n        });\n    });\n  },\n  inRoom() {\n    return _currentRoomID.length > 0\n  },\n  leaveRoom() {\n    return _leaveRoom();\n  },\n  onRoomStateChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomStateChangedCallbackMap) {\n        zloginfo(\n          '[onRoomStateChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomStateChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomStateChangedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRequireNewToken(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRequireNewTokenCallbackMap) {\n        zloginfo(\n          '[onRequireNewToken] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRequireNewTokenCallbackMap[callbackID];\n      }\n    } else {\n      _onRequireNewTokenCallbackMap[callbackID] = callback;\n    }\n  },\n  setRoomProperty(key: string, value: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return;\n    }\n    if (_roomProperties[key] === value) {\n      return;\n    }\n    const oldValue = _roomProperties[key];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    _roomProperties[key] = value;\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Set start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Set success');\n          resolve();\n          // Notify\n          _notifyRoomPropertyUpdate(key, oldValue, value, ZegoRoomPropertyUpdateType.set);\n          _notifyRoomPropertiesFullUpdate([key], oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.set);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[setRoomProperty]Set failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[setRoomProperty]Set error', error);\n        reject(error);\n      });\n    });\n  },\n  updateRoomProperties(newRoomProperties: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return Promise.reject();\n    }\n    const updateKeys: string[] = [];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    Object.keys(newRoomProperties).forEach((key) => {\n      if (oldRoomProperties[key] !== newRoomProperties[key]) {\n        updateKeys.push(key);\n        _roomProperties[key] = newRoomProperties[key];\n      }\n    })\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Update start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Update success');\n          resolve();\n          // Notify\n          updateKeys.forEach((updateKey) => {\n            const oldValue = oldRoomProperties[updateKey];\n            const value = newRoomProperties[updateKey];\n            _notifyRoomPropertyUpdate(updateKey, oldValue, value, ZegoRoomPropertyUpdateType.update);\n          })\n          updateKeys.length && _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.update);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[updateRoomProperties]Update failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[updateRoomProperties]Update error', error);\n        reject(error);\n      });\n    });\n  },\n  getRoomProperties() {\n    return _roomProperties;\n  },\n  onRoomPropertyUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertyUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertyUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertyUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertyUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRoomPropertiesFullUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertiesFullUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertiesFullUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertiesFullUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  sendInRoomCommand(command: string, toUserIDs: string[] = []) {\n    const toUserList = toUserIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n  onInRoomCommandReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomCommandReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomCommandReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomCommandReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onMeRemovedFromRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMeRemovedFromRoomCallbackMap) {\n        zloginfo(\n          '[onMeRemovedFromRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMeRemovedFromRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onMeRemovedFromRoomCallbackMap[callbackID] = callback;\n    }\n  },\n  onJoinRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onJoinRoomCallbackMap) {\n        zloginfo(\n          '[onJoinRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onJoinRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onJoinRoomCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> User <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectUser(userID: string, userName: string) {\n    _setLocalUserInfo({ userID: userID, userName: userName });\n    // TODO ZIM login\n  },\n  disconnectUser() {\n    delete _coreUserMap[_localCoreUser.userID];\n    _localCoreUser = _createCoreUser('', '', '', {});\n    // TODO ZIM logout\n  },\n  getLocalUserInfo() {\n    return _localCoreUser;\n  },\n  getUser(userID: string) {\n    return _coreUserMap[userID];\n  },\n  getAllScreenshareUsers() {\n    var users: any[] = [];\n    Object.keys(_streamCoreUserMap).forEach(\n      (streamID) => {\n        const isScreenshare = streamID.endsWith(_screenshareStreamIDFlag);\n        if (isScreenshare) {\n          users.push(_streamCoreUserMap[streamID]);\n        }\n      }\n    );\n    return users;\n  },\n  getAllUsers() {\n    const users = Object.values(_coreUserMap);\n    users.sort((a: any, b: any) => {\n      return a.joinTime - b.joinTime;\n    });\n    var publicUsers: any[] = [];\n    users.forEach((user) => {\n      publicUsers.push(_createPublicUser(user));\n    });\n    return publicUsers;\n  },\n  getAudioVideoUsers() {\n    const users = Object.values(_streamCoreUserMap);\n    users.sort((a: any, b: any) => {\n      return a.joinTime - b.joinTime;\n    });\n    var publicUsers: any[] = [];\n    users.forEach((user) => {\n      publicUsers.push(_createPublicUser(user));\n    });\n    return publicUsers;\n  },\n  onUserJoin(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserJoinCallbackMap) {\n        zloginfo(\n          '[onUserJoin] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserJoinCallbackMap[callbackID];\n      }\n    } else {\n      _onUserJoinCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserLeave(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserLeaveCallbackMap) {\n        zloginfo(\n          '[onUserLeave] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserLeaveCallbackMap[callbackID];\n      }\n    } else {\n      _onUserLeaveCallbackMap[callbackID] = callback;\n    }\n  },\n  onOnlySelfInRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onOnlySelfInRoomCallbackMap) {\n        zloginfo(\n          '[onOnlySelfInRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onOnlySelfInRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onOnlySelfInRoomCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserCountOrPropertyChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserCountOrPropertyChangedCallbackMap) {\n        zloginfo(\n          '[onUserCountOrPropertyChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserCountOrPropertyChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onUserCountOrPropertyChangedCallbackMap[callbackID] = callback;\n    }\n  },\n\n  removeUserFromRoom(userIDs: string[] = []) {\n    const command = JSON.stringify({ zego_remove_user: userIDs });\n    const toUserList = (_isLargeRoom || _markAsLargeRoom) ? [] : userIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Message <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  getInRoomMessages() {\n    return _inRoomMessageList;\n  },\n  sendInRoomMessage(message: string) {\n    return new Promise((resolve, reject) => {\n      ZegoExpressEngine.instance()\n        .sendBroadcastMessage(_currentRoomID, message)\n        .then((result) => {\n          zloginfo('SendInRoomMessage finished.', result);\n          const { errorCode, messageID } = result;\n          if (errorCode > 0) {\n            reject(errorCode);\n          } else {\n            const inRoomMessage = {\n              type: 'user',\n              message: message,\n              messageID: messageID,\n              sendTime: Date.now(),\n              sender: _createPublicUser(_localCoreUser),\n            };\n            _inRoomMessageList.push(inRoomMessage);\n\n            Object.keys(_onInRoomMessageSentCallbackMap).forEach(\n              (callbackID) => {\n                // callback may remove from map during room state chaging\n                if (callbackID in _onInRoomMessageSentCallbackMap) {\n                  if (_onInRoomMessageSentCallbackMap[callbackID]) {\n                    _onInRoomMessageSentCallbackMap[callbackID](\n                      errorCode,\n                      messageID\n                    );\n                  }\n                }\n              }\n            );\n\n            resolve(result);\n          }\n        })\n        .catch((error) => {\n          zlogerror('SendInRoomMessage falied: ', error);\n          reject(error);\n        });\n    });\n  },\n  onInRoomMessageReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onInRoomMessageSent(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageSentCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageSent] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageSentCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageSentCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Live audio room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  notifyUserCountOrPropertyChanged(type: number) {\n    _notifyUserCountOrPropertyChanged(type);\n  },\n  notifyUserInfoUpdate(userID: string) {\n    // Update avatar properties\n    if ( _coreUserMap[userID] && _coreUserMap[userID].inRoomAttributes) {\n      _coreUserMap[userID].avatar = _coreUserMap[userID].inRoomAttributes.avatar;\n    }\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Force update component <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  forceSortMemberList() {\n    zloginfo('[forceSortMemberList callback]');\n    const userList = Object.values(_coreUserMap)\n      .sort((user1: any, user2: any) => {\n        return user2.joinTime - user1.joinTime;\n      })\n      .map((user) => _createPublicUser(user));\n    Object.keys(_onMemberListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onMemberListForceSortCallbackMap[callbackID]) {\n        _onMemberListForceSortCallbackMap[callbackID](userList);\n      }\n    });\n  },\n  onMemberListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMemberListForceSortCallbackMap) {\n        zloginfo(\n          '[onMemberListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMemberListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onMemberListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceSortAudioVideoList() {\n    zloginfo('[forceSortAudioVideoList callback]');\n    Object.keys(_onAudioVideoListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onAudioVideoListForceSortCallbackMap[callbackID]) {\n        _onAudioVideoListForceSortCallbackMap[callbackID]();\n      }\n    });\n  },\n  onAudioVideoListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoListForceSortCallbackMap) {\n        zloginfo(\n          '[onAudioVideoListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceRenderVideoView() {\n    zloginfo('[forceRenderVideoView callback]');\n    Object.keys(_onVideoViewForceRenderCallbackMap).forEach((callbackID) => {\n      if (_onVideoViewForceRenderCallbackMap[callbackID]) {\n        _onVideoViewForceRenderCallbackMap[callbackID]();\n      }\n    });\n  },\n  onVideoViewForceRender(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onVideoViewForceRenderCallbackMap) {\n        zloginfo(\n          '[onVideoViewForceRender] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onVideoViewForceRenderCallbackMap[callbackID];\n      }\n    } else {\n      _onVideoViewForceRenderCallbackMap[callbackID] = callback;\n    }\n  },\n  \n  onError(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n        if (callbackID in _onErrorCallbackMap) {\n            zloginfo(\n                '[onError] Remove callback for: [',\n                callbackID,\n                '] because callback is not a valid function!'\n              );\n            delete _onErrorCallbackMap[callbackID];\n        }\n    } else {\n        _onErrorCallbackMap[callbackID] = callback;\n    }\n  },\n\n  notifyErrorUpdate(method: string, error: number, message: string) {\n    Object.keys(_onErrorCallbackMap).forEach((callbackID) => {\n      if (_onErrorCallbackMap[callbackID]) {\n          _onErrorCallbackMap[callbackID](method, error, message);\n      }\n    });\n  },\n\n  onTokenProvide(callback?: Function) {\n    _onTokenProvideCallback = callback;\n  },\n\n  renewToken(token: string) {\n    if (_isEngineCreated() && _currentRoomID) {\n      ZegoExpressEngine.instance()\n      .renewToken(_currentRoomID, token)\n      .then(() => {\n        zloginfo(`Renew token success, roomID: ${_currentRoomID}`);\n      })\n      .catch((error) => {\n        zlogerror('Renew token failed: ', error);\n      });\n    }\n    return ZegoUIKitSignalingPluginImpl.renewToken(token);\n  },\n\n  async getToken() {\n    if (typeof _onTokenProvideCallback !== 'function') {\n      return '';\n    }\n    const token = await _onTokenProvideCallback();\n    zloginfo(`[Get Token]: ${token}`);\n    return token;\n  },\n  isScreenSharing() {\n    Object.keys(_streamCoreUserMap).forEach((streamID) => {\n      if (streamID.endsWith(_screenshareStreamIDFlag)) {\n        return true;\n      }\n    });\n    return false;\n  },\n\n  onScreenSharingAvailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onScreenSharingAvailableCallbackMap) {\n        zloginfo(\n          '[onScreenSharingAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onScreenSharingAvailableCallbackMap[callbackID];\n      }\n    } else {\n      _onScreenSharingAvailableCallbackMap[callbackID] = callback;\n    }\n  },\n\n  onScreenSharingUnavailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onScreenSharingUnavailableCallbackMap) {\n        zloginfo(\n          '[onScreenSharingAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onScreenSharingUnavailableCallbackMap[callbackID];\n      }\n    } else {\n      _onScreenSharingUnavailableCallbackMap[callbackID] = callback;\n    }\n  }\n};\n\nexport default ZegoUIKitInternal"],"mappings":"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","ignoreList":[]}