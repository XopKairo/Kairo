{"version":3,"names":["ZegoExpressEngine","ZegoEngineState","ZegoOrientation","ZegoPublishChannel","ZegoRemoteDeviceState","ZegoRoomStateChangedReason","ZegoUpdateType","ZegoAudioVideoResourceMode","ZegoChangedCountOrProperty","ZegoRoomPropertyUpdateType","ZegoUIKitVideoConfig","ZegoUIKitSignalingPluginImpl","getZegoEngineStateName","getZegoRemoteDeviceStateName","getZegoUpdateTypeName","zlogerror","zloginfo","zlogwarning","getPackageVersion","ZegoUIKitReport","logComponentsVersion","_appInfo","appID","appSign","_isRoomConnected","_currentRoomState","_currentRoomID","_audioOutputType","_usingFrontFacingCamera","_onMicDeviceOnCallbackMap","_onCameraDeviceOnCallbackMap","_onRoomStateChangedCallbackMap","_onRequireNewTokenCallbackMap","_onUserJoinCallbackMap","_onUserLeaveCallbackMap","_onUserInfoUpdateCallbackMap","_onSoundLevelUpdateCallbackMap","_onSDKConnectedCallbackMap","_onAudioOutputDeviceTypeChangeCallbackMap","_onOnlySelfInRoomCallbackMap","_onUserCountOrPropertyChangedCallbackMap","_onAudioVideoAvailableCallbackMap","_onAudioVideoUnavailableCallbackMap","_onInRoomMessageReceivedCallbackMap","_onInRoomMessageSentCallbackMap","_onRoomPropertyUpdatedCallbackMap","_onRoomPropertiesFullUpdatedCallbackMap","_onInRoomCommandReceivedCallbackMap","_onMeRemovedFromRoomCallbackMap","_onJoinRoomCallbackMap","_onTurnOnYourCameraRequestCallbackMap","_onTurnOnYourMicrophoneRequestCallbackMap","_onScreenSharingAvailableCallbackMap","_onScreenSharingUnavailableCallbackMap","_onMemberListForceSortCallbackMap","_onAudioVideoListForceSortCallbackMap","_onVideoViewForceRenderCallbackMap","_localCoreUser","_createCoreUser","_streamCoreUserMap","_coreUserMap","_qualityUpdateLogCounter","_inRoomMessageList","_audioVideoResourceMode","Default","_roomProperties","_isLargeRoom","_roomMemberCount","_markAsLargeRoom","_onErrorCallbackMap","_onTokenProvideCallback","undefined","_videoConfig","preset360P","_appOrientation","PortraitUp","_engineState","Stop","_screenshareStreamIDFlag","_resetData","isLandscape","_resetDataForLeavingRoom","userID","userName","profileUrl","extendInfo","_createPublicUser","coreUser","isMicrophoneOn","isMicDeviceOn","isCameraOn","isCameraDeviceOn","soundLevel","inRoomAttributes","avatar","viewID","viewFillMode","streamID","screenshareViewID","screenshareViewFillMode","screenshareStreamID","publisherQuality","joinTime","_isLocalUser","_setLocalUserInfo","userInfo","_onRoomUserUpdate","roomID","updateType","userList","userInfoList","Add","length","forEach","user","_getStreamIDByUserID","_getScreenshareStreamIDByUserID","Date","now","_notifyUserInfoUpdate","push","_tryStartPlayStream","_notifyUserCountOrPropertyChanged","userAdd","Object","keys","callbackID","_tryStopPlayStream","_tryStopPlayScreenshareStream","userDelete","_onRoomStreamUpdate","streamList","users","screenshareUsers","stream","isScreenSharing","endsWith","parseStreamExtraInfo","_notifyAudioVideoAvailable","_notifyScreenSharingAvailable","cameraStateUpdate","_notifyAudioVideoUnavailable","_notifyScreenSharingUnavailable","_onRemoteCameraStateUpdate","isOn","_onAudioRouteChange","type","_onRemoteMicStateUpdate","microphoneStateUpdate","_onRoomStateChanged","reason","errorCode","extendedData","Logined","Reconnected","_tryStartPublishStream","KickOut","_notifyMeRemovedFromRoom","_onInRoomMessageReceived","messageList","messages","msg","message","messageID","sendTime","sender","fromUser","_onRequireNewToken","token","instance","renewToken","then","catch","error","ZegoUIKitInternal","getToken","_onRoomExtraInfoUpdate","roomExtraInfoList","updateKeys","oldRoomProperties","JSON","parse","stringify","key","updateTime","updateUser","value","roomProperties","propertyKey","_notifyRoomPropertyUpdate","remote","_notifyRoomPropertiesFullUpdate","_onIMCustomCommandReceived","command","commandObj","removeUserIDList","zego_remove_user","turnCameraOnUserID","zego_turn_camera_on","turnCameraOffUserID","zego_turn_camera_off","turnMicrophoneOnUserID","zego_turn_microphone_on","turnMicrophoneOffUserID","zego_turn_microphone_off","find","removeUserID","_leaveRoom","_turnCameraDeviceOn","_turnMicDeviceOn","_sendInRoomCommand","toUserList","Promise","reject","resolve","sendCustomCommand","logoutRoom","reportEvent","stopSoundLevelMonitor","on","muteMicrophone","extraInfo","setStreamExtraInfo","Main","_tryStopPublishStream","isLargeRoom","enableCamera","_registerEngineCallback","quality","split","state","Open","_getUserIDByStreamID","isMicOn","soundLevels","_notifySoundLevelUpdate","audioRoute","remainTimeInSecond","width","height","forceRenderVideoView","channel","_unregisterEngineCallback","off","values","sort","user1","user2","map","_getPublishStreamID","startPublishingStream","startPreview","reactTag","viewMode","fillMode","backgroundColor","force","stopPublishingStream","stopPreview","e","startPlayingStream","resourceMode","stopPlayingStream","oldValue","_notifyJoinRoom","_applyVideoConfig","config","toSDK","setVideoConfig","_isEngineCreated","isRoomConnected","setAudioVideoResourceMode","audioVideoResourceMode","updateRenderingProperty","lastViewID","isScreenshare","canUpdateViewID","onUserInfoUpdate","callback","onSoundLevelUpdate","onSDKConnected","connectSDK","setEngineConfig","advancedConfig","notify_remote_device_unknown_status","notify_remote_device_init_status","engineProfile","scenario","create","createEngineWithProfile","engine","disconnectSDK","destroyEngine","finally","useFrontFacingCamera","isFrontFacing","useFrontCamera","isUsingFrontFacingCamera","enableSpeaker","enable","muteSpeaker","audioOutputDeviceType","turnMicDeviceOn","turnCameraDeviceOn","onMicDeviceOn","onCameraDeviceOn","setAudioOutputToSpeaker","isSpeaker","setAudioRouteToSpeaker","onAudioOutputDeviceTypeChange","setAudioConfig","setAppOrientation","orientation","appOrientation","onAudioVideoAvailable","onAudioVideoUnavailable","muteUserAudio","mute","mutePlayStreamAudio","muteUserVideo","mutePlayStreamVideo","startPlayingAllAudioVideo","muteAllPlayStreamAudio","muteAllPlayStreamVideo","stopPlayingAllAudioVideo","onTurnOnYourCameraRequest","onTurnOnYourMicrophoneRequest","joinRoom","markAsLargeRoom","trim","Error","isUserStatusNotify","eventBegin","loginRoom","startSoundLevelMonitor","inRoom","leaveRoom","onRoomStateChanged","onRequireNewToken","setRoomProperty","setRoomExtraInfo","set","code","updateRoomProperties","newRoomProperties","updateKey","update","getRoomProperties","onRoomPropertyUpdated","onRoomPropertiesFullUpdated","sendInRoomCommand","toUserIDs","onInRoomCommandReceived","onMeRemovedFromRoom","onJoinRoom","connectUser","disconnectUser","getLocalUserInfo","getUser","getAllScreenshareUsers","getAllUsers","a","b","publicUsers","getAudioVideoUsers","onUserJoin","onUserLeave","onOnlySelfInRoom","onUserCountOrPropertyChanged","removeUserFromRoom","userIDs","getInRoomMessages","sendInRoomMessage","sendBroadcastMessage","result","inRoomMessage","onInRoomMessageReceived","onInRoomMessageSent","notifyUserCountOrPropertyChanged","notifyUserInfoUpdate","forceSortMemberList","onMemberListForceSort","forceSortAudioVideoList","onAudioVideoListForceSort","onVideoViewForceRender","onError","notifyErrorUpdate","method","onTokenProvide","onScreenSharingAvailable","onScreenSharingUnavailable"],"sources":["ZegoUIKitInternal.ts"],"sourcesContent":["import ZegoExpressEngine, {\n  ZegoAudioRoute,\n  ZegoEngineProfile,\n  ZegoEngineState,\n  ZegoOrientation,\n  ZegoPublishChannel,\n  ZegoRemoteDeviceState,\n  ZegoRoomConfig,\n  ZegoRoomStateChangedReason,\n  ZegoStream,\n  ZegoUpdateType,\n  ZegoUser,\n} from 'zego-express-engine-reactnative';\n\nimport { ZegoAudioVideoResourceMode, ZegoChangedCountOrProperty, ZegoRoomPropertyUpdateType, ZegoUIKitVideoConfig } from './defines'\nimport ZegoUIKitSignalingPluginImpl from '../../plugins/invitation';\nimport { getZegoEngineStateName, getZegoRemoteDeviceStateName, getZegoUpdateTypeName } from '../../utils/enum_name';\nimport { zlogerror, zloginfo, zlogwarning } from '../../utils/logger';\nimport { getPackageVersion } from '../../utils/package_version';\nimport ZegoUIKitReport from '../../utils/report';\nimport { logComponentsVersion } from '../../utils/version';\n\nvar _appInfo = {\n  appID: 0,\n  appSign: '',\n};\nvar _isRoomConnected = false;\nvar _currentRoomState = 7; // Logout\nvar _currentRoomID = '';\nvar _audioOutputType = 0;\nvar _usingFrontFacingCamera = true;\n\nvar _onMicDeviceOnCallbackMap: any = {};\nvar _onCameraDeviceOnCallbackMap: any = {};\nvar _onRoomStateChangedCallbackMap: any = {};\nvar _onRequireNewTokenCallbackMap: any = {};\nvar _onUserJoinCallbackMap: any = {};\nvar _onUserLeaveCallbackMap: any = {};\nvar _onUserInfoUpdateCallbackMap: any = {};\nvar _onSoundLevelUpdateCallbackMap: any = {};\nvar _onSDKConnectedCallbackMap: any = {};\nvar _onAudioOutputDeviceTypeChangeCallbackMap: any = {};\nvar _onOnlySelfInRoomCallbackMap: any = {};\nvar _onUserCountOrPropertyChangedCallbackMap: any = {};\nvar _onAudioVideoAvailableCallbackMap: any = {};\nvar _onAudioVideoUnavailableCallbackMap: any = {};\nvar _onInRoomMessageReceivedCallbackMap: any = {};\nvar _onInRoomMessageSentCallbackMap: any = {};\nvar _onRoomPropertyUpdatedCallbackMap: any = {};\nvar _onRoomPropertiesFullUpdatedCallbackMap: any = {};\nvar _onInRoomCommandReceivedCallbackMap: any = {};\nvar _onMeRemovedFromRoomCallbackMap: any = {};\nvar _onJoinRoomCallbackMap: any = {};\nvar _onTurnOnYourCameraRequestCallbackMap: any = {};\nvar _onTurnOnYourMicrophoneRequestCallbackMap: any = {};\nvar _onScreenSharingAvailableCallbackMap: any = {};\nvar _onScreenSharingUnavailableCallbackMap: any = {};\n\n// Force update component callback\nvar _onMemberListForceSortCallbackMap: any = {};\nvar _onAudioVideoListForceSortCallbackMap: any = {};\nvar _onVideoViewForceRenderCallbackMap: any = {};\n\nvar _localCoreUser: any = _createCoreUser('', '', '', {});\nvar _streamCoreUserMap: any = {}; // <streamID, CoreUser>\nvar _coreUserMap: any = {}; // <userID, CoreUser>\nvar _qualityUpdateLogCounter = 0;\n\nvar _inRoomMessageList: any[] = [];\nvar _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\nvar _roomProperties: any = {};\nvar _isLargeRoom = false;\nvar _roomMemberCount = 0;\nvar _markAsLargeRoom = false;\n\nvar _onErrorCallbackMap: any = {};\nvar _onTokenProvideCallback: Function = undefined;\n\nvar _videoConfig = ZegoUIKitVideoConfig.preset360P();\nvar _appOrientation = ZegoOrientation.PortraitUp;\nvar _engineState = ZegoEngineState.Stop;\n\nconst _screenshareStreamIDFlag = '_screensharing';\n\nfunction _resetData() {\n  zloginfo('Reset all data.');\n  _appInfo = { appID: 0, appSign: '' };\n  _localCoreUser = _createCoreUser('', '', '', {});\n  _localCoreUser.isLandscape = (_appOrientation !== 0);\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  _audioOutputType = 0;\n  _inRoomMessageList = [];\n  _audioVideoResourceMode = ZegoAudioVideoResourceMode.Default;\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _resetDataForLeavingRoom() {\n  zloginfo('Reset data for leaving room.');\n  _streamCoreUserMap = {};\n  _coreUserMap = {};\n  _currentRoomID = '';\n  _currentRoomState = 7;\n  _isRoomConnected = false;\n  const { userID, userName, profileUrl, extendInfo } = _localCoreUser;\n  _localCoreUser = _createCoreUser(userID, userName, profileUrl, extendInfo);\n  _localCoreUser.isLandscape = (_appOrientation !== 0);\n  _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n  _inRoomMessageList = [];\n  _roomProperties = {};\n  _isLargeRoom = false;\n  _roomMemberCount = 0;\n  _markAsLargeRoom = false;\n}\n\nfunction _createPublicUser(coreUser: any) {\n  return {\n    userID: coreUser.userID,\n    userName: coreUser.userName,\n    extendInfo: coreUser.extendInfo,\n    isMicrophoneOn: coreUser.isMicDeviceOn,\n    isCameraOn: coreUser.isCameraDeviceOn,\n    soundLevel: coreUser.soundLevel,\n    inRoomAttributes: coreUser.inRoomAttributes,\n    avatar: coreUser.avatar,\n  };\n}\nfunction _createCoreUser(userID: string, userName: string, profileUrl?: string, extendInfo?: any) {\n  return {\n    userID: userID,\n    userName: userName,\n    profileUrl: profileUrl,\n    extendInfo: extendInfo,\n    viewID: -1,\n    viewFillMode: 1,\n    streamID: '',\n    screenshareViewID: -1,\n    screenshareViewFillMode: 1,\n    screenshareStreamID: '',\n    isMicDeviceOn: false,\n    isCameraDeviceOn: false,\n    publisherQuality: 0,\n    soundLevel: 0,\n    joinTime: 0,\n    inRoomAttributes: {},\n    avatar: '',\n    isLandscape: false,\n  };\n}\nfunction _isLocalUser(userID: string) {\n  return (\n    userID === undefined || userID === '' || _localCoreUser.userID === userID\n  );\n}\nfunction _setLocalUserInfo(userInfo: any) {\n  _localCoreUser = _createCoreUser(\n    userInfo.userID,\n    userInfo.userName,\n    userInfo.profileUrl,\n    userInfo.extendInfo\n  );\n  _coreUserMap[userInfo.userID] = _localCoreUser;\n}\n\nfunction _onRoomUserUpdate(roomID: string, updateType: number, userList: any[]) {\n  // No need for roomID, does not support multi-room right now.\n  const userInfoList: any[] = [];\n  if (updateType == ZegoUpdateType.Add) {\n    _roomMemberCount += userList.length;\n    if (_roomMemberCount >= 500) {\n      _isLargeRoom = true;\n    }\n    userList.forEach((user) => {\n      if (!(user.userID in _coreUserMap)) {\n        const coreUser = _createCoreUser(user.userID, user.userName);\n        _coreUserMap[user.userID] = coreUser;\n      }\n      const streamID = _getStreamIDByUserID(user.userID);\n      if (streamID in _streamCoreUserMap) {\n        _coreUserMap[user.userID].streamID = streamID;\n      }\n\n      const screenshareStreamID = _getScreenshareStreamIDByUserID(user.userID);\n      if (screenshareStreamID in _streamCoreUserMap) {\n        _coreUserMap[user.userID].screenshareStreamID = screenshareStreamID;\n      }\n\n      _coreUserMap[user.userID].joinTime = Date.now();\n      _notifyUserInfoUpdate(_coreUserMap[user.userID]);\n\n      userInfoList.push(_createPublicUser(_coreUserMap[user.userID]));\n\n      // Start after user insert into list\n      _tryStartPlayStream(user.userID);\n    });\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n    zloginfo('Users Join: ', userInfoList);\n    Object.keys(_onUserJoinCallbackMap).forEach((callbackID) => {\n      if (_onUserJoinCallbackMap[callbackID]) {\n        _onUserJoinCallbackMap[callbackID](userInfoList);\n      }\n    });\n  } else {\n    // updateType == ZegoUpdateType.Delete\n    _roomMemberCount -= userList.length;\n    userList.forEach((user) => {\n      if (user.userID in _coreUserMap) {\n        const coreUser = _coreUserMap[user.userID];\n        const userInfo = {\n          userID: coreUser.userID,\n          userName: coreUser.userName,\n          profileUrl: coreUser.profileUrl,\n          extendInfo: coreUser.extendInfo,\n        };\n        userInfoList.push(userInfo);\n\n        // Stop play stream before remove user list\n        _tryStopPlayStream(coreUser.userID, true);\n        _tryStopPlayScreenshareStream(coreUser.userID);\n        delete _coreUserMap[user.userID];\n      }\n    });\n    zloginfo('Users Leave: ', userInfoList);\n    _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userDelete);\n    Object.keys(_onUserLeaveCallbackMap).forEach((callbackID) => {\n      if (_onUserLeaveCallbackMap[callbackID]) {\n        _onUserLeaveCallbackMap[callbackID](userInfoList);\n      }\n    });\n    if (Object.keys(_coreUserMap).length <= 1) {\n      Object.keys(_onOnlySelfInRoomCallbackMap).forEach((callbackID) => {\n        if (_onOnlySelfInRoomCallbackMap[callbackID]) {\n          _onOnlySelfInRoomCallbackMap[callbackID]();\n        }\n      });\n    }\n  }\n}\nfunction _onRoomStreamUpdate(roomID: string, updateType: number, streamList: any[]) {\n  zloginfo('_onRoomStreamUpdate: ', roomID, updateType, streamList);\n  var users: any[] = [];\n  var screenshareUsers: any[] = [];\n  if (updateType == 0) {\n    // Add\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const userName = stream.user.userName;\n      const streamID: string = stream.streamID;\n      const isScreenSharing = streamID.endsWith(_screenshareStreamIDFlag);\n      if (userID in _coreUserMap) {\n        if (isScreenSharing) {\n          _coreUserMap[userID].screenshareStreamID = streamID;\n        } else {\n          _coreUserMap[userID].streamID = streamID;\n        }\n        _streamCoreUserMap[streamID] = _coreUserMap[userID];\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n        _tryStartPlayStream(userID);\n      } else {\n        const coreUser = _createCoreUser(\n          userID,\n          userName,\n          '',\n          {}\n        );\n        if (isScreenSharing) {\n          coreUser.screenshareStreamID = streamID;\n        } else {\n          coreUser.streamID = streamID;\n        }\n        _streamCoreUserMap[streamID] = coreUser;\n        _coreUserMap[userID] = coreUser;\n      }\n\n      // Add users.\n      users.push(_coreUserMap[userID]);\n      if (isScreenSharing) {\n        screenshareUsers.push(_coreUserMap[userID]);\n      }\n\n      parseStreamExtraInfo(stream)\n    });\n\n    // notify\n    _notifyAudioVideoAvailable(users);\n    _notifyScreenSharingAvailable(screenshareUsers);\n  } else {\n    streamList.forEach((stream) => {\n      const userID = stream.user.userID;\n      const streamID = stream.streamID;\n      const isScreenSharing = streamID.endsWith(_screenshareStreamIDFlag);\n      if (userID in _coreUserMap) {\n        if (isScreenSharing) {\n          _tryStopPlayScreenshareStream(userID);\n          _coreUserMap[userID].screenshareStreamID = '';\n        } else {\n          _tryStopPlayStream(userID, true);\n          _coreUserMap[userID].isCameraDeviceOn = false;\n          _coreUserMap[userID].isMicDeviceOn = false;\n          _coreUserMap[userID].streamID = '';\n          _notifyUserInfoUpdate(_coreUserMap[userID]);\n        }\n\n        // Add users.\n        users.push(_coreUserMap[userID]);\n        if (isScreenSharing) {\n          screenshareUsers.push(_coreUserMap[userID]);\n        }\n\n        delete _streamCoreUserMap[streamID];\n      }\n    });\n\n    // notify.\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n    _notifyAudioVideoUnavailable(users);\n    _notifyScreenSharingUnavailable(screenshareUsers);\n  }\n}\nfunction _onRemoteCameraStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isCameraDeviceOn = isOn;\n    zloginfo(`RemoteCameraStateUpdate, ${userID} camera: ${isOn}`)\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.cameraStateUpdate\n    );\n\n    Object.keys(_onCameraDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onCameraDeviceOnCallbackMap[callbackID]) {\n        _onCameraDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onAudioRouteChange(type: ZegoAudioRoute) {\n  Object.keys(_onAudioOutputDeviceTypeChangeCallbackMap).forEach(\n    (callbackID) => {\n      if (_onAudioOutputDeviceTypeChangeCallbackMap[callbackID]) {\n        _onAudioOutputDeviceTypeChangeCallbackMap[callbackID](type);\n      }\n    }\n  );\n  _audioOutputType = type;\n}\nfunction _onRemoteMicStateUpdate(userID: string, isOn: boolean) {\n  if (userID in _coreUserMap) {\n    _coreUserMap[userID].isMicDeviceOn = isOn;\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n    _notifyUserCountOrPropertyChanged(\n      ZegoChangedCountOrProperty.microphoneStateUpdate\n    );\n\n    Object.keys(_onMicDeviceOnCallbackMap).forEach((callbackID) => {\n      if (_onMicDeviceOnCallbackMap[callbackID]) {\n        _onMicDeviceOnCallbackMap[callbackID](userID, isOn);\n      }\n    });\n\n    if (userID != _localCoreUser.userID) {\n      if (isOn) {\n        _tryStartPlayStream(userID);\n      }\n    }\n  }\n}\nfunction _onRoomStateChanged(roomID: string, reason: ZegoRoomStateChangedReason, errorCode: number, extendedData: string) {\n  zloginfo(`Room state changed: roomID: ${roomID}, reason: ${reason}, error: ${errorCode}, extendedData: ${extendedData}`);\n\n  // Not support multi-room right now\n  if (reason == ZegoRoomStateChangedReason.Logined || reason == ZegoRoomStateChangedReason.Reconnected) {\n    // Logined || Reconnected\n    _isRoomConnected = true;\n    _tryStartPublishStream();\n  } else {\n    _isRoomConnected = false;\n    if (reason === ZegoRoomStateChangedReason.KickOut) {\n      // KickOut\n      _notifyMeRemovedFromRoom();\n    }\n  }\n  _currentRoomState = reason;\n\n  Object.keys(_onRoomStateChangedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onRoomStateChangedCallbackMap) {\n      if (_onRoomStateChangedCallbackMap[callbackID]) {\n        _onRoomStateChangedCallbackMap[callbackID](\n          reason,\n          errorCode,\n          extendedData\n        );\n      }\n    }\n  });\n}\nfunction _onInRoomMessageReceived(roomID: string, messageList: any[]) {\n  zloginfo('Received in room message: ', roomID, messageList.length);\n  var messages: any[] = [];\n  messageList.forEach((msg) => {\n    const message = {\n      type: 'user',\n      message: msg.message,\n      messageID: msg.messageID,\n      sendTime: msg.sendTime,\n      sender: _createPublicUser(_coreUserMap[msg.fromUser.userID]),\n    };\n    messages.push(message);\n    _inRoomMessageList.push(message);\n  });\n\n  Object.keys(_onInRoomMessageReceivedCallbackMap).forEach((callbackID) => {\n    // callback may remove from map during room state chaging\n    if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n      if (_onInRoomMessageReceivedCallbackMap[callbackID]) {\n        _onInRoomMessageReceivedCallbackMap[callbackID](messages);\n      }\n    }\n  });\n}\nasync function _onRequireNewToken() {\n  Object.keys(_onRequireNewTokenCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onRequireNewTokenCallbackMap) {\n      if (_onRequireNewTokenCallbackMap[callbackID]) {\n        const token = _onRequireNewTokenCallbackMap[callbackID]();\n        if (token) {\n          ZegoExpressEngine.instance()\n            .renewToken(_currentRoomID, token)\n            .then(() => {\n              zloginfo('Renew token success');\n            })\n            .catch((error) => {\n              zlogerror('Renew token failed: ', error);\n            });\n        } else {\n          zlogerror('Renew token failed: the returned token is abnormal');\n        }\n      }\n    }\n  });\n  const token = await ZegoUIKitInternal.getToken();\n  if (token) {\n    ZegoExpressEngine.instance()\n      .renewToken(_currentRoomID, token)\n      .then(() => {\n        zloginfo('Renew token success');\n      })\n      .catch((error) => {\n        zlogerror('Renew token failed: ', error);\n      });\n  }\n}\nfunction _onRoomExtraInfoUpdate(roomID: string, roomExtraInfoList: any[]) {\n  zloginfo(`[ZegoUIKitInternal] _onRoomExtraInfoUpdate, roomID:${roomID}, roomExtraInfo:${roomExtraInfoList}`);\n  const updateKeys: string[]= [];\n  const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n  roomExtraInfoList.forEach(({ key, updateTime, updateUser, value }) => {\n    if (key === 'extra_info') {\n      const roomProperties = JSON.parse(value);\n      Object.keys(roomProperties).forEach((propertyKey) => {\n        if (oldRoomProperties[propertyKey] !== roomProperties[propertyKey]) {\n          updateKeys.push(propertyKey);\n          _roomProperties[propertyKey] = roomProperties[propertyKey];\n          _notifyRoomPropertyUpdate(propertyKey, oldRoomProperties[propertyKey], roomProperties[propertyKey], ZegoRoomPropertyUpdateType.remote);\n        }\n      })\n    }\n  });\n  if (updateKeys.length > 0) {\n    _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(JSON.stringify(_roomProperties)), ZegoRoomPropertyUpdateType.remote);\n  }\n}\nfunction _onIMCustomCommandReceived(roomID: string, fromUser: ZegoUser, command: string) {\n  zloginfo(`[ZegoUIKitInternal] _onIMCustomCommandReceived, roomID: ${roomID}, fromUser: ${fromUser}, command: ${command}`);\n  \n  try {\n    const commandObj = JSON.parse(command);\n    if (commandObj && typeof commandObj === 'object') {\n      fromUser = _createPublicUser(_coreUserMap[fromUser.userID] || fromUser);\n      const removeUserIDList = commandObj.zego_remove_user;\n      const turnCameraOnUserID = commandObj.zego_turn_camera_on;\n      const turnCameraOffUserID = commandObj.zego_turn_camera_off;\n      const turnMicrophoneOnUserID = commandObj.zego_turn_microphone_on;\n      const turnMicrophoneOffUserID = commandObj.zego_turn_microphone_off;\n      if (removeUserIDList && removeUserIDList.find((removeUserID: string) => removeUserID === _localCoreUser.userID)) {\n        _notifyMeRemovedFromRoom();\n        // Leave the room automatically\n        _leaveRoom();\n      } else if (turnCameraOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourCameraRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourCameraRequestCallbackMap[callbackID]) {\n            _onTurnOnYourCameraRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnMicrophoneOnUserID === _localCoreUser.userID) {\n        Object.keys(_onTurnOnYourMicrophoneRequestCallbackMap).forEach((callbackID) => {\n          if (_onTurnOnYourMicrophoneRequestCallbackMap[callbackID]) {\n            _onTurnOnYourMicrophoneRequestCallbackMap[callbackID](fromUser);\n          }\n        });\n      } else if (turnCameraOffUserID === _localCoreUser.userID) {\n        _turnCameraDeviceOn(_localCoreUser.userID, false);\n        // Automatic shutdown\n      } else if (turnMicrophoneOffUserID === _localCoreUser.userID) {\n        // Automatic shutdown\n        _turnMicDeviceOn(_localCoreUser.userID, false);\n      }\n    }\n  } catch (error) {\n    zlogerror(error);\n  }\n  zloginfo('_onIMCustomCommandReceived: ', roomID, fromUser, command);\n  Object.keys(_onInRoomCommandReceivedCallbackMap).forEach((callbackID) => {\n    if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n      if (_onInRoomCommandReceivedCallbackMap[callbackID]) {\n        _onInRoomCommandReceivedCallbackMap[callbackID](fromUser, command);\n      }\n    }\n  });\n}\nfunction _sendInRoomCommand(command: string, toUserList: any[]) {\n  if (!_isRoomConnected) {\n    zlogerror('You need to join the room before using this interface!');\n    return Promise.reject();\n  }\n  return new Promise<void>((resolve, reject) => {\n    ZegoExpressEngine.instance().sendCustomCommand(_currentRoomID, command, toUserList).then(({ errorCode }) => {\n      if (errorCode === 0) {\n        zloginfo('[sendInRoomCommand]Send successfully', toUserList);\n        resolve();\n      } else {\n        zloginfo('[sendInRoomCommand]Send failure', toUserList);\n        reject();\n      }\n    }).catch((error) => {\n      zloginfo('[sendInRoomCommand]Send error', error);\n      reject();\n    })\n  });\n}\nfunction _leaveRoom() {\n  return new Promise<void>((resolve, reject) => {\n    if (_currentRoomID == '') {\n      zloginfo('You are not join in any room, no need to leave room.');\n      resolve();\n    } else {\n      zloginfo('userID:', _localCoreUser.userID, ' leaveRoom:', _currentRoomID);\n      ZegoExpressEngine.instance()\n        .logoutRoom(_currentRoomID)\n        .then(() => {\n          zloginfo('Leave room succeed.');\n          ZegoUIKitReport.reportEvent('logoutRoom', {\n            'room_id': _currentRoomID,\n            'error': 0,\n            'msg': ''\n          })\n          _currentRoomID = ''\n\n          _turnCameraDeviceOn(_localCoreUser.userID, false);\n          _turnMicDeviceOn(_localCoreUser.userID, false);\n          ZegoExpressEngine.instance().stopSoundLevelMonitor();\n          _notifyUserCountOrPropertyChanged(\n            ZegoChangedCountOrProperty.userDelete\n          );\n          _resetDataForLeavingRoom();\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Leave room failed: ', error);\n          ZegoUIKitReport.reportEvent('logoutRoom', {\n            'room_id': _currentRoomID,\n            'error': -1,\n            'msg': JSON.stringify(error)\n          })\n\n          reject(error);\n        });\n    }\n  });\n}\nfunction _turnMicDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      zloginfo(`turnMicDeviceOn: userID: ${_localCoreUser.userID}, mic: ${on}`);\n      ZegoExpressEngine.instance().muteMicrophone(!on);\n\n      _onRemoteMicStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isMicDeviceOn = on;\n      _coreUserMap[_localCoreUser.userID].isMicDeviceOn = on;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.microphoneStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : _localCoreUser.isCameraDeviceOn,\n          isMicrophoneOn : on\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo), ZegoPublishChannel.Main);\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();  // Don't worry! It will check internally that both the camera and microphone are turned off before stopping the stream.\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_microphone_on: userID }) : JSON.stringify({ zego_turn_microphone_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnMicDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnMicDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _turnCameraDeviceOn(userID: string, on: boolean) {\n  return new Promise<void>((resolve, reject) => {\n    if (_isLocalUser(userID)) {\n      // Default to Main Channel\n      zloginfo('turnCameraDeviceOn: ', _localCoreUser.userID, on);\n      ZegoExpressEngine.instance().enableCamera(on, 0);\n\n      _onRemoteCameraStateUpdate(_localCoreUser.userID, on);\n\n      _localCoreUser.isCameraDeviceOn = on;\n      // if (!on) {\n      //     _localCoreUser.viewID = -1;\n      // }\n      _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n      _notifyUserInfoUpdate(_localCoreUser);\n      _notifyUserCountOrPropertyChanged(\n        ZegoChangedCountOrProperty.cameraStateUpdate\n      );\n\n      // sync device status via stream extra info\n      var extraInfo = {\n          isCameraOn : on,\n          isMicrophoneOn : _localCoreUser.isMicDeviceOn\n      }\n      ZegoExpressEngine.instance().setStreamExtraInfo(JSON.stringify(extraInfo), ZegoPublishChannel.Main);\n\n      if (on) {\n        _tryStartPublishStream();\n      } else {\n        _tryStopPublishStream();  // Don't worry! It will check internally that both the camera and microphone are turned off before stopping the stream.\n      }\n      resolve();\n    } else {\n      const isLargeRoom = _isLargeRoom || _markAsLargeRoom;\n      const command = on ? JSON.stringify({ zego_turn_camera_on: userID }) : JSON.stringify({ zego_turn_camera_off: userID });\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      const toUserList = isLargeRoom ? [] : [{ userID, userName }];\n      _sendInRoomCommand(command, toUserList).then(() => {\n        zloginfo('turnCameraDeviceOn others: ', userID, on);\n        resolve();\n      }).catch(() => {\n        zlogerror('turnCameraDeviceOn others error: ', userID, on);\n        reject();\n      });\n    }\n  });\n}\nfunction _registerEngineCallback() {\n  zloginfo('Register callback for ZegoExpressEngine...');\n  ZegoExpressEngine.instance().on('roomUserUpdate', (roomID, updateType: ZegoUpdateType, userList) => {\n      zloginfo('[roomUserUpdate callback]', roomID, getZegoUpdateTypeName(updateType), userList);\n      _onRoomUserUpdate(roomID, updateType, userList);\n  });\n  ZegoExpressEngine.instance().on('roomStreamUpdate', (roomID, updateType: ZegoUpdateType, streamList) => {\n      zloginfo('[roomStreamUpdate callback]', roomID, getZegoUpdateTypeName(updateType), streamList);\n      _onRoomStreamUpdate(roomID, updateType, streamList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'publisherQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        _qualityUpdateLogCounter = 0;\n        zloginfo('[publisherQualityUpdate callback]', streamID, quality);\n      }\n      _qualityUpdateLogCounter++;\n      if (streamID.split('_')[2] === 'main') {\n        _localCoreUser.publisherQuality = quality;\n        _coreUserMap[_localCoreUser.userID].publisherQuality = quality;\n        _notifyUserInfoUpdate(_coreUserMap[_localCoreUser.userID]);\n      }\n    }\n  );\n  // ZegoExpressEngine.instance().on(\n  //     'publisherStateUpdate',\n  //     (streamID, state, errorCode, extendedData) => {\n  //         zloginfo('publisherStateUpdate#################', streamID, state, errorCode)\n  //     },\n  // );\n  ZegoExpressEngine.instance().on(\n    'playerQualityUpdate',\n    (streamID, quality) => {\n      if (_qualityUpdateLogCounter % 10 == 0) {\n        // zloginfo('[playerQualityUpdate callback]', streamID, quality);\n      }\n      // TODO\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteCameraStateUpdate', (streamID, state: ZegoRemoteDeviceState) => {\n      zloginfo('[remoteCameraStateUpdate callback]', streamID, getZegoRemoteDeviceStateName(state));\n      if (streamID.endsWith(_screenshareStreamIDFlag)) {\n        return;\n      }\n\n      let isCameraOn = (state == ZegoRemoteDeviceState.Open)\n      _onRemoteCameraStateUpdate(_getUserIDByStreamID(streamID), isCameraOn);\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteMicStateUpdate', (streamID, state: ZegoRemoteDeviceState) => {\n    zloginfo('[remoteMicStateUpdate callback]', streamID, getZegoRemoteDeviceStateName(state));\n    if (streamID.endsWith(_screenshareStreamIDFlag)) {\n      return;\n    }\n\n    let isMicOn = (state == ZegoRemoteDeviceState.Open)\n    _onRemoteMicStateUpdate(_getUserIDByStreamID(streamID), isMicOn);\n  });\n  ZegoExpressEngine.instance().on(\n    'playerStateUpdate',\n    (streamID, state, errorCode, extendedData) => {\n      zloginfo(\n        '[playerStateUpdate callback]',\n        streamID,\n        state,\n        errorCode,\n        extendedData\n      );\n    }\n  );\n  ZegoExpressEngine.instance().on('remoteSoundLevelUpdate', (soundLevels: any) => {\n    // {streamID, soundLavel} value from 0.0 to 100.0\n    // zloginfo('[remoteSoundLevelUpdate callback]', soundLevels);\n    Object.keys(soundLevels).forEach((streamID) => {\n      const userID = _getUserIDByStreamID(streamID);\n      if (userID in _coreUserMap) {\n        _coreUserMap[userID].soundLevel = soundLevels[streamID];\n        _notifySoundLevelUpdate(userID, soundLevels[streamID]);\n      }\n    });\n  });\n  ZegoExpressEngine.instance().on('capturedSoundLevelUpdate', (soundLevel) => {\n    if (\n      _localCoreUser.userID === '' ||\n      !(_localCoreUser.userID in _coreUserMap)\n    ) {\n      return;\n    }\n    _localCoreUser.soundLevel = soundLevel;\n    _coreUserMap[_localCoreUser.userID].soundLevel = soundLevel;\n    _notifySoundLevelUpdate(_localCoreUser.userID, soundLevel);\n    // zloginfo('capturedSoundLevelUpdate', soundLevel)\n  });\n  // https://doc-en-api.zego.im/ReactNative/enums/_zegoexpressdefines_.zegoroomstatechangedreason.html\n  ZegoExpressEngine.instance().on(\n    'roomStateChanged',\n    (roomID, reason, errorCode, extendedData) => {\n      zloginfo(\n        '[roomStateChanged callback]',\n        roomID,\n        reason,\n        errorCode,\n        extendedData\n      );\n      _onRoomStateChanged(roomID, reason, errorCode, extendedData);\n    }\n  );\n  ZegoExpressEngine.instance().on('audioRouteChange', (audioRoute) => {\n    zloginfo('[audioRouteChange callback]', audioRoute);\n    _onAudioRouteChange(audioRoute);\n  });\n  ZegoExpressEngine.instance().on(\n    'IMRecvBroadcastMessage',\n    (roomID, messageList) => {\n      _onInRoomMessageReceived(roomID, messageList);\n    }\n  );\n  ZegoExpressEngine.instance().on(\n    'roomTokenWillExpire',\n    (roomID, remainTimeInSecond) => {\n      zloginfo('express token will expire.');\n      _onRequireNewToken();\n    }\n  );\n  ZegoExpressEngine.instance().on('roomExtraInfoUpdate', (roomID, roomExtraInfoList) => {\n    _onRoomExtraInfoUpdate(roomID, roomExtraInfoList);\n  });\n  ZegoExpressEngine.instance().on('roomStreamExtraInfoUpdate', (roomID, streamList) => {\n    zloginfo('roomStreamExtraInfoUpdate', streamList)\n    streamList.forEach((stream) => {\n      parseStreamExtraInfo(stream)\n    })\n  });\n  ZegoExpressEngine.instance().on('IMRecvCustomCommand', (roomID, fromUser, command) => {\n    zloginfo('IMRecvCustomCommand', roomID, fromUser, command);\n    _onIMCustomCommandReceived(roomID, fromUser, command);\n  });\n  ZegoExpressEngine.instance().on('playerVideoSizeChanged', (streamID, width, height) => {\n    zloginfo('playerVideoSizeChanged', streamID, width, height);\n    const userID =  _streamCoreUserMap[streamID].userID;\n    _coreUserMap[userID].isLandscape = width > height;\n    ZegoUIKitInternal.forceRenderVideoView();\n  });\n  ZegoExpressEngine.instance().on('publisherVideoSizeChanged', (width, height, channel) => {\n    zloginfo('publisherVideoSizeChanged', width, height, channel);\n    _localCoreUser.isLandscape = width > height;\n    if (_currentRoomID) {\n      // _coreUserMap will be fill after entering the room.\n      _coreUserMap[_localCoreUser.userID].isLandscape = width > height;\n    }\n    ZegoUIKitInternal.forceRenderVideoView();\n  });\n  ZegoExpressEngine.instance().on('engineStateUpdate', (state: ZegoEngineState) => {\n    zloginfo('[engineStateUpdate callback]', getZegoEngineStateName(state));\n    _engineState = state;\n  });\n}\nfunction _unregisterEngineCallback() {\n  zloginfo('Unregister callback from ZegoExpressEngine...');\n  ZegoExpressEngine.instance().off('roomUserUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamUpdate', undefined);\n  ZegoExpressEngine.instance().off('publisherQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerQualityUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteCameraStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteMicStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('playerStateUpdate', undefined);\n  ZegoExpressEngine.instance().off('remoteSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('capturedSoundLevelUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStateChanged', undefined);\n  ZegoExpressEngine.instance().off('audioRouteChange', undefined);\n  ZegoExpressEngine.instance().off('IMRecvBroadcastMessage', undefined);\n  ZegoExpressEngine.instance().off('roomTokenWillExpire', undefined);\n  ZegoExpressEngine.instance().off('roomExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('roomStreamExtraInfoUpdate', undefined);\n  ZegoExpressEngine.instance().off('IMRecvCustomCommand', undefined);\n  ZegoExpressEngine.instance().off('playerVideoSizeChanged', undefined);\n  ZegoExpressEngine.instance().off('publisherVideoSizeChanged', undefined);\n  ZegoExpressEngine.instance().off('engineStateUpdate', undefined);\n}\nfunction _notifyUserCountOrPropertyChanged(type: number) {\n  const msg = [\n    '',\n    'user add',\n    'user delete',\n    'mic update',\n    'camera update',\n    'attributes update',\n  ];\n  const userList = Object.values(_coreUserMap)\n    .sort((user1: any, user2: any) => {\n      return user2.joinTime - user1.joinTime;\n    })\n    .map((user) => _createPublicUser(user));\n  zloginfo(`_notifyUserCountOrPropertyChanged ${msg[type]}, retain users: `, userList);\n  Object.keys(_onUserCountOrPropertyChangedCallbackMap).forEach(\n    (callbackID) => {\n      if (_onUserCountOrPropertyChangedCallbackMap[callbackID]) {\n        _onUserCountOrPropertyChangedCallbackMap[callbackID](\n          JSON.parse(JSON.stringify(userList))\n        );\n      }\n    }\n  );\n}\n\n// >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Stream Handling <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\nfunction _getUserIDByStreamID(streamID: string) {\n  // StreamID format: roomid_userid_main\n  for (const userID in _coreUserMap) {\n    if (_coreUserMap[userID].streamID == streamID) {\n      return userID;\n    }\n  }\n  return '';\n}\nfunction _getPublishStreamID() {\n  return _currentRoomID + '_' + _localCoreUser.userID + '_main';\n}\nfunction _getStreamIDByUserID(userID: string) {\n  return _currentRoomID + '_' + userID + '_main';\n}\n\nfunction _getScreenshareStreamIDByUserID(userID: string) {\n  return _currentRoomID + '_' + userID + _screenshareStreamIDFlag;\n}\n\n\nfunction parseStreamExtraInfo(stream: ZegoStream) {\n  try {\n    var extraInfo = JSON.parse(stream.extraInfo)\n    if ('isCameraOn' in extraInfo) {\n        _onRemoteCameraStateUpdate(stream.user.userID, extraInfo.isCameraOn)\n    }\n    if ('isMicrophoneOn' in extraInfo) {\n        _onRemoteMicStateUpdate(stream.user.userID, extraInfo.isMicrophoneOn)\n    }\n  } catch (error) {\n    zlogerror('parse streamExtraInfo ERROR: ', error)\n  }\n}\n\nfunction _tryStartPublishStream() {\n  if (_localCoreUser.isMicDeviceOn || _localCoreUser.isCameraDeviceOn) {\n    zloginfo(\n      '_tryStartPublishStream',\n      ', mic:',\n      _localCoreUser.isMicDeviceOn,\n      ', camera:',\n      _localCoreUser.isCameraDeviceOn,\n      _localCoreUser.streamID\n    );\n    if (_localCoreUser.streamID) {\n      ZegoExpressEngine.instance()\n      .startPublishingStream(_localCoreUser.streamID, ZegoPublishChannel.Main, undefined)\n      .then(() => {\n        zloginfo('Notify local user audioVideoAvailable start', _localCoreUser.streamID + '', JSON.parse(JSON.stringify(_streamCoreUserMap)));\n        // if (_localCoreUser.streamID in _streamCoreUserMap) {\n          _streamCoreUserMap[_localCoreUser.streamID] = _localCoreUser;\n\n          zloginfo('Notify local user audioVideoAvailable end', _localCoreUser);\n          _notifyAudioVideoAvailable([_localCoreUser]);\n        // }\n      });\n    }\n\n    if (_localCoreUser.viewID > 0 && _localCoreUser.isCameraDeviceOn) {\n      zloginfo('ZegoExpressEngine startPreview:', _localCoreUser);\n      ZegoExpressEngine.instance()\n        .startPreview({\n          reactTag: _localCoreUser.viewID,\n          viewMode: _localCoreUser.fillMode,\n          backgroundColor: 0,\n        }, ZegoPublishChannel.Main)\n        .catch((error) => {\n          zlogerror(error);\n        });\n    }\n  }\n}\nfunction _tryStopPublishStream(force = false) {\n  if (!_localCoreUser.isMicDeviceOn && !_localCoreUser.isCameraDeviceOn) {\n    zloginfo('stopPublishStream stopPreview');\n    try {\n      ZegoExpressEngine.instance().stopPublishingStream(ZegoPublishChannel.Main);\n      ZegoExpressEngine.instance().stopPreview(ZegoPublishChannel.Main);  \n    } catch (e) {\n      zloginfo('stopPublishStream stopPreview, but expressengine is null')\n    }\n\n    if (_localCoreUser.streamID in _streamCoreUserMap) {\n      delete _streamCoreUserMap[_localCoreUser.streamID];\n      _notifyAudioVideoUnavailable([_localCoreUser]);\n    }\n  }\n}\nfunction _tryStartPlayStream(userID: string) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    zloginfo(`[_tryStartPlayStream] userID: ${user.userID}, viewID: ${user.viewID}, fillMode: ${user.fillMode}, resourceMode: ${_audioVideoResourceMode}`)\n\n    // Playing Streaming.\n    if (user.streamID !== '') {\n      if (user.viewID > 0) {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, {\n          reactTag: user.viewID,\n          viewMode: user.fillMode,\n          backgroundColor: 0,\n        }, {\n          resourceMode: _audioVideoResourceMode,\n        })\n        .then(() => {\n        })\n        .catch((error) => {\n          zlogerror(`startPlayingStream fail, stream: ${user.streamID}`)\n        });\n      } else {\n        ZegoExpressEngine.instance().startPlayingStream(user.streamID, undefined, {\n          resourceMode: _audioVideoResourceMode,\n        })\n        .then(() => {\n        })\n        .catch((error) => {\n          zlogerror(`startPlayingStream fail, stream: ${user.streamID}`)\n        });\n      }\n    }\n\n    // Playing Screenshare Streaming.\n    if (user.screenshareStreamID !== '' && user.screenshareViewID > 0) {\n      ZegoExpressEngine.instance().startPlayingStream(user.screenshareStreamID, {\n        reactTag: user.screenshareViewID,\n        viewMode: user.screenshareViewFillMode,\n        backgroundColor: 0,\n      }, {\n        resourceMode: _audioVideoResourceMode,\n      });\n    }\n  }\n}\nfunction _tryStopPlayStream(userID: string, force = false) {\n  zloginfo(`[_tryStopPlayStream] userID: ${userID}`)\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    if (force || (!user.isMicDeviceOn && !user.isCameraDeviceOn)) {\n      ZegoExpressEngine.instance().stopPlayingStream(user.streamID);\n    }\n  }\n}\nfunction _tryStopPlayScreenshareStream(userID: string) {\n  if (userID in _coreUserMap) {\n    const user = _coreUserMap[userID];\n    if (user.screenshareStreamID !== '') {\n      ZegoExpressEngine.instance().stopPlayingStream(user.screenshareStreamID);\n    }\n  }\n}\nfunction _notifyUserInfoUpdate(userInfo: any) {\n  Object.keys(_onUserInfoUpdateCallbackMap).forEach((callbackID) => {\n    if (_onUserInfoUpdateCallbackMap[callbackID]) {\n      _onUserInfoUpdateCallbackMap[callbackID](userInfo);\n    }\n  });\n}\nfunction _notifySoundLevelUpdate(userID: string, soundLevel: number) {\n  Object.keys(_onSoundLevelUpdateCallbackMap).forEach((callbackID) => {\n    if (_onSoundLevelUpdateCallbackMap[callbackID]) {\n      _onSoundLevelUpdateCallbackMap[callbackID](userID, soundLevel);\n    }\n  });\n}\nfunction _notifyRoomPropertyUpdate(key: string, oldValue: any, value: any, type: number) {\n  Object.keys(_onRoomPropertyUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertyUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertyUpdatedCallbackMap[callbackID](key, oldValue, value, type);\n    }\n  });\n}\nfunction _notifyRoomPropertiesFullUpdate(keys: string[], oldRoomProperties: any, roomProperties: any, type: number) {\n  Object.keys(_onRoomPropertiesFullUpdatedCallbackMap).forEach((callbackID) => {\n    if (_onRoomPropertiesFullUpdatedCallbackMap[callbackID]) {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID](keys, oldRoomProperties, roomProperties, type);\n    }\n  });\n}\nfunction _notifyMeRemovedFromRoom() {\n  Object.keys(_onMeRemovedFromRoomCallbackMap).forEach((callbackID) => {\n    if (_onMeRemovedFromRoomCallbackMap[callbackID]) {\n      _onMeRemovedFromRoomCallbackMap[callbackID]();\n    }\n  });\n}\nfunction _notifyJoinRoom() {\n  Object.keys(_onJoinRoomCallbackMap).forEach((callbackID) => {\n    if (_onJoinRoomCallbackMap[callbackID]) {\n      _onJoinRoomCallbackMap[callbackID]();\n    }\n  });\n}\n\nfunction _notifyAudioVideoAvailable(users: any[]) {\n  Object.keys(_onAudioVideoAvailableCallbackMap).forEach((callbackID) => {\n    if (_onAudioVideoAvailableCallbackMap[callbackID]) {\n      _onAudioVideoAvailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyAudioVideoUnavailable(users: any[]) {\n  Object.keys(_onAudioVideoUnavailableCallbackMap).forEach((callbackID) => {\n    if (_onAudioVideoUnavailableCallbackMap[callbackID]) {\n      _onAudioVideoUnavailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyScreenSharingAvailable(users: any[]) {\n  Object.keys(_onScreenSharingAvailableCallbackMap).forEach((callbackID) => {\n    if (_onScreenSharingAvailableCallbackMap[callbackID]) {\n      _onScreenSharingAvailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _notifyScreenSharingUnavailable(users: any[]) {\n  Object.keys(_onScreenSharingUnavailableCallbackMap).forEach((callbackID) => {\n    if (_onScreenSharingUnavailableCallbackMap[callbackID]) {\n      _onScreenSharingUnavailableCallbackMap[callbackID](users);\n    }\n  });\n}\n\nfunction _applyVideoConfig() {\n  const config = _videoConfig.toSDK(_appOrientation);\n  ZegoExpressEngine.instance().setVideoConfig(config, ZegoPublishChannel.Main);\n  zloginfo(`[setAppOrientation] express setVideoConfig:${JSON.stringify(config)}`);\n}\n\nconst _isEngineCreated = () => {\n  try {\n    return ZegoExpressEngine.instance() != undefined;\n  } catch (error) {\n    return false;\n  }\n}\n\nconst ZegoUIKitInternal =  {\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Internal <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  getPackageVersion() {\n    return getPackageVersion();\n  },\n  logComponentsVersion(extraInfo: Map<string, string>) {\n    logComponentsVersion(extraInfo);\n  },\n  isRoomConnected() {\n    return _isRoomConnected;\n  },\n  setAudioVideoResourceMode(audioVideoResourceMode: any) {\n    zloginfo('setAudioVideoResourceMode', audioVideoResourceMode);\n    _audioVideoResourceMode = audioVideoResourceMode || ZegoAudioVideoResourceMode.Default;\n  },\n  updateRenderingProperty(userID: string, viewID: number, lastViewID: number, fillMode: number, isScreenshare: boolean = false) {\n    zloginfo(`[updateRenderingProperty] userID: ${userID}, viewID: ${viewID}, lastViewID: ${lastViewID}, fillMode: ${fillMode}, isScreenshare: ${isScreenshare}`)\n    if (userID === undefined) {\n      zlogwarning(\n        'updateRenderingProperty: ignore undefined useid. Use empty string for local user.'\n      );\n      return;\n    }\n    if (userID === '') {\n      userID = _localCoreUser.userID;\n    }\n    if (userID in _coreUserMap) {\n      // Avoid issues when the stream is handed over between two views.\n      let canUpdateViewID = true\n      if (viewID <= 0) {\n        if (isScreenshare) {\n          canUpdateViewID = (lastViewID === _coreUserMap[userID].screenshareViewID)\n        } else {\n          canUpdateViewID = (lastViewID === _coreUserMap[userID].viewID)\n        }\n      }\n      if (canUpdateViewID) {\n        if (isScreenshare) {\n          _coreUserMap[userID].screenshareViewID = viewID;\n          _coreUserMap[userID].screenshareViewFillMode = fillMode;\n        } else {\n          _coreUserMap[userID].viewID = viewID;\n          _coreUserMap[userID].fillMode = fillMode;\n        }\n        _notifyUserInfoUpdate(_coreUserMap[userID]);\n      } else {\n        zloginfo('[updateRenderingProperty] can not update viewID')\n      }\n\n      if (_localCoreUser.userID == userID) {\n        _localCoreUser.viewID = viewID;\n        _localCoreUser.fillMode = fillMode;\n        if (viewID > 0) {\n          _tryStartPublishStream();\n        } else {\n          _tryStopPublishStream();\n        }\n      } else {\n        // Check if stream is ready to play for remote user\n        if (viewID > 0) {\n          _tryStartPlayStream(userID);\n        }\n      }\n    }\n  },\n  onUserInfoUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserInfoUpdateCallbackMap) {\n        zloginfo(\n          '[onUserInfoUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserInfoUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onUserInfoUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSoundLevelUpdate(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSoundLevelUpdateCallbackMap) {\n        zloginfo(\n          '[onSoundLevelUpdate] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSoundLevelUpdateCallbackMap[callbackID];\n      }\n    } else {\n      _onSoundLevelUpdateCallbackMap[callbackID] = callback;\n    }\n  },\n  onSDKConnected(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onSDKConnectedCallbackMap) {\n        zloginfo(\n          '[onSDKConnected] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onSDKConnectedCallbackMap[callbackID];\n      }\n    } else {\n      _onSDKConnectedCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> SDK <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectSDK(appID: number, appSign: string, userInfo: any) {\n    // Solve the problem of repeated initialization\n    if (_isEngineCreated()) {\n      zloginfo('Create ZegoExpressEngine succeed already!');\n\n      _unregisterEngineCallback();\n      _registerEngineCallback();\n      _applyVideoConfig()\n\n      _localCoreUser.userID = userInfo.userID;\n      _localCoreUser.userName = userInfo.userName;\n      _coreUserMap[userInfo.userID] = _localCoreUser;\n\n      Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n        // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n        if (_onSDKConnectedCallbackMap[callbackID]) {\n          _onSDKConnectedCallbackMap[callbackID]();\n        }\n      });\n\n      return Promise.resolve();\n    }\n    return new Promise<void>((resolve, reject) => {\n      // set advancedConfig to monitor remote user's device changed\n      ZegoExpressEngine.setEngineConfig({\n        advancedConfig: {\n          // @ts-ignore\n          notify_remote_device_unknown_status: 'true',\n          notify_remote_device_init_status: 'true',\n        },\n      });\n      const engineProfile: ZegoEngineProfile = {\n        appID: appID,\n        appSign: appSign,\n        scenario: 0,\n      };\n      ZegoUIKitReport.create(appID, appSign, {\n        'user_id': userInfo.userID\n      });\n\n      zloginfo(`[ZegoUIKitInternal][connectSDK] createEngine`)\n      ZegoExpressEngine.createEngineWithProfile(engineProfile)\n        .then((engine) => {\n          zloginfo('Create ZegoExpressEngine succeed!');\n          _appInfo.appID = appID;\n          _appInfo.appSign = appSign;\n          _unregisterEngineCallback();\n          _registerEngineCallback();\n          _applyVideoConfig()\n          _setLocalUserInfo(userInfo);\n\n          Object.keys(_onSDKConnectedCallbackMap).forEach((callbackID) => {\n            // TODO cause  WARN  Possible Unhandled Promise Rejection (id: 56)\n            if (_onSDKConnectedCallbackMap[callbackID]) {\n              _onSDKConnectedCallbackMap[callbackID]();\n            }\n          });\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Create ZegoExpressEngine Failed: ', error);\n          reject(error);\n        });\n    });\n  },\n  disconnectSDK() {\n    return new Promise<void>((resolve, reject) => {\n      zloginfo(`[ZegoUIKitInternal][disconnectSDK] destroyEngine`)\n      if (ZegoExpressEngine.instance()) {\n        ZegoExpressEngine.destroyEngine()\n          .then(() => {\n            zloginfo('Destroy ZegoExpressEngine finished!');\n            resolve();\n          })\n          .catch((error) => {\n            zlogerror('Destroy ZegoExpressEngine failed!', error);\n            reject(error);\n          })\n          .finally(() => {\n            _resetData();\n          });\n      } else {\n        resolve();\n      }\n    });\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Audio Video <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  useFrontFacingCamera(isFrontFacing: boolean) {\n    zloginfo('UseFrontFacingCamera: ', isFrontFacing);\n    _usingFrontFacingCamera = isFrontFacing;\n    return ZegoExpressEngine.instance().useFrontCamera(isFrontFacing, 0);\n  },\n  isUsingFrontFacingCamera() {\n    return _usingFrontFacingCamera;\n  },\n  isMicDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isMicDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isMicDeviceOn;\n    } else {\n      zloginfo(\n        'Can not check mic device is on for user[',\n        userID,\n        '], because no record!'\n      );\n      return true;\n    }\n  },\n  isCameraDeviceOn(userID: string) {\n    if (!userID) {\n      return _localCoreUser.isCameraDeviceOn;\n    } else if (userID in _coreUserMap) {\n      return _coreUserMap[userID].isCameraDeviceOn;\n    } else {\n      zloginfo(\n        'No record for user: ',\n        userID,\n        '. Can not check camera device is on.'\n      );\n      return true;\n    }\n  },\n  enableSpeaker(enable: boolean) {\n    // TODO\n    return new Promise<void>((resolve, reject) => {\n      if (!_isRoomConnected) {\n        zlogerror('You are not connect to any room.');\n        reject();\n      } else {\n        ZegoExpressEngine.instance().muteSpeaker(!enable);\n        resolve();\n      }\n    });\n  },\n  audioOutputDeviceType() {\n    return _audioOutputType;\n  },\n  turnMicDeviceOn(userID: string, on: boolean) {\n    return _turnMicDeviceOn(userID, on);\n  },\n  turnCameraDeviceOn(userID: string, on: boolean) {\n    return _turnCameraDeviceOn(userID, on);\n  },\n  onMicDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMicDeviceOnCallbackMap) {\n        zloginfo(\n          '[onMicDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMicDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onMicDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  onCameraDeviceOn(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onCameraDeviceOnCallbackMap) {\n        zloginfo(\n          '[onCameraDeviceOn] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onCameraDeviceOnCallbackMap[callbackID];\n      }\n    } else {\n      _onCameraDeviceOnCallbackMap[callbackID] = callback;\n    }\n  },\n  setAudioOutputToSpeaker(isSpeaker: boolean) {\n    ZegoExpressEngine.instance().setAudioRouteToSpeaker(isSpeaker);\n  },\n  onAudioOutputDeviceTypeChange(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioOutputDeviceTypeChangeCallbackMap) {\n        zloginfo(\n          '[onAudioOutputDeviceTypeChange] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioOutputDeviceTypeChangeCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioOutputDeviceTypeChangeCallbackMap[callbackID] = callback;\n    }\n  },\n  \n  setAudioConfig(config: any) {\n    // TODO\n  },\n\n  //  setAppOrientation \n  setVideoConfig(config: ZegoUIKitVideoConfig) {\n    zloginfo(`[setVideoConfig] videoConfig:${JSON.stringify(config)}`);\n    _videoConfig = config;\n  },\n\n  setAppOrientation(orientation: ZegoOrientation) {\n    zloginfo(`[setAppOrientation] orientation:${orientation}`);\n    _appOrientation = orientation;\n    if (_localCoreUser) {\n      _localCoreUser.isLandscape = (_appOrientation !== 0);\n    }\n    if (_coreUserMap[_localCoreUser.userID]) {\n      _coreUserMap[_localCoreUser.userID].isLandscape = (_appOrientation !== 0);\n    }\n    if (_isEngineCreated()) {\n      if (_engineState === ZegoEngineState.Stop) {\n        _applyVideoConfig()\n      } else {\n        zloginfo(`[setAppOrientation] engineState is Start, can't apply video config`);\n      }\n      ZegoExpressEngine.instance().setAppOrientation(_appOrientation, ZegoPublishChannel.Main);\n      zloginfo(`[setAppOrientation] express setAppOrientation:${_appOrientation}, engineState:${getZegoEngineStateName(_engineState)}`);\n    }\n  },\n\n  appOrientation() {\n    return _appOrientation;\n  },\n  \n  onAudioVideoAvailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoAvailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoAvailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoAvailableCallbackMap[callbackID] = callback;\n    }\n  },\n  onAudioVideoUnavailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoUnavailableCallbackMap) {\n        zloginfo(\n          '[onAudioVideoUnavailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoUnavailableCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoUnavailableCallbackMap[callbackID] = callback;\n    }\n  },\n  muteUserAudio(userID: string, mute: boolean) {\n    const user = _coreUserMap[userID];\n    zloginfo('[muteUserAudio]', userID, user.streamID, mute);\n    if (user.streamID) {\n      ZegoExpressEngine.instance().mutePlayStreamAudio(user.streamID, mute);\n    }\n  },\n  muteUserVideo(userID: string, mute: boolean) {\n    const user = _coreUserMap[userID];\n    zloginfo('[muteUserVideo]', userID, user.streamID, mute);\n    if (user.streamID) {\n      ZegoExpressEngine.instance().mutePlayStreamVideo(user.streamID, mute);\n    }\n  },\n  startPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(false);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(false);\n  },\n  stopPlayingAllAudioVideo() {\n    ZegoExpressEngine.instance().muteAllPlayStreamAudio(true);\n    ZegoExpressEngine.instance().muteAllPlayStreamVideo(true);\n  },\n  onTurnOnYourCameraRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourCameraRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourCameraRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourCameraRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourCameraRequestCallbackMap[callbackID] = callback;\n    }\n  },\n  onTurnOnYourMicrophoneRequest(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onTurnOnYourMicrophoneRequestCallbackMap) {\n        zloginfo(\n          '[onTurnOnYourMicrophoneRequest] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onTurnOnYourMicrophoneRequestCallbackMap[callbackID];\n      }\n    } else {\n      _onTurnOnYourMicrophoneRequestCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  async joinRoom(roomID: string, token: string, markAsLargeRoom = false) {\n    if (!roomID || roomID.trim().length == 0) {\n      throw new Error(\"roomID can't is empty when loginRoom!\");\n    }\n\n    // Solve the problem of repeated join\n    if (_isRoomConnected && _currentRoomID === roomID) {\n      zloginfo(`Join room: ${roomID} success already.`);\n      return Promise.resolve();\n    }\n    \n    if (_appInfo.appSign === '' && token === '') {\n      token = await ZegoUIKitInternal.getToken();\n    }\n    ZegoExpressEngine.instance().logoutRoom(undefined);\n    return new Promise<void>((resolve, reject) => {\n      const user = {\n        userID: _localCoreUser.userID,\n        userName: _localCoreUser.userName,\n      };\n      const config = { isUserStatusNotify: true } as ZegoRoomConfig;\n      token && (config.token = token);\n      _currentRoomID = roomID;\n\n      const eventBegin = Date.now();\n      zloginfo(`[ZegoUIKitInternal][joinRoom] loginRoom, roomID: ${roomID}`)\n      ZegoExpressEngine.instance()\n        .loginRoom(roomID, user, config)\n        .then(() => {\n          zloginfo(`Join room: ${roomID} success. ${JSON.stringify(user)}`);\n          ZegoUIKitReport.reportEvent('loginRoom', {\n            'room_id': roomID,\n            'error': 0,\n            'msg' : '',\n            'start_time': eventBegin\n          })\n\n          _roomMemberCount = 1\n          _markAsLargeRoom = markAsLargeRoom;\n          ZegoExpressEngine.instance().startSoundLevelMonitor(undefined);\n\n          _localCoreUser.streamID = _getPublishStreamID();\n          _coreUserMap[_localCoreUser.userID] = _localCoreUser;\n          _notifyUserCountOrPropertyChanged(ZegoChangedCountOrProperty.userAdd);\n\n          _tryStartPublishStream()\n          \n          _notifyJoinRoom()\n\n          resolve();\n        })\n        .catch((error) => {\n          zlogerror('Join room falied: ', error);\n          ZegoUIKitReport.reportEvent('loginRoom', {\n            'room_id': roomID,\n            'error': -1,\n            'msg' : JSON.stringify(error),\n            'start_time': eventBegin\n          })\n\n          _currentRoomID = '';\n          reject(error);\n        });\n    });\n  },\n  inRoom() {\n    return _currentRoomID.length > 0\n  },\n  leaveRoom() {\n    return _leaveRoom();\n  },\n  onRoomStateChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomStateChangedCallbackMap) {\n        zloginfo(\n          '[onRoomStateChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomStateChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomStateChangedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRequireNewToken(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRequireNewTokenCallbackMap) {\n        zloginfo(\n          '[onRequireNewToken] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRequireNewTokenCallbackMap[callbackID];\n      }\n    } else {\n      _onRequireNewTokenCallbackMap[callbackID] = callback;\n    }\n  },\n  setRoomProperty(key: string, value: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return;\n    }\n    if (_roomProperties[key] === value) {\n      return;\n    }\n    const oldValue = _roomProperties[key];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    _roomProperties[key] = value;\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Set start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Set success');\n          resolve();\n          // Notify\n          _notifyRoomPropertyUpdate(key, oldValue, value, ZegoRoomPropertyUpdateType.set);\n          _notifyRoomPropertiesFullUpdate([key], oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.set);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[setRoomProperty]Set failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[setRoomProperty]Set error', error);\n        reject(error);\n      });\n    });\n  },\n  updateRoomProperties(newRoomProperties: any) {\n    if (!_isRoomConnected) {\n      zlogerror('You need to join the room before using this interface!');\n      return Promise.reject();\n    }\n    const updateKeys: string[] = [];\n    const oldRoomProperties = JSON.parse(JSON.stringify(_roomProperties));\n    Object.keys(newRoomProperties).forEach((key) => {\n      if (oldRoomProperties[key] !== newRoomProperties[key]) {\n        updateKeys.push(key);\n        _roomProperties[key] = newRoomProperties[key];\n      }\n    })\n    const extraInfo = JSON.stringify(_roomProperties);\n    zloginfo('[updateRoomProperties]Update start', extraInfo);\n    return new Promise<void>((resolve, reject) => {\n      ZegoExpressEngine.instance().setRoomExtraInfo(_currentRoomID, 'extra_info', extraInfo).then(({ errorCode }) => {\n        if (errorCode === 0) {\n          zloginfo('[updateRoomProperties]Update success');\n          resolve();\n          // Notify\n          updateKeys.forEach((updateKey) => {\n            const oldValue = oldRoomProperties[updateKey];\n            const value = newRoomProperties[updateKey];\n            _notifyRoomPropertyUpdate(updateKey, oldValue, value, ZegoRoomPropertyUpdateType.update);\n          })\n          updateKeys.length && _notifyRoomPropertiesFullUpdate(updateKeys, oldRoomProperties, JSON.parse(extraInfo), ZegoRoomPropertyUpdateType.update);\n        } else {\n          // Restore\n          _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n          zlogwarning('[updateRoomProperties]Update failed, errorCode: ', errorCode);\n          reject({ code: errorCode });\n        }\n      }).catch((error) => {\n        // Restore\n        _roomProperties = JSON.parse(JSON.stringify(oldRoomProperties));\n        zlogerror('[updateRoomProperties]Update error', error);\n        reject(error);\n      });\n    });\n  },\n  getRoomProperties() {\n    return _roomProperties;\n  },\n  onRoomPropertyUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertyUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertyUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertyUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertyUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  onRoomPropertiesFullUpdated(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onRoomPropertiesFullUpdatedCallbackMap) {\n        zloginfo(\n          '[onRoomPropertiesFullUpdated] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onRoomPropertiesFullUpdatedCallbackMap[callbackID];\n      }\n    } else {\n      _onRoomPropertiesFullUpdatedCallbackMap[callbackID] = callback;\n    }\n  },\n  sendInRoomCommand(command: string, toUserIDs: string[] = []) {\n    const toUserList = toUserIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n  onInRoomCommandReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomCommandReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomCommandReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomCommandReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomCommandReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onMeRemovedFromRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMeRemovedFromRoomCallbackMap) {\n        zloginfo(\n          '[onMeRemovedFromRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMeRemovedFromRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onMeRemovedFromRoomCallbackMap[callbackID] = callback;\n    }\n  },\n  onJoinRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onJoinRoomCallbackMap) {\n        zloginfo(\n          '[onJoinRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onJoinRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onJoinRoomCallbackMap[callbackID] = callback;\n    }\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> User <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  connectUser(userID: string, userName: string) {\n    _setLocalUserInfo({ userID: userID, userName: userName });\n    // TODO ZIM login\n  },\n  disconnectUser() {\n    delete _coreUserMap[_localCoreUser.userID];\n    _localCoreUser = _createCoreUser('', '', '', {});\n    // TODO ZIM logout\n  },\n  getLocalUserInfo() {\n    return _localCoreUser;\n  },\n  getUser(userID: string) {\n    return _coreUserMap[userID];\n  },\n  getAllScreenshareUsers() {\n    var users: any[] = [];\n    Object.keys(_streamCoreUserMap).forEach(\n      (streamID) => {\n        const isScreenshare = streamID.endsWith(_screenshareStreamIDFlag);\n        if (isScreenshare) {\n          users.push(_streamCoreUserMap[streamID]);\n        }\n      }\n    );\n    return users;\n  },\n  getAllUsers() {\n    const users = Object.values(_coreUserMap);\n    users.sort((a: any, b: any) => {\n      return a.joinTime - b.joinTime;\n    });\n    var publicUsers: any[] = [];\n    users.forEach((user) => {\n      publicUsers.push(_createPublicUser(user));\n    });\n    return publicUsers;\n  },\n  getAudioVideoUsers() {\n    const users = Object.values(_streamCoreUserMap);\n    users.sort((a: any, b: any) => {\n      return a.joinTime - b.joinTime;\n    });\n    var publicUsers: any[] = [];\n    users.forEach((user) => {\n      publicUsers.push(_createPublicUser(user));\n    });\n    return publicUsers;\n  },\n  onUserJoin(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserJoinCallbackMap) {\n        zloginfo(\n          '[onUserJoin] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserJoinCallbackMap[callbackID];\n      }\n    } else {\n      _onUserJoinCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserLeave(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserLeaveCallbackMap) {\n        zloginfo(\n          '[onUserLeave] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserLeaveCallbackMap[callbackID];\n      }\n    } else {\n      _onUserLeaveCallbackMap[callbackID] = callback;\n    }\n  },\n  onOnlySelfInRoom(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onOnlySelfInRoomCallbackMap) {\n        zloginfo(\n          '[onOnlySelfInRoom] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onOnlySelfInRoomCallbackMap[callbackID];\n      }\n    } else {\n      _onOnlySelfInRoomCallbackMap[callbackID] = callback;\n    }\n  },\n  onUserCountOrPropertyChanged(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onUserCountOrPropertyChangedCallbackMap) {\n        zloginfo(\n          '[onUserCountOrPropertyChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onUserCountOrPropertyChangedCallbackMap[callbackID];\n      }\n    } else {\n      _onUserCountOrPropertyChangedCallbackMap[callbackID] = callback;\n    }\n  },\n\n  removeUserFromRoom(userIDs: string[] = []) {\n    const command = JSON.stringify({ zego_remove_user: userIDs });\n    const toUserList = (_isLargeRoom || _markAsLargeRoom) ? [] : userIDs.map((userID) => {\n      const userInfo = _coreUserMap[userID];\n      const userName = userInfo ? (userInfo.userName || '') : '';\n      return {\n        userID,\n        userName,\n      };\n    });\n    return _sendInRoomCommand(command, toUserList);\n  },\n\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Message <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  getInRoomMessages() {\n    return _inRoomMessageList;\n  },\n  sendInRoomMessage(message: string) {\n    return new Promise((resolve, reject) => {\n      ZegoExpressEngine.instance()\n        .sendBroadcastMessage(_currentRoomID, message)\n        .then((result) => {\n          zloginfo('SendInRoomMessage finished.', result);\n          const { errorCode, messageID } = result;\n          if (errorCode > 0) {\n            reject(errorCode);\n          } else {\n            const inRoomMessage = {\n              type: 'user',\n              message: message,\n              messageID: messageID,\n              sendTime: Date.now(),\n              sender: _createPublicUser(_localCoreUser),\n            };\n            _inRoomMessageList.push(inRoomMessage);\n\n            Object.keys(_onInRoomMessageSentCallbackMap).forEach(\n              (callbackID) => {\n                // callback may remove from map during room state chaging\n                if (callbackID in _onInRoomMessageSentCallbackMap) {\n                  if (_onInRoomMessageSentCallbackMap[callbackID]) {\n                    _onInRoomMessageSentCallbackMap[callbackID](\n                      errorCode,\n                      messageID\n                    );\n                  }\n                }\n              }\n            );\n\n            resolve(result);\n          }\n        })\n        .catch((error) => {\n          zlogerror('SendInRoomMessage falied: ', error);\n          reject(error);\n        });\n    });\n  },\n  onInRoomMessageReceived(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageReceivedCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageReceivedCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageReceivedCallbackMap[callbackID] = callback;\n    }\n  },\n  onInRoomMessageSent(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onInRoomMessageSentCallbackMap) {\n        zloginfo(\n          '[onInRoomMessageSent] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onInRoomMessageSentCallbackMap[callbackID];\n      }\n    } else {\n      _onInRoomMessageSentCallbackMap[callbackID] = callback;\n    }\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Live audio room <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  notifyUserCountOrPropertyChanged(type: number) {\n    _notifyUserCountOrPropertyChanged(type);\n  },\n  notifyUserInfoUpdate(userID: string) {\n    // Update avatar properties\n    if ( _coreUserMap[userID] && _coreUserMap[userID].inRoomAttributes) {\n      _coreUserMap[userID].avatar = _coreUserMap[userID].inRoomAttributes.avatar;\n    }\n    _notifyUserInfoUpdate(_coreUserMap[userID]);\n  },\n  // >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Force update component <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n  forceSortMemberList() {\n    zloginfo('[forceSortMemberList callback]');\n    const userList = Object.values(_coreUserMap)\n      .sort((user1: any, user2: any) => {\n        return user2.joinTime - user1.joinTime;\n      })\n      .map((user) => _createPublicUser(user));\n    Object.keys(_onMemberListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onMemberListForceSortCallbackMap[callbackID]) {\n        _onMemberListForceSortCallbackMap[callbackID](userList);\n      }\n    });\n  },\n  onMemberListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onMemberListForceSortCallbackMap) {\n        zloginfo(\n          '[onMemberListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onMemberListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onMemberListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceSortAudioVideoList() {\n    zloginfo('[forceSortAudioVideoList callback]');\n    Object.keys(_onAudioVideoListForceSortCallbackMap).forEach((callbackID) => {\n      if (_onAudioVideoListForceSortCallbackMap[callbackID]) {\n        _onAudioVideoListForceSortCallbackMap[callbackID]();\n      }\n    });\n  },\n  onAudioVideoListForceSort(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onAudioVideoListForceSortCallbackMap) {\n        zloginfo(\n          '[onAudioVideoListForceSort] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onAudioVideoListForceSortCallbackMap[callbackID];\n      }\n    } else {\n      _onAudioVideoListForceSortCallbackMap[callbackID] = callback;\n    }\n  },\n  forceRenderVideoView() {\n    zloginfo('[forceRenderVideoView callback]');\n    Object.keys(_onVideoViewForceRenderCallbackMap).forEach((callbackID) => {\n      if (_onVideoViewForceRenderCallbackMap[callbackID]) {\n        _onVideoViewForceRenderCallbackMap[callbackID]();\n      }\n    });\n  },\n  onVideoViewForceRender(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onVideoViewForceRenderCallbackMap) {\n        zloginfo(\n          '[onVideoViewForceRender] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onVideoViewForceRenderCallbackMap[callbackID];\n      }\n    } else {\n      _onVideoViewForceRenderCallbackMap[callbackID] = callback;\n    }\n  },\n  \n  onError(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n        if (callbackID in _onErrorCallbackMap) {\n            zloginfo(\n                '[onError] Remove callback for: [',\n                callbackID,\n                '] because callback is not a valid function!'\n              );\n            delete _onErrorCallbackMap[callbackID];\n        }\n    } else {\n        _onErrorCallbackMap[callbackID] = callback;\n    }\n  },\n\n  notifyErrorUpdate(method: string, error: number, message: string) {\n    Object.keys(_onErrorCallbackMap).forEach((callbackID) => {\n      if (_onErrorCallbackMap[callbackID]) {\n          _onErrorCallbackMap[callbackID](method, error, message);\n      }\n    });\n  },\n\n  onTokenProvide(callback?: Function) {\n    _onTokenProvideCallback = callback;\n  },\n\n  renewToken(token: string) {\n    if (_isEngineCreated() && _currentRoomID) {\n      ZegoExpressEngine.instance()\n      .renewToken(_currentRoomID, token)\n      .then(() => {\n        zloginfo(`Renew token success, roomID: ${_currentRoomID}`);\n      })\n      .catch((error) => {\n        zlogerror('Renew token failed: ', error);\n      });\n    }\n    return ZegoUIKitSignalingPluginImpl.renewToken(token);\n  },\n\n  async getToken() {\n    if (typeof _onTokenProvideCallback !== 'function') {\n      return '';\n    }\n    const token = await _onTokenProvideCallback();\n    zloginfo(`[Get Token]: ${token}`);\n    return token;\n  },\n  isScreenSharing() {\n    Object.keys(_streamCoreUserMap).forEach((streamID) => {\n      if (streamID.endsWith(_screenshareStreamIDFlag)) {\n        return true;\n      }\n    });\n    return false;\n  },\n\n  onScreenSharingAvailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onScreenSharingAvailableCallbackMap) {\n        zloginfo(\n          '[onScreenSharingAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onScreenSharingAvailableCallbackMap[callbackID];\n      }\n    } else {\n      _onScreenSharingAvailableCallbackMap[callbackID] = callback;\n    }\n  },\n\n  onScreenSharingUnavailable(callbackID: string, callback?: Function) {\n    if (typeof callback !== 'function') {\n      if (callbackID in _onScreenSharingUnavailableCallbackMap) {\n        zloginfo(\n          '[onScreenSharingAvailable] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete _onScreenSharingUnavailableCallbackMap[callbackID];\n      }\n    } else {\n      _onScreenSharingUnavailableCallbackMap[callbackID] = callback;\n    }\n  }\n};\n\nexport default ZegoUIKitInternal"],"mappings":"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","ignoreList":[]}