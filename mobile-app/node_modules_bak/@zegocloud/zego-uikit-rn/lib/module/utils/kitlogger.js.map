{"version":3,"names":["AppState","NativeModules","Platform","getLocalDateFormat","LogRNModule","_userID","_listenerAlready","ZegoUIKitLogger","logSetUserID","userID","addEventListener","nextState","flush","logInfo","module","msg","dateFormat","OS","_formatLog","__DEV__","console","info","logWarning","warn","logError","error","logFlush","msgList","isPureString","i","length","_canLogToFile","join","jsonList","push","JSON","stringify","canLogTypeList","includes"],"sources":["kitlogger.ts"],"sourcesContent":["import { AppState, NativeModules, Platform } from 'react-native';\n\nimport { getLocalDateFormat } from './timer';\n\nconst { LogRNModule } = NativeModules;\n\nlet _userID = ''\nlet _listenerAlready = false\n\nconst ZegoUIKitLogger = {\n    logSetUserID: (userID: string) => {\n        _userID = userID\n\n        if (!_listenerAlready) {\n            AppState.addEventListener('change', async nextState => {\n                if (nextState === 'active' || nextState === 'background') {\n                    LogRNModule.flush();\n                }\n            });\n            _listenerAlready = true\n        }\n    },\n\n    logInfo: (module: string, ...msg: any[]) => {\n        let dateFormat = getLocalDateFormat()\n        if (Platform.OS === 'ios') {\n            LogRNModule.logInfo(`${dateFormat} I/${module}: ` + _formatLog(...msg));\n        } else {\n            LogRNModule.logInfo(`I/${module}: ` + _formatLog(...msg));\n        }\n\n        if (__DEV__) {\n            console.info(`${dateFormat} [${module}][${_userID}]`, ...msg);\n        }\n    },\n    \n    logWarning: (module: string, ...msg: any[]) => {\n        let dateFormat = getLocalDateFormat()\n        if (Platform.OS === 'ios') {\n            LogRNModule.logWarning(`${dateFormat} W/${module}: ` + _formatLog(...msg));\n        } else {\n            LogRNModule.logWarning(`W/${module}: ` + _formatLog(...msg));\n        }\n\n        if (__DEV__) {\n            console.warn(`${dateFormat} [${module}][${_userID}]`, ...msg);\n        }\n    },\n    \n    logError: (module: string, ...msg: any[]) => {\n        let dateFormat = getLocalDateFormat()\n        if (Platform.OS === 'ios') {\n            LogRNModule.logError(`${dateFormat} E/${module}: ` + _formatLog(...msg));\n        } else {\n            LogRNModule.logError(`E/${module}: ` + _formatLog(...msg));\n        }\n\n        if (__DEV__) {\n            console.error(`${dateFormat} [${module}][${_userID}]`, ...msg);\n        }\n    },\n\n    logFlush: () => {\n        LogRNModule.flush()\n    }\n}\n\nexport default ZegoUIKitLogger;\n\nfunction _formatLog(...msgList: any[]): string {\n    let isPureString = true;\n    for (let i = 0; i < msgList.length; i++) {\n        if (!_canLogToFile(msgList[i])) {\n            isPureString = false;\n            break;\n        }\n    }\n\n    if (isPureString == true) {\n        return msgList.join(\" \");\n    } else {\n        let jsonList: string[] = []\n        for (let i = 0; i < msgList.length; i++) {\n            if (_canLogToFile(msgList[i])) {\n                jsonList.push(msgList[i]);\n            } else {\n                jsonList.push(JSON.stringify(msgList[i]));\n            }\n        }\n        \n        return `(LogTruncated?) ${ jsonList.join(\" \") }`;\n    }\n}\n\nconst canLogTypeList: string[] = ['string', 'number', 'boolean']\n\nfunction _canLogToFile(msg: any) {\n    return canLogTypeList.includes(typeof msg)\n}"],"mappings":"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","ignoreList":[]}