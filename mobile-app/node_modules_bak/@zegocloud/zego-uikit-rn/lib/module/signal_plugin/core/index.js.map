{"version":3,"names":["AppState","ZIMCallUserState","ZIMConnectionState","ZIMErrorCode","ZegoPluginResult","zlogerror","zloginfo","zlogwarning","ZegoPluginUserInRoomAttributesCore","ZegoPluginRoomPropertiesCore","ZegoUIKitCorePlugin","ZegoPluginRoomMessageCore","getZimConnectionEventName","getZimConnectionStateName","ZegoUIKitReport","ZegoSignalingPluginCore","constructor","_defineProperty","Map","Disconnected","shared","getInstance","_registerEngineCallback","getZIMPlugin","default","on","zim","errorInfo","code","message","state","event","extendedData","_connectionState","_notifyConnectionStateChanged","callID","inviter","timeout","_currentInvitationID","_callIDUsers","set","_callIDExtendedData","notifyData","id","extendedMap","JSON","parse","name","inviter_name","type","data","_notifyCallInvitationReceived","reportEvent","currentState","result","callUserList","callerID","_getInviterIDByCallID","stringify","map","callUserInfo","callUserID","userID","callUserState","callExtendedData","Accepted","_loginUser","dataParsed","call_id","invitee","userName","_notifyCallInvitationAccepted","Rejected","_notifyCallInvitationRejected","Timeout","_callExtendedData","_getExtendedDataByCallID","invitees","_notifyCallInviteesAnsweredTimeout","_notifyCallInvitationTimeout","Cancelled","BeCancelled","delete","_notifyCallInvitationCancelled","second","Object","keys","_onRequireNewTokenCallbackMap","forEach","callbackID","token","renewToken","_unregisterEngineCallback","off","_onConnectionStateChangedCallbackMap","callbackCount","_onCallInvitationReceivedCallbackMap","length","_onCallInvitationCancelledCallbackMap","_onCallInvitationAcceptedCallbackMap","_onCallInvitationRejectedCallbackMap","_onCallInvitationTimeoutCallbackMap","_onCallInviteesAnsweredTimeoutCallbackMap","_resetData","_resetDataForLogout","_isLogin","clear","get","_createHandle","getLocalUser","getCallIDByUserID","Array","from","key","value","getZIMInstance","getVersion","create","appConfig","login","userInfo","Promise","resolve","reject","then","_onLoginSuccessCallbackMap","catch","error","NetworkModuleUserHasAlreadyLogged","logout","destroy","setAdvancedConfig","invite","config","callInvite","errorInvitees","errorUserList","errorInviteeIDs","errorInvitee","desc","Offline","Inviting","push","cancel","callCancel","inviteeID","accept","callAccept","callReject","queryCallList","queryCallInvitationList","callList","nextFlag","newFlag","onConnectionStateChanged","callback","onCallInvitationReceived","onCallInvitationCancelled","onCallInvitationAccepted","onCallInvitationRejected","onCallInvitationTimeout","onCallInviteesAnsweredTimeout","onRequireNewToken","onLoginSuccess","_ZegoSignalingPluginCore"],"sources":["index.ts"],"sourcesContent":["import { AppState } from 'react-native';\nimport {\n  type ZIMAppConfig,\n  type ZIMUserInfo,\n  type ZIMCallInviteConfig,\n  type ZIMCallCancelConfig,\n  type ZIMCallAcceptConfig,\n  type ZIMCallRejectConfig,\n  type ZIMError,\n  type ZIMEventOfConnectionStateChangedResult,\n  type ZIMEventOfCallInvitationReceivedResult,\n  type ZIMEventOfCallUserStateChangedResult,\n  type ZIMCallInvitationSentResult,\n  type ZIMCallCancelSentResult,\n  type ZIMCallAcceptanceSentResult,\n  type ZIMCallRejectionSentResult,\n  type ZIMCallInvitationQueryConfig,\n  type ZIMCallInvitationListQueriedResult,\n  type ZIMCallInfo,\n  type ZIMEventOfTokenWillExpireResult,\n  ZIMCallUserState,\n  ZIMConnectionState,\n  ZIMErrorCode,\n} from 'zego-zim-react-native';\nimport ZegoPluginResult from './defines';\nimport { zlogerror, zloginfo, zlogwarning } from '../utils/logger';\nimport ZegoPluginUserInRoomAttributesCore from './user_in_room_attributes_core';\nimport ZegoPluginRoomPropertiesCore from './room_properties_core';\nimport ZegoUIKitCorePlugin from \"../../components/internal/ZegoUIKitCorePlugin\";\nimport ZegoPluginRoomMessageCore from './in_room_message_core';\nimport { getZimConnectionEventName, getZimConnectionStateName } from '../../utils/enum_name';\nimport ZegoUIKitReport from '../../utils/report';\n\nexport default class ZegoSignalingPluginCore {\n  static shared: ZegoSignalingPluginCore;\n  _loginUser = {} as ZIMUserInfo;\n  _isLogin = false;\n  _callIDUsers = new Map<string, string>(); // <zim call id, user id>\n  _callIDExtendedData = new Map<string, string>(); // <zim call id, extendedData>\n  _connectionState = ZIMConnectionState.Disconnected;\n  _onConnectionStateChangedCallbackMap: { [index: string]: (notifyData: { state: ZIMConnectionState }) => void } = {};\n  _onCallInvitationReceivedCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    type: number;\n    inviter: { name: string; id: string; };\n    data: string;\n  }) => void } = {};\n  _onCallInvitationCancelledCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    inviter: { id: string };\n    data: string;\n  }) => void } = {};\n  _onCallInvitationAcceptedCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void } = {};\n  _onCallInvitationRejectedCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void } = {};\n  _onCallInvitationTimeoutCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) => void } = {};\n  _onCallInviteesAnsweredTimeoutCallbackMap: { [index: string]: (notifyData: {\n    callID: string;\n    invitees: { id: string; name: string; }[];\n    data: string;\n  }) => void } = {};\n  _currentInvitationID = ''\n  _onRequireNewTokenCallbackMap: { [index: string]: () => string } = {};\n  _onLoginSuccessCallbackMap: { [index: string]: () => void } = {};\n\n  constructor() {\n    if (!ZegoSignalingPluginCore.shared) {\n      zloginfo('[Core]ZegoSignalingPluginCore successful instantiation.');\n      ZegoSignalingPluginCore.shared = this;\n    }\n    return ZegoSignalingPluginCore.shared;\n  }\n  static getInstance() {\n    if (!ZegoSignalingPluginCore.shared) {\n      ZegoSignalingPluginCore.shared = new ZegoSignalingPluginCore();\n    }\n    return ZegoSignalingPluginCore.shared;\n  }\n  // ------- internal events register ------\n  _registerEngineCallback() {\n    zloginfo('[Core]Register callback for ZIM...');\n\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().on('error', (zim: any, errorInfo: ZIMError) => {\n      zlogerror(\n        `[Core]Zim error, code:${errorInfo.code}, message:${errorInfo.message}.`\n      );\n    });\n\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().on(\n      'connectionStateChanged',\n      (zim: any, { state, event, extendedData }: ZIMEventOfConnectionStateChangedResult) => {\n        zloginfo(\n          `[Core]Connection state changed, state:${getZimConnectionStateName(state)}, event:${getZimConnectionEventName(event)}, extended data:${extendedData}`\n        );\n        this._connectionState = state;\n        this._notifyConnectionStateChanged({ state });\n        if (this._connectionState === ZIMConnectionState.Disconnected) {\n          zlogwarning('[Core]Disconnected, auto logout.');\n          // this.logout();\n        }\n      }\n    );\n\n    // Callback of the call invitation received by the invitee.\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().on(\n      'callInvitationReceived',\n      (zim: any, { callID, inviter, timeout, extendedData }: ZIMEventOfCallInvitationReceivedResult) => {\n        zloginfo(\n          '[Core][callInvitationReceived callback]',\n          'callID:', callID,\n          'inviter:', inviter,\n          'timeout:', timeout,\n          'extendedData:', extendedData\n        );\n        if (this._currentInvitationID == callID) {\n          return\n        } else {\n          this._currentInvitationID = callID\n        }\n        this._callIDUsers.set(callID, inviter);\n        this._callIDExtendedData.set(callID, extendedData)\n        \n        const notifyData: any = { callID, inviter: { id: inviter } };\n        if (extendedData) {\n          const extendedMap = JSON.parse(extendedData);\n          notifyData.inviter.name = extendedMap.inviter_name;\n          notifyData.type = extendedMap.type;\n          notifyData.data = extendedMap.data;\n          notifyData.timeout = timeout\n        }\n        this._notifyCallInvitationReceived(notifyData);\n        ZegoUIKitReport.reportEvent('invitationReceived', {\n          'call_id': notifyData.callID,\n          'inviter': notifyData.inviter.id,\n          'app_state': AppState.currentState,\n          'extended_data': extendedData\n        })\n      }\n    );\n\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().on('callUserStateChanged', (zim: any, result: ZIMEventOfCallUserStateChangedResult) => {\n      let callID = result.callID\n      let callUserList = result.callUserList\n      let callerID = this._getInviterIDByCallID(callID)\n      zloginfo(`[SignalingPluginCore][callUserStateChanged callback], callID: ${callID}, callerID: ${callerID}, callUserList: ${JSON.stringify(callUserList)}`)\n\n      callUserList.map(callUserInfo => {\n        let callUserID = callUserInfo.userID\n        let callUserState = callUserInfo.state\n        let callExtendedData = callUserInfo.extendedData\n\n        if (callUserState === ZIMCallUserState.Accepted && callUserID !== this._loginUser.userID) {   // 1\n          // as caller, state changed to Accepted as soon as after call, and wait for the other callees to change to the Accepted state\n          // as callee, should ignore anyone state changed callback\n          zloginfo(`[SignalingPluginCore][callUserStateChanged callback], detect ${callUserID} Accepted`)\n          if (this._loginUser.userID !== callerID) {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], ignore`)\n          } else if (callUserID !== this._loginUser.userID) {\n            // detect other state changed\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], notifyCallInvitationAccepted`)\n\n            let dataParsed = callExtendedData ? JSON.parse(callExtendedData) : {}\n            dataParsed.callID = callID\n            dataParsed.call_id = dataParsed.call_id ?? ''\n            dataParsed.invitee = dataParsed.invitee ?? {userID: callUserID, userName: ''}\n\n            const notifyData = {\n              callID,\n              invitee: { id: callUserID, name: '' },\n              data: JSON.stringify(dataParsed),\n            };\n            this._notifyCallInvitationAccepted(notifyData);\n          }\n        } else if (callUserState === ZIMCallUserState.Rejected) {  // 2\n          // as caller, wait for the other callees's state changed to Rejected\n          // as callee, should ignore anyone state changed callback\n          zloginfo(`[SignalingPluginCore][callUserStateChanged callback], detect ${callUserID} Rejected`)\n          if (this._loginUser.userID !== callerID) {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], ignore`)\n          } else {\n            // detect other state changed\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], notifyCallInvitationRejected`)\n\n            let dataParsed = callExtendedData ? JSON.parse(callExtendedData) : {}\n            dataParsed.callID = callID\n            dataParsed.call_id = dataParsed.call_id ?? ''\n            dataParsed.invitee = dataParsed.invitee ?? {userID: callUserID, userName: ''}\n\n            const notifyData = {\n              callID,\n              invitee: { id: callUserID, name: '' },\n              data: JSON.stringify(dataParsed),\n            };\n            this._notifyCallInvitationRejected(notifyData);  \n          }\n        } else if (callUserState === ZIMCallUserState.Timeout) {  // 6\n          // as caller, wait for the other callees's state changed to the Timeout\n          // as callee, should only care own state changed to Timeout\n          zloginfo(`[SignalingPluginCore][callUserStateChanged callback], detect ${callUserID} Timeout`)\n          \n          // timeout 的 extendedData 为空，为方便后续使用，使用 callInvite 时的 extendedData\n          let _callExtendedData = this._getExtendedDataByCallID(callID)\n\n          if (this._loginUser.userID === callerID) {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], notifyCallInviteesAnsweredTimeout`)\n\n            let dataParsed = _callExtendedData ? JSON.parse(_callExtendedData) : {}\n            dataParsed.call_id = dataParsed.call_id ?? ''\n            dataParsed.invitees = [{userID: callUserID, userName: ''}]\n\n            const notifyData = {\n              callID,\n              invitees: [{ id: callUserID, name: '' }],\n              data: JSON.stringify(dataParsed),\n            };\n            this._notifyCallInviteesAnsweredTimeout(notifyData);  // for onOutgoingCallTimeout\n          } else if (callUserID === this._loginUser.userID) {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], notifyCallInvitationTimeout`)\n\n            let dataParsed = _callExtendedData ? JSON.parse(_callExtendedData) : {}\n            dataParsed.call_id = dataParsed.call_id ?? ''\n            dataParsed.inviter = [{userID: this._getInviterIDByCallID(callID), userName: ''}]\n\n            const notifyData = {\n              callID,\n              inviter: { id: this._getInviterIDByCallID(callID), name: '' },\n              data: JSON.stringify(dataParsed),\n            };\n            this._notifyCallInvitationTimeout(notifyData);        // for onIncomingCallTimeout\n          } else {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], ignore`)\n          }\n        } else if (callUserState === ZIMCallUserState.Cancelled || callUserState === ZIMCallUserState.BeCancelled) {  // 3 or 10\n          // |        |          Cancelled         |                                    BeCancelled                                     |\n          // | caller | caller cancel OutgoingCall | OutgoingCall cancelled by zim server (e.g. caller network disconnection)           |\n          // | callee |                            | IncomingCall cancelled by caller or zim server (e.g. caller network disconnection) |\n          \n          zloginfo(`[SignalingPluginCore][callUserStateChanged callback], detect ${callUserID} ${callUserState === ZIMCallUserState.Cancelled ? 'Cancelled' : 'BeCancelled'}`)\n          if (callUserID !== this._loginUser.userID) {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], ignore`)\n          } else {\n            zloginfo(`[SignalingPluginCore][callUserStateChanged callback], notifyCallInvitationCancelled`)\n            \n            let dataParsed = callExtendedData ? JSON.parse(callExtendedData) : {}\n            dataParsed.callID = callID\n            dataParsed.call_id = dataParsed.call_id ?? ''\n            dataParsed.inviter = dataParsed.inviter ?? {userID: '', userName: ''}\n            \n            // when caller cancelled, inviter is empty\n            callerID = callerID ?? dataParsed.inviter.userID\n\n            const notifyData = {\n              callID,\n              inviter: { id: callerID },\n              data: JSON.stringify(dataParsed),\n            };\n            this._callIDUsers.delete(callID);\n            this._callIDExtendedData.delete(callID)\n            this._notifyCallInvitationCancelled(notifyData);\n          }\n        }\n      })\n    });\n\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().on('tokenWillExpire', (zim: any, { second }: ZIMEventOfTokenWillExpireResult) => {\n      zloginfo('zim token will expire.');\n      Object.keys(this._onRequireNewTokenCallbackMap).forEach(\n        async (callbackID) => {\n          if (this._onRequireNewTokenCallbackMap[callbackID]) {\n            const token = await this._onRequireNewTokenCallbackMap[callbackID]();\n            if (token) {\n                this.renewToken(token);\n            } else {\n              zlogerror('Renew token failed: the returned token is abnormal');\n            }\n          }\n        }\n      );\n    });\n  }\n  _unregisterEngineCallback() {\n    zloginfo('[Core]Unregister callback from ZIM...');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().off('error');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().off('connectionStateChanged');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().off('callUserStateChanged');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().off('callInvitationReceived');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().off('tokenWillExpire');\n  }\n  // ------- internal events exec ------\n  _notifyConnectionStateChanged(notifyData: { state: ZIMConnectionState }) {\n    Object.keys(this._onConnectionStateChangedCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onConnectionStateChangedCallbackMap[callbackID]) {\n          this._onConnectionStateChangedCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInvitationReceived(notifyData: {\n    callID: string;\n    type: number;\n    inviter: { name: string; id: string; };\n    data: string;\n  }) {\n    let callbackCount = Object.keys(this._onCallInvitationReceivedCallbackMap).length;\n    zloginfo(`[ZegoSignalingPluginCore][_notifyCallInvitationReceived] notify count: ${callbackCount}`);\n\n    Object.keys(this._onCallInvitationReceivedCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInvitationReceivedCallbackMap[callbackID]) {\n          this._onCallInvitationReceivedCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInvitationCancelled(notifyData: {\n    callID: string;\n    inviter: { id: string };\n    data: string;\n  }) {\n    let callbackCount = Object.keys(this._onCallInvitationCancelledCallbackMap).length;\n    zloginfo(`[ZegoSignalingPluginCore][_notifyCallInvitationCancelled] notify count: ${callbackCount}`);\n\n    Object.keys(this._onCallInvitationCancelledCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInvitationCancelledCallbackMap[callbackID]) {\n          this._onCallInvitationCancelledCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInvitationAccepted(notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) {\n    Object.keys(this._onCallInvitationAcceptedCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInvitationAcceptedCallbackMap[callbackID]) {\n          this._onCallInvitationAcceptedCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInvitationRejected(notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) {\n    Object.keys(this._onCallInvitationRejectedCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInvitationRejectedCallbackMap[callbackID]) {\n          this._onCallInvitationRejectedCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInvitationTimeout(notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) {\n    Object.keys(this._onCallInvitationTimeoutCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInvitationTimeoutCallbackMap[callbackID]) {\n          this._onCallInvitationTimeoutCallbackMap[callbackID](notifyData);\n        }\n      }\n    );\n  }\n  _notifyCallInviteesAnsweredTimeout(notifyData: {\n    callID: string;\n    invitees: { id: string; name: string; }[];\n    data: string;\n  }) {\n    Object.keys(this._onCallInviteesAnsweredTimeoutCallbackMap).forEach(\n      (callbackID) => {\n        if (this._onCallInviteesAnsweredTimeoutCallbackMap[callbackID]) {\n          this._onCallInviteesAnsweredTimeoutCallbackMap[callbackID](\n            notifyData\n          );\n        }\n      }\n    );\n  }\n  // ------- internal utils ------\n  _resetData() {\n    this._resetDataForLogout();\n  }\n  _resetDataForLogout() {\n    this._isLogin = false;\n    this._loginUser = {} as ZIMUserInfo;\n    this._callIDUsers.clear();\n    this._callIDExtendedData.clear()\n    this._connectionState = ZIMConnectionState.Disconnected;\n  }\n  _getInviterIDByCallID(callID: string) {\n    return this._callIDUsers.get(callID);\n  }\n  _getExtendedDataByCallID(callID: string) {\n    return this._callIDExtendedData.get(callID);\n  }\n  _createHandle() {\n    this._unregisterEngineCallback();\n    this._registerEngineCallback();\n    // live audio room\n    ZegoPluginUserInRoomAttributesCore.getInstance()._unregisterEngineCallback();\n    ZegoPluginUserInRoomAttributesCore.getInstance()._registerEngineCallback();\n    ZegoPluginRoomPropertiesCore.getInstance()._unregisterEngineCallback();\n    ZegoPluginRoomPropertiesCore.getInstance()._registerEngineCallback();\n    ZegoPluginRoomMessageCore.getInstance()._unregisterEngineCallback();\n    ZegoPluginRoomMessageCore.getInstance()._registerEngineCallback();\n  }\n  // ------- external utils ------\n  getLocalUser() {\n    return this._loginUser;\n  }\n  getCallIDByUserID(userID: string) {\n    let callID = '';\n    Array.from(this._callIDUsers.keys()).forEach((key) => {\n      const value = this._callIDUsers.get(key);\n      if (userID === value) {\n        callID = key;\n        zloginfo(`[Core]getCallIDByUserID, ${userID} => ${callID}`);\n      }\n    });\n    return callID;\n  }\n  // ------- external method ------\n  getZIMInstance() {\n    return ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance();\n  }\n  getVersion(): Promise<string> {\n    return ZegoUIKitCorePlugin.getZIMPlugin().default.getVersion();\n  }\n  create(appConfig: ZIMAppConfig) {\n    if (!ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()) {\n      const zim = ZegoUIKitCorePlugin.getZIMPlugin().default.create(appConfig);\n      if (!zim) {\n        zlogerror('[Core]Create zim error.');\n      } else {\n        zloginfo('[Core]Create zim success.');\n        this._createHandle();\n      }\n    } else {\n      zlogwarning('[Core]Zim has already created.');\n      this._createHandle();\n    }\n  }\n  login(userInfo: ZIMUserInfo, token = ''): Promise<void> {\n    zloginfo('ZIM login...');\n    return new Promise((resolve, reject) => {\n      if (!this._isLogin) {\n        ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n          .login(userInfo, token)\n          .then(() => {\n            zloginfo('ZIM login success.');\n            zloginfo('[Core]Login success.');\n            this._loginUser = userInfo;\n            this._isLogin = true;\n            resolve();\n            zloginfo('notify _onLoginSuccessCallbackMap');\n            Object.keys(this._onLoginSuccessCallbackMap).forEach((callbackID) => {\n              if (this._onLoginSuccessCallbackMap[callbackID]) {\n                this._onLoginSuccessCallbackMap[callbackID]()\n              }\n            });\n          }).catch((error: ZIMError) => {\n            if (error.code == ZIMErrorCode.NetworkModuleUserHasAlreadyLogged) {\n              zloginfo('ZIM login already.');\n              zloginfo('[Core]Login already success.');\n              resolve();\n              zloginfo('notify _onLoginSuccessCallbackMap');\n              Object.keys(this._onLoginSuccessCallbackMap).forEach((callbackID) => {\n                if (this._onLoginSuccessCallbackMap[callbackID]) {\n                  this._onLoginSuccessCallbackMap[callbackID]()\n                }\n              });\n            } else {\n              zloginfo(`ZIM login fail, error: ${error.code}`);\n              reject(error);\n            }\n          });\n      } else {\n        zloginfo('[Core]Login already success.');\n        resolve();\n      }\n    });\n  }\n  logout(): Promise<void> {\n    zloginfo('ZIM logout...');\n    return ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n      .logout()\n      .then(() => {\n        zloginfo('[Core]Logout success.');\n        this._resetDataForLogout();\n        // live audio room\n        ZegoPluginUserInRoomAttributesCore.getInstance()._resetData();\n      });\n  }\n  destroy() {\n    zloginfo('ZIM destroy...');\n    ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance().destroy();\n    zloginfo('[Core]Destroy success.');\n    this._resetData();\n  }\n  setAdvancedConfig(key: string, value: string) {\n    zloginfo(`[Core]setAdvancedConfig, key: ${key}, value: ${value}`);\n    ZegoUIKitCorePlugin.getZIMPlugin().default.setAdvancedConfig(key, value);\n  }\n  invite(invitees: string[], config: ZIMCallInviteConfig): Promise<{ callID: string; errorInvitees: string[]; code: string, message: string; }> {\n    return new Promise((resolve, reject) => {\n      ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .callInvite(invitees, config)\n        .then(({ callID, timeout, errorInvitees, errorUserList }: ZIMCallInvitationSentResult) => {\n          ZegoUIKitReport.reportEvent('callInvite', {\n            'invitees': JSON.stringify(invitees),\n            'count': invitees.length,\n            'error_userlist': JSON.stringify(errorUserList),\n            'error_count': errorUserList.length,\n            'call_id': callID,\n            'extended_data': config.extendedData,\n            'error': 0,\n            'msg': ''\n          })\n\n          this._callIDUsers.set(callID, this._loginUser.userID);\n          this._callIDExtendedData.set(callID, config.extendedData)\n          if (!errorInvitees || !errorInvitees.length) {\n            zloginfo(`[Core]Invite done, call id: ${callID}`);\n            resolve({\n              ...new ZegoPluginResult('', ''),\n              callID,\n              errorInvitees: [],\n            });\n          } else {\n            const errorInviteeIDs: string[] = [];\n            errorInvitees.forEach((errorInvitee) => {\n              const desc =\n                errorInvitee.state === ZIMCallUserState.Offline\n                  ? 'offine'\n                  : errorInvitee.state === ZIMCallUserState.Inviting\n                  ? 'inviting'\n                  : '';\n              zlogwarning(\n                `[Core]Invite error, invitee id: ${errorInvitee.userID}, invitee state: ${errorInvitee.state}, state desc: ${desc}`\n              );\n              errorInviteeIDs.push(errorInvitee.userID);\n            });\n            resolve({\n              ...new ZegoPluginResult('', ''),\n              callID,\n              errorInvitees: errorInviteeIDs,\n            });\n          }\n        })\n        .catch((error: ZIMError) => {\n          ZegoUIKitReport.reportEvent('callInvite', {\n            'invitees': JSON.stringify(invitees),\n            'count': invitees.length,\n            'call_id': '',\n            'extended_data': config.extendedData,\n            'error': error.code,\n            'msg': error.message\n          })\n\n          reject(error);\n        });\n    });\n  }\n  cancel(invitees: string[], callID: string, config: ZIMCallCancelConfig): Promise<{ code: string, message: string; callID: string, errorInvitees: string[]; }> {\n    return new Promise((resolve, reject) => {\n      ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .callCancel(invitees, callID, config)\n        .then(({ callID, errorInvitees }: ZIMCallCancelSentResult) => {\n          this._callIDUsers.delete(callID);\n          this._callIDExtendedData.delete(callID)\n          if (!errorInvitees || !errorInvitees.length) {\n            zloginfo(`[Core]Cancel invitation done, call id: ${callID}`);\n            resolve({ ...new ZegoPluginResult('', ''), callID, errorInvitees: [] });\n          } else {\n            errorInvitees.forEach((inviteeID) => {\n              zlogwarning(\n                `[Core]Cancel invitation error, invitee id: ${inviteeID}`\n              );\n            });\n            resolve({ ...new ZegoPluginResult('', ''), callID, errorInvitees });\n          }\n        })\n        .catch((error: ZIMError) => {\n          zloginfo(`[Core]Cancel invitation failed, call id: ${callID}, error: ${error}`);\n          reject(error);\n        });\n    });\n  }\n  accept(callID: string, config: ZIMCallAcceptConfig): Promise<{ code: string, message: string; }> {\n    return new Promise((resolve, reject) => {\n      ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .callAccept(callID, config)\n        .then(({ callID }: ZIMCallAcceptanceSentResult) => {\n          zloginfo(`[Core]Accept invitation done, call id: ${callID}`);\n          resolve(new ZegoPluginResult('', '', {callID}));\n        })\n        .catch((error: ZIMError) => {\n          reject(error);\n        });\n    });\n  }\n  reject(callID: string, config: ZIMCallRejectConfig): Promise<{ code: string, message: string; }> {\n    return new Promise((resolve, reject) => {\n      ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .callReject(callID, config)\n        .then(({ callID }: ZIMCallRejectionSentResult) => {\n          zloginfo(`[Core]Reject invitation done, call id: ${callID}`);\n          this._callIDUsers.delete(callID);\n          this._callIDExtendedData.delete(callID)\n          resolve(new ZegoPluginResult('', '', {callID}));\n        })\n        .catch((error: ZIMError) => {\n          zloginfo(`[Core]Reject invitation error, call id: ${callID}, error: ${error.code}`);\n          reject(error);\n        });\n    });\n  }\n  queryCallList(config: ZIMCallInvitationQueryConfig): Promise<{ callList: ZIMCallInfo[], nextFlag: number; }> {\n    return new Promise((resolve, reject) => {\n        ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .queryCallInvitationList(config)\n        .then(({callList, nextFlag: newFlag} : ZIMCallInvitationListQueriedResult) => {\n            zloginfo(`[Core]Query invitation list done, nextFlag: ${newFlag}, calllist: ${callList.length}`);\n            const data = {callList: callList, nextFlag: newFlag};\n            resolve(data);\n        })\n        .catch((error: ZIMError) => {\n            reject(error);\n        })\n    });\n  }\n\n  renewToken(token: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      ZegoUIKitCorePlugin.getZIMPlugin().default.getInstance()\n        .renewToken(token)\n        .then(() => {\n          zloginfo(`Renew zim token success, token: ${token}`);\n          resolve();\n        })\n        .catch ((error: ZIMError) => {\n          zlogerror(`Renew zim token failed. code: ${error.code}, message: ${error.message}`);\n          reject(error);\n        });\n    });\n  }\n\n  // ------- external events register ------\n  onConnectionStateChanged(callbackID: string, callback: (notifyData: { state: ZIMConnectionState }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onConnectionStateChangedCallbackMap) {\n        zloginfo(\n          '[Core][onConnectionStateChanged] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onConnectionStateChangedCallbackMap[callbackID];\n      }\n    } else {\n      this._onConnectionStateChangedCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInvitationReceived(callbackID: string, callback: (notifyData: {\n    callID: string;\n    type: number;\n    inviter: { name: string; id: string; };\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInvitationReceivedCallbackMap) {\n        zloginfo(\n          '[Core][onCallInvitationReceived] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onCallInvitationReceivedCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInvitationReceivedCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInvitationCancelled(callbackID: string, callback: (notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInvitationCancelledCallbackMap) {\n        zloginfo('[Core][onCallInvitationCancelled] Remove callback for: [', callbackID, ']');\n        delete this._onCallInvitationCancelledCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInvitationCancelledCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInvitationAccepted(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInvitationAcceptedCallbackMap) {\n        zloginfo(\n          '[Core][onCallInvitationAccepted] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onCallInvitationAcceptedCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInvitationAcceptedCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInvitationRejected(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitee: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInvitationRejectedCallbackMap) {\n        zloginfo(\n          '[Core][onCallInvitationRejected] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onCallInvitationRejectedCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInvitationRejectedCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInvitationTimeout(callbackID: string, callback: (notifyData: {\n    callID: string;\n    inviter: { id: string; name: string; };\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInvitationTimeoutCallbackMap) {\n        zloginfo(\n          '[Core][onCallInvitationTimeout] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onCallInvitationTimeoutCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInvitationTimeoutCallbackMap[callbackID] = callback;\n    }\n  }\n  onCallInviteesAnsweredTimeout(callbackID: string, callback: (notifyData: {\n    callID: string;\n    invitees: { id: string; name: string; }[];\n    data: string;\n  }) => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onCallInviteesAnsweredTimeoutCallbackMap) {\n        zloginfo(\n          '[Core][onCallInviteesAnsweredTimeout] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onCallInviteesAnsweredTimeoutCallbackMap[callbackID];\n      }\n    } else {\n      this._onCallInviteesAnsweredTimeoutCallbackMap[callbackID] = callback;\n    }\n  }\n  onRequireNewToken(callbackID: string, callback: () => string) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onRequireNewTokenCallbackMap) {\n        zloginfo(\n          '[Core][onRequireNewToken] Remove callback for: [',\n          callbackID,\n          '] because callback is not a valid function!'\n        );\n        delete this._onRequireNewTokenCallbackMap[callbackID];\n      }\n    } else {\n      this._onRequireNewTokenCallbackMap[callbackID] = callback;\n    }\n  }\n  onLoginSuccess(callbackID: string, callback?: () => void) {\n    if (typeof callback !== 'function') {\n      if (callbackID in this._onLoginSuccessCallbackMap) {\n        delete this._onLoginSuccessCallbackMap[callbackID];\n        zloginfo(`[onLoginSuccess] Remove callback for: ${callbackID}`)\n      }\n    } else {\n      this._onLoginSuccessCallbackMap[callbackID] = callback;\n      if (this._isLogin) {\n        zloginfo(`[onLoginSuccess] already login, execute callback directly.`)\n        callback()\n      }\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}